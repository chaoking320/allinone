function VIException(e,t){this.Message=e,this.Type=t}!function(){"use strict";angular.module("viModule",["ngCookies","ngTouch","ngSanitize","ngMessages","ngAria","ngResource","ui.router","ui.bootstrap","toastr","smart-table","angular-loading-bar","nvd3","uiSwitch","angular-confirm","SmoothScrollbar","jsonFormatter"])}(),function(){"use strict";angular.module("viModule").controller("TraceController",["$element","$scope","serviceInfo","$stateParams",function(e,t,a,n){var i=this;a.getComponentInfo("vi.ignitestatus").then(function(e){switch(i.data=e,i.statusClass="status-running",i.formatMsg=function(e){return e.replace(/\r\n/g,"<br>")},i.colorMsg=function(e){return e.indexOf("[ERROR]")>=0?"status-failed":e.indexOf("[WARN]")>=0?"status-warn":void 0},e.status){case"Success":i.statusClass="status-normal";break;case"Failure":i.statusClass="status-failed"}nv.addGraph(function(){var t=nv.models.stepsChart();return t.currentIndex(e.currentPluginIndex).currentStatus(e.status),d3.select("#test-chart").datum(e.infos).call(t),nv.utils.windowResize(t.update),t})});var s=e[0].scrollWidth-30,r=d3.select("svg").append("g").attr("transform","translate(20,30)");r.append("line").style("stroke","#ccc").attr("x1",0).attr("y1",0).attr("x2",s-40).attr("y2",0)}])}(),d3.slider=function(){"use strict";function e(i){i.each(function(){t=d3.select(this).classed("d3slider",!0),c=parseInt(t.style("width"),10)-(b.left+b.right),n=n||m,r=d3.scale.linear().domain([m,v]).range([0,c]).clamp(!0),a=t.append("svg").attr("class","d3slider-axis").attr("width",c+b.left+b.right).attr("height",g+b.top+b.bottom).append("g").attr("transform","translate("+b.left+","+b.top+")"),a.append("rect").attr("class","d3slider-rect-range").attr("width",c).attr("height",h),w&&a.append("rect").attr("class","d3slider-rect-value").attr("width",r(n)).attr("height",h);var i=d3.svg.axis().scale(r).orient("bottom");0!==y?(i.ticks(y),i.tickSize(f)):s?(i.tickValues(s),i.tickSize(f)):(i.ticks(0),i.tickSize(0)),o&&i.tickFormat(o),a.append("g").attr("transform","translate(0,"+h+")").call(i);var u=[n];l=a.selectAll(".dragger").data(u).enter().append("g").attr("class","dragger").attr("transform",function(e){return"translate("+r(e)+")"});var p=null;p=o?o(n):d3.format(",.0f")(n),l.append("text").attr("x",0).attr("y",-15).attr("text-anchor","middle").attr("class","draggertext").text(p),l.append("circle").attr("class","dragger-outer").attr("r",8).attr("transform",function(e){return"translate(0,2)"});var C=d3.behavior.drag();C.on("drag",e.drag),C.on("dragend",function(){d&&d(e.value())}),l.call(C),a.on("click",e.click)})}var t,a,n,i,s,r,o,l,c,d,u,p,m=0,v=100,g=40,h=3,f=6,b={top:25,right:25,bottom:15,left:25},y=0,w=!1;return e.draggerTranslateFn=function(){return function(e){return"translate("+r(e)+")"}},e.click=function(){var t=d3.event.offsetX||d3.event.layerX;e.move(t),d&&d(e.value())},e.drag=function(){var t=d3.event.x;e.move(t+b.left)},e.move=function(e){var t,i,s=r.invert(e-b.left);void 0!==u?(t=u.reduce(function(e,t,a,n){return s>t?t:e}),i=u.indexOf(t)<u.length-1?u[u.indexOf(t)+1]:t,n=i-s>=s-t?t:i):n=s;var l=[n];a.selectAll(".dragger").data(l).attr("transform",function(e){return"translate("+r(e)+")"});var c=null;c=o?o(n):d3.format(",.0f")(n),a.selectAll(".dragger").select("text").text(c),w&&a.selectAll(".d3slider-rect-value").attr("width",r(n))},e.min=function(t){return arguments.length?(m=t,e):m},e.max=function(t){return arguments.length?(v=t,e):v},e.classPrefix=function(t){return arguments.length?(i=t,e):i},e.tickValues=function(t){return arguments.length?(s=t,e):s},e.ticks=function(t){return arguments.length?(y=t,e):y},e.stepValues=function(t){return arguments.length?(u=t,e):u},e.tickFormat=function(t){return arguments.length?(o=t,e):o},e.value=function(t){return arguments.length?(n=t,e):n},e.showRange=function(t){return arguments.length?(w=t,e):w},e.callback=function(t){return arguments.length?(d=t,e):d},e.setValue=function(t){var a=r(t)+b.left;e.move(a)},e.mousemove=function(){var t=d3.mouse(this)[0],a=e.getNearest(r.invert(t),u);p.attr("transform","translate("+r(a)+",0)"),p.selectAll("text").text(a)},e.getNearest=function(e,t){var a=t.reduce(function(t,a,n,i){return e>a?a:t}),i=t[t.indexOf(a)+1],s=i-n>=n-a?a:i;return s},e.destroy=function(){return t.selectAll("svg").remove(),e},e},function(){"use strict";function e(){function e(e,t,a,n,i,s,r){var o=this;e.isCollapse=!1,o.isLoadComponents=!1,o.subMenuHeight=t.innerHeight-130+"px",o.menuMaxHeight=t.innerHeight-170+"px",o.openSettings=function(){s.url("/settings/")};var l;r.getInstance("sidebar-scrollbar").then(function(e){l=e});var c=function(){e.$apply(function(){o.subMenuHeight=t.innerHeight-130+"px",o.menuMaxHeight=t.innerHeight-170+"px"})};angular.element(t).on("resize",c),e.$on("$destroy",function(e){angular.element(t).off("resize",c)}),e.collapse=function(){e.isCollapse=!e.isCollapse,o.change({isCollapse:e.isCollapse})},o.hoverMenu=function(t,a,n){o.currentHover=t;var i=(n.srcElement?n.srcElement:n.target).clientWidth+"px",s=45,r=56;e.isCollapse?(o.subMenuLeft=i,s=32,r=32):o.subMenuLeft=i,a>0&&(s+=r*a);var c=s-l.offset.y;o.subMenuTop=c+"px"},n.getComponentMeta().then(function(e){e=i("orderBy")(e,"name"),d(e),a.components=e.map(function(e){var t="/component/"+("true"==e.custom?"custom":"detail")+"/"+e.id+"/"+e.name;return"true"==e.list&&"true"!=e.custom&&(t="/component/detail.list/"+e.id+"/"+e.name),{name:e.name,description:e.description,href:t}})});var d=function(t){if(!o.isLoadComponents&&(o.isLoadComponents=!0,e.menus)){var a=e.menus.findIndex(function(e){return"Component"===e.name});if(0>a)return;var n=e.menus[a];n.submenu=t.map(function(e){var t={};return t.id=e.id,t.name=e.name,{description:"("+e.description+")",name:e.name,state:("true"==e.custom?"Component-Custom(":"true"==e.list?"Component-DetailList(":"Component-Detail(")+JSON.stringify(t)+")"}})}};e.$on("$stateChangeStart",function(t,n,i,s){var r=n.name,o=function(e){return e.state==r};if("empty"==n.name)t.preventDefault();else for(var l=0;l<e.menus.length;l++){var c=e.menus[l];(c.state==r||c.submenu&&c.submenu.some(o))&&a.$broadcast("$menuChange",c)}}),e.$on("$stateChangeSuccess",function(t,a,n,i){for(var s=a.name,r=(i.name,function(e){return e.state==s}),o=0;o<e.menus.length;o++){var l=e.menus[o];if(l.state==s||l.submenu&&l.submenu.some(r))return void e.selemenu(l)}}),e.selemenu=function(t){isNaN(t)||(t=e.menus[0]),e.selectMenu&&(e.selectMenu.selected=!1),t.selected=!0,e.selectMenu=t},"undefined"!=typeof $SMENU?e.menus=$SMENU:e.menus=[{name:"Component",icon:"fa-codepen",state:"Component"},{name:"Metrics",icon:"fa-tachometer",state:"Dashboard"},{name:"Analyzer",icon:"fa-coffee",state:"empty",submenu:[{name:"Jar dependency",state:"Analyzer-Jardependency"},{name:"Self Check",state:"Analyzer-SelfCheck"},{name:"JVM Sampler",state:"Analyzer-JVMSampler"},{name:"VisualGC",state:"Analyzer-VisualGC"},{name:"GCLogAnalyzer",state:"Analyzer-GCLogAnalyzer"}]},{name:"Configuration",icon:"fa-cogs",state:"Configuration"},{name:"Code",icon:"fa-git",state:"Code"},{name:"FC",icon:"fa-toggle-on",state:"FC"},{name:"Cache Manager",icon:"fa-database",state:"Cache"},{name:"Thread dump",icon:"fa-camera",state:"ThreadDump"},{name:"File Log",icon:"fa-file",state:"Log"},{name:"Custom",icon:"fa-file-o",state:"fc"}],e.selemenu(0)}e.$inject=["$scope","$window","$rootScope","serviceInfo","$filter","$location","ScrollbarService"];var t={restrict:"E",templateUrl:"app/components/sidebar/sidebar.html",controller:e,controllerAs:"vm",scope:{change:"&onChange"},bindToController:!0};return t}angular.module("viModule").directive("acmeSidebar",e)}(),function(){"use strict";angular.module("viModule").directive("pageSelect",function(){return{restrict:"E",template:'<input type="text" class="select-page" ng-model="inputPage" ng-change="selectPage(inputPage)">',link:function(e,t,a){e.$watch("currentPage",function(t){e.inputPage=t})}}})}(),function(){"use strict";function e(){function e(e,t,a,n,i,s,r,o,l){var c=this,d=t.get("hostInfo");c.loginUser=a.get("vi-user"),c.isOriginIp=!0,"undefined"!=typeof $PORTALURL&&(c.portalUrl=$PORTALURL),r.getHelp(function(e){c.links=e}),c.tabs={},c.version="dev","undefined"!=typeof $VERSION&&(c.version=$VERSION);var u=null;c["switch"]=function(e){null!==u&&c.tabs[u]&&(c.tabs[u].selected=!1),isNaN(e)&&(c.tabs[e].selected=!0,u=e),o.$broadcast("$switchTab",e)},c.removeTab=function(e){delete c.tabs[u],u=0,o.$broadcast("$removeTab",e)},e.$on("$viViewAdded",function(e,t,a){null!==u&&c.tabs[u]&&(c.tabs[u].selected=!1),c.tabs[t+a]={name:a,selected:!0},u=t+a}),c.changeServer=function(){var e=n.open({animation:!0,templateUrl:"viserversmodal.html",controller:["$scope","$uibModalInstance","currentServer","enterpriseService",function(e,a,n,i){var s={};e.vm=s;t.get("poolServers");s.selectedIdc="all",s.idcs={all:"all"},s.idcFilter=function(e){return"all"==s.selectedIdc?!0:e.idc==s.selectedIdc},i.getServers(function(e){for(var a=0;a<e.length;a++){var n=e[a];n.idc in s.idcs||(s.idcs[n.idc]=n.idc)}s.servers=e,t.put("poolServers",s.servers),s.hasContent=!0}),s.hostIp=n.ip,e.ok=function(){var e=null;s.selectedRow&&(e=s.selectedRow),a.close(e)},e.cancel=function(){a.dismiss("cancel")}}],size:"lg",resolve:{currentServer:{ip:c.hostIp}}});c.returnOrigin=function(){var e=location.pathname.substring(0,location.pathname.length-10)+"api",a=t.get("hostInfo");i.setEndpoint({host:"http://"+a.IP,port:location.port,path:e}),c.hostName=a.HostName,c.hostIp=a.IP,c.isOriginIp=!0,s.reload()},e.result.then(function(e){if(!(location.pathname.length<10)){var a,n=t.get("hostInfo"),r=!1,o=location.port,l=(location.pathname.replace(/\/(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(:|\/)/g,function(t,a,n,i){return a?(r=!0,"/"+e.ip+n):void 0}),"/@in/api");if(r)a="/"+e.ip+":"+e.url+l;else{var d=e.url.indexOf("/");d>0?(o=e.url.substr(0,d),a="/"+e.url.substr(d+1)+l):(o=e.url,a=l)}i.setEndpoint({host:"http://"+(r?location.hostname:e.ip),port:o,path:a}),c.hostName=e.name,c.hostIp=e.ip,c.isOriginIp=c.hostIp==n.IP,s.reload()}})},d?(c.hostName=d.HostName,c.hostIp=d.IP):(c.hostName=$CHOSTNAME,c.hostIp=$CIP),e.$on("hostInfo.ready",function(e){var a=t.get("hostInfo");c.hostName=a.HostName,c.hostIp=a.IP}),e.$on("appinfo.ready",function(e,t){c.appName=t.appName,c.appid=t.appid,c.appChineseName=t.appChineseName});var p;e.$on("$menuChange",function(e,t){p=t}),e.$on("$stateChangeSuccess",function(t,a,n){var i,s=a.name;i="Log-Detail"!=s&&n&&n.name?s+" - "+n.name:s,l.uvTrace(i,function(e){}),o.$broadcast("$switchTab",-1),c.tabs={};var r=n.name?n.name:a.name;p?(e.breadcrumbs=[p],p.state!=a.name&&e.breadcrumbs.push({name:r})):e.breadcrumbs=[{state:"empty",name:r}]})}e.$inject=["$scope","SiteCache","$cookies","$uibModal","ApiService","$state","enterpriseService","$rootScope","appService"];var t={restrict:"E",templateUrl:"app/components/navbar/navbar.html",scope:{creationDate:"="},controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("viModule").directive("acmeNavbar",e)}(),function(){"use strict";function e(e){var t="Native method";if(e.lineNumber>0){var a=e.declaringClass.substr(0,e.declaringClass.lastIndexOf("."));t='<span jns="'+a+'" ng-click="vm.viewSource($event)" class="link">'+e.fileName+":"+e.lineNumber+"</span>"}return e.declaringClass+"."+e.methodName+"("+t+")"}function t(t,a,n){t.close=function(){n.dismiss("cancel")},t.title=a.title,t.rawCollection=a.items,t.formatTrace=e,t.getStateTip=function(e){return(e.lockName?e.lockName+"上的":"")+e.threadState}}function a(a,n,i,s,r,o,l,c,d,u){function p(){o.getStats(function(e){v=new Date,m.currentThreadStats=e,m.threadData[0].values.shift(),m.threadData[0].values.push({y:e.currentThreadCount}),m.threadData[1].values.shift(),m.threadData[1].values.push({y:e.daemonThreadCount}),m.threadData[2].values.shift(),m.threadData[2].values.push({y:e.totalStartedThreadCount}),m.threadData[3].values.shift(),m.threadData[3].values.push({y:e.peakThreadCount});for(var t=0;60>t;t++)for(var a=0;a<m.threadData.length;a++)m.threadData[a].values[t].x=t;y=r(p,g)})}var m=this;m.showDiagram=!0,m.maxDepth=3;var v,g=3e3;m.viewSource=function(e){var t=angular.element(e.currentTarget),a=t.attr("jns"),n=t.text();d.viewCode(a,n)},m.threadDump=function(e){o.dump({maxDepth:m.maxDepth,onlyDeadLock:e||!1},function(a){if(null==a&&e)return void n.info("no dead lock thread found.");c.open({animation:!0,templateUrl:"threadModal.html",controller:t,size:"lg",resolve:{data:{items:a,title:e?"deadlock threads":"all threads"}}})})};var h=i.outerHeight-570;300>h&&(h=300),m.needHighlight=function(e){if(m.highlightWords){var t=m.highlightWords.split(/\s+/),a=new RegExp("("+t.join(")|(")+")","gi");return a.test(e)}return!1},m.fixedContainer={height:h+"px"},m.threadOptions={chart:{type:"lineChart",height:200,xAxis:{tickFormat:function(e){return d3.time.format("%H:%M:%S")(new Date(v-(60-e)*g))}},yAxis:{tickFormat:function(e){return e}},tickFormat:function(e){return e},useInteractiveGuideline:!0}},m.threadData=[{values:[],key:"current count",color:"#2ca02c"},{values:[],key:"daemon count",color:"#ff7f0e"},{values:[],key:"total started count",disabled:!0,color:"#0066cc"},{values:[],key:"peak count",color:"#99cc00"}],m.threadInfo={},m.collapse=function(){m.showDiagram=!m.showDiagram},m.selectedItem=null,m.select=function(e){m.selectedItem&&(m.selectedItem.selected=!1),e.selected=!0,m.selectedItem=e,o.getDetail(e.id,{maxDepth:100},function(e){m.threadInfo=e})},m.formatTrace=e,m.refreshThreads=function(){m.totalCpu=0,m.threads=[],o.getAll(function(e){m.threads=e,m.totalCpu=e.reduce(function(e,t){return isNaN(e)?e.cpuTime+t.cpuTime:e+t.cpuTime})})},m.refreshThreads();for(var f=(m.threadData[0].values,m.threadData[1].values,0);60>f;f++)for(var b=0;b<m.threadData.length;b++)m.threadData[b].values.push({x:f,y:0});var y;p(),a.$on("$destroy",function(e){r.cancel(y)})}a.$inject=["$scope","toastr","$window","$element","$timeout","threadService","SiteCache","$uibModal","codeService","$rootScope"],t.$inject=["$scope","data","$uibModalInstance"],angular.module("viModule").controller("ThreadDumpController",a)}(),function(){"use strict";function e(e,t,a,n,i,s,r,o){var l=this,c={debug:0,metrics:1};l.debug={},l.metrics={},l.seleTab=c[r.tab||"debug"],l.debug.gitPrivateToken=t.get("gitPrivateToken"),l.debug.allowDebug="true"==t.get("allowDebug"),a.getTraceKey(function(e){l.oldTraceIdKey=e,l.debug.headerTraceIdKey=e}),i.get("vi.git.api.url",function(e){var t=e.substring(0,e.indexOf("/api/"));l.debug.gitlabAccountUrl=t+"/profile/account"}),l.debug.setAllowDebug=function(){l.debug.allowDebug?a.enableDebug(function(e){e instanceof VIException?(n.error("Message:"+e.Message+"\nType:"+e.Type),l.debug.allowDebug=!1):e||(n.warning("enable allow debug failed!!"),l.debug.allowDebug=!1),l.debug.save()}):l.debug.save()},e.$on("$destroy",function(){l.oldTraceIdKey!=l.debug.headerTraceIdKey&&a.setTraceKey({key:l.debug.headerTraceIdKey},function(e){e instanceof VIException?n.error("Message:"+e.Message+"\nType:"+e.Type):n.info("set header traceIdKey success!")})}),l.debug.save=function(){var e=t.get("gitPrivateToken"),a=t.get("allowDebug");t.put("gitPrivateToken",l.debug.gitPrivateToken),l.debug.gitPrivateToken&&e!=l.debug.gitPrivateToken&&o.$broadcast("$gitTokenChange"),t.put("allowDebug",l.debug.allowDebug),l.debug.allowDebug!=a&&o.$broadcast("$allowDebugChange")},l.metrics.seleClasses={},s.getAllModuleInfo(function(e){l.metrics.jars=e}),s.getNeedMetricsClasses(function(e){l.metrics.seleClasses={},e.forEach(function(e){l.metrics.seleClasses[e]={}})}),l.metrics.jarChange=function(){l.metrics.seleJar&&s.listClasses(l.metrics.seleJar,function(e){l.metrics.jarClasses=e.map(function(e){return{name:e}})})},l.metrics.seleClass=function(e){e.selected=!e.selected},l.metrics.addToSelect=function(e){s.addClassForMetrics(e.name,function(t){return t instanceof VIException?void n.error("Message:"+t.Message+"\nType:"+t.Type):void(e.name in l.metrics.seleClasses||(l.metrics.seleClasses[e.name]={}))})},l.metrics.removeSeleClass=function(e){s.removeMetricsClass(e,function(t){return t instanceof VIException?void n.error("Message:"+t.Message+"\nType:"+t.Type):void delete l.metrics.seleClasses[e]})}}e.$inject=["$scope","$cookies","codeService","toastr","configService","analyzerService","$stateParams","$rootScope"],angular.module("viModule").controller("SettingsController",e)}(),function(){"use strict";function e(e,t,a){t.values.sort(function(e,t){return t.value-e.value}),e.chartData=t.values.slice(0,t.values.length>10?10:t.values.length).map(function(e){return{key:e.label,y:e.value}}),e.chartOptions={chart:{type:"pieChart",height:500,x:function(e){return e.key},y:function(e){return e.y},showLabels:!0,duration:500,labelThreshold:.01,labelSunbeamLayout:!0,legend:{margin:{top:5,right:35,bottom:5,left:0}}}},angular.merge(e,t),e.close=function(){a.dismiss("cancel")}}function t(t,a,n,i,s,r,o,l,c,d,u,p,m,v){var g=this,h="",f={};g.seleTags={},g.tags=[];var b;g.maxHeight=m.innerHeight-100+"px";var y=function(){t.$apply(function(){g.maxHeight=m.innerHeight-100+"px"})};angular.element(m).on("resize",y),t.$on("$destroy",function(e){angular.element(m).off("resize",y)}),v.getInstance("log-detail-scrollbar").then(function(e){b=e});var w=n.size,C=Math.ceil(w/1024/1024),k=d3.range(1,C+1,1),x=-1,I=o[0].offsetWidth-60,M=d3.slider().min(1).max(C).tickValues([0,Math.ceil(C/2),C]).stepValues(k).tickFormat(function(e){return e+"MB"});M.callback(function(e){e!=x&&(x=e,g.loadingComplete=!1,f={},g.seleTags={},g.tags=[],g.showFilter=!1,g.isInFilter=!1,g.onBottom=null,N(e))}),M.value(C);var T=30*C;d3.select(".partion-selector").style("width",(T>I?I:T)+"px").call(M);var S,D=/(\[\s*([^\]\s]{2,80})\s*\])|(\d{4}-\d{2}-\d{2}\s\d{2}\:\d{2}\:\d{2}\.\d{3})/g,$=function(){var e=d3.select(this).attr("jns"),t=d3.select(this).text();p.viewCode(e,t)},N=function(e){g.foundCount=0,O=0,g.keyword="",g.currentMatches=null,i.getDetail(n.name,{encoding:a.search().encoding||"",partitionIndex:e},function(e){S=d3.select(o[0]).select(".log-list").on("click",function(){t.$apply(function(){g.showFilter=!1})});var a=!0,n="normal",i=0;g.lineData={},S.html(("\n"+e).replace(/\n([^\n]*)(?=\n)/g,function(e,t,s,r){var o=(t.length,!1),l=[];g.lineData[i]=[],g.lineData[i].push(l),t=t.replace(D,function(e,t,a,s,r){if(!a)return g.lineData[i].push(Date.parse(s)),(!g.minDate||g.minDate>g.lineData[i][1])&&(g.minDate=g.lineData[i][1]),(!g.maxDate||g.maxDate<g.lineData[i][1])&&(g.maxDate=g.lineData[i][1]),s;var c="["+a+"]";return 0===r&&(n=a,o=!0),l.push(a),a in f?f[a]++:(g.seleTags[a]=!1,f[a]=1),c});0===t.length&&(t="\n"),t=t.replace(/(\s+at\s+)(.+)\(([a-z0-9_\$]+\.java\:\d+)\)/i,function(e,t,a,n){var i,s=a.split(".");return s.length>3&&(i=s.slice(0,s.length-2).join(".")),t+a+'(<span jns="'+i+'" class="link stack-m">'+n+"</span>)"});var c='<div class="line" num="'+i++ +'">'+t+"</div>",d='<div class="area '+n+'"><div class="more">...</div><span class="tools"><span class="btn show-relate"><i class="fa fa-angle-double-up"></i><i class="fa fa-angle-double-down"></i></span></span>';return a?(a=!1,d+c):o?'<div class="more">...</div></div>'+d+c:c})+"</div>"),g.loadingComplete=!0,b.update(),b.scrollTo(0,0),S.selectAll("div.area>.more:first-child").on("click",function(){d3.select(this.parentElement.previousElementSibling).attr("show","show").attr("all","all").select(".more:last-child").attr("hide","hide"),d3.select(this).attr("hide","hide")}),S.selectAll("span.stack-m.link").on("click",$),S.selectAll("div.area>.tools").on("click",function(){var e=d3.select(this.parentElement);"all"==e.attr("all")?e.attr("all",null):e.attr("all","all")}),S.selectAll("div.area>.more:last-child").on("click",function(){d3.select(this.parentElement.nextElementSibling).attr("show","show").attr("all","all").select(".more:first-child").attr("hide","hide"),d3.select(this).attr("hide","hide")});for(var s in f)g.tags.push({key:s,count:f[s]})})};g.loadingComplete=!1,N(-1);var E={},O=0;g.getHighlightRegex=function(){var e=0!==h.length,t=[];g.tagRegex&&t.push(g.tagRegex),e&&t.push("("+(g.inRegexMode?h:RegExp.escape(h))+")");var a=new RegExp(t.join("|"),"ig");return a};var G=[];g.filterTag=function(e){E={},g.foundCount=0,g.currentMatches=null;var t=g.seleTags[e],a=0!==h.length;return t?(g.showFilter=!1,O++):O--,G=g.tags.filter(function(e){return g.seleTags[e.key]}),g.loadingComplete=!1,g.isInFilter=!0,0!==O||a?0>=O?(delete g.tagRegex,void g.search(!1)):(g.tagRegex=g.getFilterTags().map(function(e){return"("+e.key+")"}).join("|"),S.selectAll(".area").attr("all",null),S.selectAll(".line").each(function(n,i){var s=d3.select(this);this.tagCount=this.tagCount||0;var r,o=g.lineData[i][0].some(function(t){return t==e});o&&(t?(this.tagCount++,s.attr("show","show")):this.tagCount--,s.html(s.text().replace(g.getHighlightRegex(),function(e){return'<span class="highlight">'+e+"</span>"}))),r=this.tagCount<=0?null:d3.select(this).attr("show"),r=a&&!this.containWord?null:r;var l=d3.select(this.parentElement);s.attr("show",r),"show"==r?l.attr("show","show"):0===l.select(".line[show]").size()&&l.attr("show",null)}),g.loadingComplete=!0,b.update(),void b.scrollTo(0,0)):(delete g.tagRegex,void g.clearFilter())},g.clearFilter=function(){g.loadingComplete=!1,g.showFilter=!1,g.isInFilter=!1,O=0,g.keyword="",h="",S.selectAll(".area").attr("all",null),S.selectAll(".area").attr("show",null),S.selectAll(".line").attr("show",function(){return this.tagCount=0,delete this.containWord,null}),S.selectAll(".more").attr("hide",null);for(var e in g.seleTags)g.seleTags[e]=!1;g.loadingComplete=!0},g.getFilterTags=function(){return G};var P;g.asyncSearch=function(){g.loadingComplete=!1,null!==P&&d.cancel(P),g.keyword!=h&&(P=d(function(){g.search(!1),g.loadingComplete=!0},3))},g.reset=function(){g.keyword="",g.foundCount=0,g.currentMatches=null,g.search(!1)},g.upDown=function(){b.update();var e=b.getSize().content.height;b.scrollTo(0,g.onBottom?0:e),g.onBottom=!g.onBottom},g.showSearchStat=function(){var t=[];for(var a in g.currentMatches)t.push({label:a,value:g.currentMatches[a]});l.open({animation:!0,templateUrl:"log-detail-stat",controller:e,size:"llg",resolve:{data:{values:t,title:"Search result statistics - "+g.keyword}}})},g.search=function(e){if(0===O&&0===g.keyword.length)return void g.clearFilter();var t=g.keyword;g.loadingComplete=!1;try{t=!e&&g.inRegexMode?new RegExp(t,"gi"):new RegExp(RegExp.escape(t),"gi")}catch(a){return void c.error(a.message,"搜索条件有误")}S.selectAll(".area").attr("all",null),g.isInFilter=!0,g.foundCount=0,g.currentMatches={},h=g.keyword;var n=0!==h.length;S.selectAll(".line").each(function(){var e=d3.select(this),a=null;O>0&&(a=this.tagCount>0?"show":null);var i=e.text();if(n){if(0===O||"show"==a){var s=i.match(t)||[];0!==s.length?(angular.forEach(s,function(e){e in g.currentMatches?g.currentMatches[e]++:g.currentMatches[e]=1}),g.foundCount++,this.containWord=t,a="show"):(this.containWord=!1,a=null)}}else g.currentMatches=null,delete this.containWord;i=i.replace(g.getHighlightRegex(),function(e){return'<span class="highlight">'+e+"</span>"}),i=i.replace(/(\s+at\s+)(.+)\(([a-z0-9_\$]+\.java\:\d+)\)/i,function(e,t,a,n){var i,s=a.split(".");return s.length>3?(i=s.slice(0,s.length-2).join("."),i=angular.element("<span>"+i+"</span>").text(),t+a+'(<span jns="'+i+'" class="link stack-m">'+n+"</span>)"):e}),e.html(i),e.attr("show",a);var r=d3.select(this.parentElement);"show"==a?r.attr("show","show"):0===r.select(".line[show]").size()&&r.attr("show",null)}),S.selectAll("span.stack-m.link").on("click",$),g.loadingComplete=!0,b.update(),b.scrollTo(0,0)}}e.$inject=["$scope","data","$uibModalInstance"],t.$inject=["$scope","$location","$stateParams","logInfo","$sce","SiteCache","$element","$uibModal","toastr","$timeout","$rootScope","codeService","$window","ScrollbarService"],angular.module("viModule").controller("LogDetailController",t)}(),function(){"use strict";function e(e,t,a){var n=this;n.download=function(e){t.download(e.split("|")[0])},n.formatName=function(e){return e.replace(/@@/,"/")},t.getAll(function(e){n.rawLogs=e.map(function(e){return{name:e.name,modifiedTime:new Date(e.modifiedTime),size:e.size,href:"log/detail/"+e.name+"/"+e.size}})})}e.$inject=["$scope","logInfo","SiteCache"],angular.module("viModule").controller("LogController",e)}(),document["hljs.xmlhl"]=function(e){var t="[A-Za-z0-9\\._:-]+",a={endsWithParent:!0,illegal:/</,relevance:0,contains:[{className:"attr",begin:t,relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:!0,variants:[{begin:/"/,end:/"/},{begin:/'/,end:/'/},{begin:/[^\s"'=<>`]+/}]}]}]};return{aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist"],case_insensitive:!0,contains:[{className:"meta",begin:"<!DOCTYPE",end:">",relevance:10,contains:[{begin:"\\[",end:"\\]"}]},e.COMMENT("<!--","-->",{relevance:10}),{begin:"<\\!\\[CDATA\\[",end:"\\]\\]>",relevance:10},{begin:/<\?(php)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:!0}]},{className:"tag",begin:"<style(?=\\s|>|$)",end:">",keywords:{name:"style"},contains:[a],starts:{end:"</style>",returnEnd:!0,subLanguage:["css","xml"]}},{className:"tag",begin:"<script(?=\\s|>|$)",end:">",keywords:{name:"script"},contains:[a],starts:{end:"</script>",returnEnd:!0,subLanguage:["actionscript","javascript","handlebars","xml"]}},{className:"meta",variants:[{begin:/<\?xml/,end:/\?>/,relevance:10},{begin:/<\?\w+/,end:/\?>/}]},{className:"tag",begin:"</?",end:"/?>",contains:[{className:"name",begin:/[^\/><\s]+/,relevance:0},a]}]}},document["hljs.scsshl"]=function(e){var t="[a-zA-Z-][a-zA-Z0-9_-]*",a={className:"variable",begin:"(\\$"+t+")\\b"},n={className:"number",begin:"#[0-9A-Fa-f]+"};({className:"attribute",begin:"[A-Z\\_\\.\\-]+",end:":",excludeEnd:!0,illegal:"[^\\s]",starts:{endsWithParent:!0,excludeEnd:!0,contains:[n,e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,e.C_BLOCK_COMMENT_MODE,{className:"meta",begin:"!important"}]}});return{case_insensitive:!0,illegal:"[=/|']",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"selector-id",begin:"\\#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},{className:"selector-attr",begin:"\\[",end:"\\]",illegal:"$"},{className:"selector-tag",begin:"\\b(a|abbr|acronym|address|area|article|aside|audio|b|base|big|blockquote|body|br|button|canvas|caption|cite|code|col|colgroup|command|datalist|dd|del|details|dfn|div|dl|dt|em|embed|fieldset|figcaption|figure|footer|form|frame|frameset|(h[1-6])|head|header|hgroup|hr|html|i|iframe|img|input|ins|kbd|keygen|label|legend|li|link|map|mark|meta|meter|nav|noframes|noscript|object|ol|optgroup|option|output|p|param|pre|progress|q|rp|rt|ruby|samp|script|section|select|small|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|time|title|tr|tt|ul|var|video)\\b",relevance:0},{begin:":(visited|valid|root|right|required|read-write|read-only|out-range|optional|only-of-type|only-child|nth-of-type|nth-last-of-type|nth-last-child|nth-child|not|link|left|last-of-type|last-child|lang|invalid|indeterminate|in-range|hover|focus|first-of-type|first-line|first-letter|first-child|first|enabled|empty|disabled|default|checked|before|after|active)"},{begin:"::(after|before|choices|first-letter|first-line|repeat-index|repeat-item|selection|value)"},a,{className:"attribute",begin:"\\b(z-index|word-wrap|word-spacing|word-break|width|widows|white-space|visibility|vertical-align|unicode-bidi|transition-timing-function|transition-property|transition-duration|transition-delay|transition|transform-style|transform-origin|transform|top|text-underline-position|text-transform|text-shadow|text-rendering|text-overflow|text-indent|text-decoration-style|text-decoration-line|text-decoration-color|text-decoration|text-align-last|text-align|tab-size|table-layout|right|resize|quotes|position|pointer-events|perspective-origin|perspective|page-break-inside|page-break-before|page-break-after|padding-top|padding-right|padding-left|padding-bottom|padding|overflow-y|overflow-x|overflow-wrap|overflow|outline-width|outline-style|outline-offset|outline-color|outline|orphans|order|opacity|object-position|object-fit|normal|none|nav-up|nav-right|nav-left|nav-index|nav-down|min-width|min-height|max-width|max-height|mask|marks|margin-top|margin-right|margin-left|margin-bottom|margin|list-style-type|list-style-position|list-style-image|list-style|line-height|letter-spacing|left|justify-content|initial|inherit|ime-mode|image-orientation|image-resolution|image-rendering|icon|hyphens|height|font-weight|font-variant-ligatures|font-variant|font-style|font-stretch|font-size-adjust|font-size|font-language-override|font-kerning|font-feature-settings|font-family|font|float|flex-wrap|flex-shrink|flex-grow|flex-flow|flex-direction|flex-basis|flex|filter|empty-cells|display|direction|cursor|counter-reset|counter-increment|content|column-width|column-span|column-rule-width|column-rule-style|column-rule-color|column-rule|column-gap|column-fill|column-count|columns|color|clip-path|clip|clear|caption-side|break-inside|break-before|break-after|box-sizing|box-shadow|box-decoration-break|bottom|border-width|border-top-width|border-top-style|border-top-right-radius|border-top-left-radius|border-top-color|border-top|border-style|border-spacing|border-right-width|border-right-style|border-right-color|border-right|border-radius|border-left-width|border-left-style|border-left-color|border-left|border-image-width|border-image-source|border-image-slice|border-image-repeat|border-image-outset|border-image|border-color|border-collapse|border-bottom-width|border-bottom-style|border-bottom-right-radius|border-bottom-left-radius|border-bottom-color|border-bottom|border|background-size|background-repeat|background-position|background-origin|background-image|background-color|background-clip|background-attachment|background-blend-mode|background|backface-visibility|auto|animation-timing-function|animation-play-state|animation-name|animation-iteration-count|animation-fill-mode|animation-duration|animation-direction|animation-delay|animation|align-self|align-items|align-content)\\b",illegal:"[^\\s]"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:":",end:";",contains:[a,n,e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{className:"meta",begin:"!important"}]},{begin:"@",end:"[{;]",keywords:"mixin include extend for if else each while charset import debug media page content font-face namespace warn",contains:[a,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,n,e.CSS_NUMBER_MODE,{begin:"\\s[A-Za-z0-9_.-]+",relevance:0}]}]}},document["hljs.javahl"]=function(e){var t="[À-ʸa-zA-Z_$][À-ʸa-zA-Z_$0-9]*",a=t+"(<"+t+"(\\s*,\\s*"+t+")*>)?",n="false synchronized int abstract float private char boolean static null if const for true while long strictfp finally protected import native final void enum else break transient catch instanceof byte super volatile case assert short package default double public try this switch continue throws protected public private module requires exports do",i="\\b(0[bB]([01]+[01_]+[01]+|[01]+)|0[xX]([a-fA-F0-9]+[a-fA-F0-9_]+[a-fA-F0-9]+|[a-fA-F0-9]+)|(([\\d]+[\\d_]+[\\d]+|[\\d]+)(\\.([\\d]+[\\d_]+[\\d]+|[\\d]+))?|\\.([\\d]+[\\d_]+[\\d]+|[\\d]+))([eE][-+]?\\d+)?)[lLfF]?",s={
className:"number",begin:i,relevance:0};return{aliases:["jsp"],keywords:n,illegal:/<\/|#/,contains:[e.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{begin:/\w+@/,relevance:0},{className:"doctag",begin:"@[A-Za-z]+"}]}),e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,{className:"class",beginKeywords:"class interface",end:/[{;=]/,excludeEnd:!0,keywords:"class interface",illegal:/[:"\[\]]/,contains:[{beginKeywords:"extends implements"},e.UNDERSCORE_TITLE_MODE]},{beginKeywords:"new throw return else",relevance:0},{className:"function",begin:"("+a+"\\s+)+"+e.UNDERSCORE_IDENT_RE+"\\s*\\(",returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:n,contains:[{begin:e.UNDERSCORE_IDENT_RE+"\\s*\\(",returnBegin:!0,relevance:0,contains:[e.UNDERSCORE_TITLE_MODE]},{className:"params",begin:/\(/,end:/\)/,keywords:n,relevance:0,contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,e.C_NUMBER_MODE,e.C_BLOCK_COMMENT_MODE]},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},s,{className:"meta",begin:"@[A-Za-z]+"}]}},function(e){"use strict";var t="object"==typeof window&&window||"object"==typeof self&&self;"undefined"!=typeof exports?e(exports):t&&(t.hljs=e({}),"function"==typeof define&&define.amd&&define([],function(){return t.hljs}))}(function(e){function t(e){return e.replace(/[&<>]/gm,function(e){return $[e]})}function a(e){return e.nodeName.toLowerCase()}function n(e,t){var a=e&&e.exec(t);return a&&0===a.index}function i(e){return I.test(e)}function s(e){var t,a,n,s,r=e.className+" ";if(r+=e.parentNode?e.parentNode.className:"",a=M.exec(r))return y(a[1])?a[1]:"no-highlight";for(r=r.split(/\s+/),t=0,n=r.length;n>t;t++)if(s=r[t],i(s)||y(s))return s}function r(e){var t,a={},n=Array.prototype.slice.call(arguments,1);for(t in e)a[t]=e[t];return n.forEach(function(e){for(t in e)a[t]=e[t]}),a}function o(e){var t=[];return function n(e,i){for(var s=e.firstChild;s;s=s.nextSibling)3===s.nodeType?i+=s.nodeValue.length:1===s.nodeType&&(t.push({event:"start",offset:i,node:s}),i=n(s,i),a(s).match(/br|hr|img|input/)||t.push({event:"stop",offset:i,node:s}));return i}(e,0),t}function l(e,n,i){function s(){return e.length&&n.length?e[0].offset!==n[0].offset?e[0].offset<n[0].offset?e:n:"start"===n[0].event?e:n:e.length?e:n}function r(e){function n(e){return" "+e.nodeName+'="'+t(e.value)+'"'}d+="<"+a(e)+w.map.call(e.attributes,n).join("")+">"}function o(e){d+="</"+a(e)+">"}function l(e){("start"===e.event?r:o)(e.node)}for(var c=0,d="",u=[];e.length||n.length;){var p=s();if(d+=t(i.substring(c,p[0].offset)),c=p[0].offset,p===e){u.reverse().forEach(o);do l(p.splice(0,1)[0]),p=s();while(p===e&&p.length&&p[0].offset===c);u.reverse().forEach(r)}else"start"===p[0].event?u.push(p[0].node):u.pop(),l(p.splice(0,1)[0])}return d+t(i.substr(c))}function c(e){return e.variants&&!e.cached_variants&&(e.cached_variants=e.variants.map(function(t){return r(e,{variants:null},t)})),e.cached_variants||e.endsWithParent&&[r(e)]||[e]}function d(e){function t(e){return e&&e.source||e}function a(a,n){return new RegExp(t(a),"m"+(e.case_insensitive?"i":"")+(n?"g":""))}function n(i,s){if(!i.compiled){if(i.compiled=!0,i.keywords=i.keywords||i.beginKeywords,i.keywords){var r={},o=function(t,a){e.case_insensitive&&(a=a.toLowerCase()),a.split(" ").forEach(function(e){var a=e.split("|");r[a[0]]=[t,a[1]?Number(a[1]):1]})};"string"==typeof i.keywords?o("keyword",i.keywords):C(i.keywords).forEach(function(e){o(e,i.keywords[e])}),i.keywords=r}i.lexemesRe=a(i.lexemes||/\w+/,!0),s&&(i.beginKeywords&&(i.begin="\\b("+i.beginKeywords.split(" ").join("|")+")\\b"),i.begin||(i.begin=/\B|\b/),i.beginRe=a(i.begin),i.end||i.endsWithParent||(i.end=/\B|\b/),i.end&&(i.endRe=a(i.end)),i.terminator_end=t(i.end)||"",i.endsWithParent&&s.terminator_end&&(i.terminator_end+=(i.end?"|":"")+s.terminator_end)),i.illegal&&(i.illegalRe=a(i.illegal)),null==i.relevance&&(i.relevance=1),i.contains||(i.contains=[]),i.contains=Array.prototype.concat.apply([],i.contains.map(function(e){return c("self"===e?i:e)})),i.contains.forEach(function(e){n(e,i)}),i.starts&&n(i.starts,s);var l=i.contains.map(function(e){return e.beginKeywords?"\\.?("+e.begin+")\\.?":e.begin}).concat([i.terminator_end,i.illegal]).map(t).filter(Boolean);i.terminators=l.length?a(l.join("|"),!0):{exec:function(){return null}}}}n(e)}function u(e,a,i,s){function r(e,t){var a,i;for(a=0,i=t.contains.length;i>a;a++)if(n(t.contains[a].beginRe,e))return t.contains[a]}function o(e,t){if(n(e.endRe,t)){for(;e.endsParent&&e.parent;)e=e.parent;return e}return e.endsWithParent?o(e.parent,t):void 0}function l(e,t){return!i&&n(t.illegalRe,e)}function c(e,t){var a=w.case_insensitive?t[0].toLowerCase():t[0];return e.keywords.hasOwnProperty(a)&&e.keywords[a]}function m(e,t,a,n){var i=n?"":D.classPrefix,s='<span class="'+i,r=a?"":S;return s+=e+'">',s+t+r}function v(){var e,a,n,i;if(!x.keywords)return t(T);for(i="",a=0,x.lexemesRe.lastIndex=0,n=x.lexemesRe.exec(T);n;)i+=t(T.substring(a,n.index)),e=c(x,n),e?($+=e[1],i+=m(e[0],t(n[0]))):i+=t(n[0]),a=x.lexemesRe.lastIndex,n=x.lexemesRe.exec(T);return i+t(T.substr(a))}function g(){var e="string"==typeof x.subLanguage;if(e&&!k[x.subLanguage])return t(T);var a=e?u(x.subLanguage,T,!0,I[x.subLanguage]):p(T,x.subLanguage.length?x.subLanguage:void 0);return x.relevance>0&&($+=a.relevance),e&&(I[x.subLanguage]=a.top),m(a.language,a.value,!1,!0)}function h(){M+=null!=x.subLanguage?g():v(),T=""}function f(e){M+=e.className?m(e.className,"",!0):"",x=Object.create(e,{parent:{value:x}})}function b(e,t){if(T+=e,null==t)return h(),0;var a=r(t,x);if(a)return a.skip?T+=t:(a.excludeBegin&&(T+=t),h(),a.returnBegin||a.excludeBegin||(T=t)),f(a,t),a.returnBegin?0:t.length;var n=o(x,t);if(n){var i=x;i.skip?T+=t:(i.returnEnd||i.excludeEnd||(T+=t),h(),i.excludeEnd&&(T=t));do x.className&&(M+=S),x.skip||($+=x.relevance),x=x.parent;while(x!==n.parent);return n.starts&&f(n.starts,""),i.returnEnd?0:t.length}if(l(t,x))throw new Error('Illegal lexeme "'+t+'" for mode "'+(x.className||"<unnamed>")+'"');return T+=t,t.length||1}var w=y(e);if(!w)throw new Error('Unknown language: "'+e+'"');d(w);var C,x=s||w,I={},M="";for(C=x;C!==w;C=C.parent)C.className&&(M=m(C.className,"",!0)+M);var T="",$=0;try{for(var N,E,O=0;;){if(x.terminators.lastIndex=O,N=x.terminators.exec(a),!N)break;E=b(a.substring(O,N.index),N[0]),O=N.index+E}for(b(a.substr(O)),C=x;C.parent;C=C.parent)C.className&&(M+=S);return{relevance:$,value:M,language:e,top:x}}catch(G){if(G.message&&-1!==G.message.indexOf("Illegal"))return{relevance:0,value:t(a)};throw G}}function p(e,a){a=a||D.languages||C(k);var n={relevance:0,value:t(e)},i=n;return a.filter(y).forEach(function(t){var a=u(t,e,!1);a.language=t,a.relevance>i.relevance&&(i=a),a.relevance>n.relevance&&(i=n,n=a)}),i.language&&(n.second_best=i),n}function m(e){return D.tabReplace||D.useBR?e.replace(T,function(e,t){return D.useBR&&"\n"===e?"<br>":D.tabReplace?t.replace(/\t/g,D.tabReplace):""}):e}function v(e,t,a){var n=t?x[t]:a,i=[e.trim()];return e.match(/\bhljs\b/)||i.push("hljs"),-1===e.indexOf(n)&&i.push(n),i.join(" ").trim()}function g(e){var t,a,n,r,c,d=s(e);if(!i(d)){if(D.useBR)t=document.createElementNS("http://www.w3.org/1999/xhtml","div"),t.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n");else{var g=1;e.innerHTML='<div class="line"><span class="line-number">1</span>'+e.innerHTML.replace(/\n/g,function(e,t){return'\n</div><div class="line"><span class="line-number"><i class="fa fa-circle"></i>'+ ++g+"</span>"}),t=e}c=t.textContent,n=d?u(d,c,!0):p(c),a=o(t),a.length&&(r=document.createElementNS("http://www.w3.org/1999/xhtml","div"),r.innerHTML=n.value,n.value=l(a,o(r),c)),n.value=m(n.value),e.innerHTML=n.value,e.className=v(e.className,d,n.language),e.result={language:n.language,re:n.relevance},n.second_best&&(e.second_best={language:n.second_best.language,re:n.second_best.relevance})}}function h(e){D=r(D,e)}function f(t,a){var n=k[t]=a(e);n.aliases&&n.aliases.forEach(function(e){x[e]=t})}function b(){return C(k)}function y(e){return e=(e||"").toLowerCase(),k[e]||k[x[e]]}var w=[],C=Object.keys,k={},x={},I=/^(no-?highlight|plain|text)$/i,M=/\blang(?:uage)?-([\w-]+)\b/i,T=/((^(<[^>]+>|\t|)+|(?:\n)))/gm,S="</span>",D={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0},$={"&":"&amp;","<":"&lt;",">":"&gt;"};return e.highlight=u,e.highlightAuto=p,e.fixMarkup=m,e.highlightBlock=g,e.configure=h,e.registerLanguage=f,e.listLanguages=b,e.getLanguage=y,e.inherit=r,e.IDENT_RE="[a-zA-Z]\\w*",e.UNDERSCORE_IDENT_RE="[a-zA-Z_]\\w*",e.NUMBER_RE="\\b\\d+(\\.\\d+)?",e.C_NUMBER_RE="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",e.BINARY_NUMBER_RE="\\b(0b[01]+)",e.RE_STARTERS_RE="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",e.BACKSLASH_ESCAPE={begin:"\\\\[\\s\\S]",relevance:0},e.APOS_STRING_MODE={className:"string",begin:"'",end:"'",illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},e.QUOTE_STRING_MODE={className:"string",begin:'"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},e.PHRASAL_WORDS_MODE={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|like)\b/},e.COMMENT=function(t,a,n){var i=e.inherit({className:"comment",begin:t,end:a,contains:[]},n||{});return i.contains.push(e.PHRASAL_WORDS_MODE),i.contains.push({className:"doctag",begin:"(?:TODO|FIXME|NOTE|BUG|XXX):",relevance:0}),i},e.C_LINE_COMMENT_MODE=e.COMMENT("//","$"),e.C_BLOCK_COMMENT_MODE=e.COMMENT("/\\*","\\*/"),e.HASH_COMMENT_MODE=e.COMMENT("#","$"),e.NUMBER_MODE={className:"number",begin:e.NUMBER_RE,relevance:0},e.C_NUMBER_MODE={className:"number",begin:e.C_NUMBER_RE,relevance:0},e.BINARY_NUMBER_MODE={className:"number",begin:e.BINARY_NUMBER_RE,relevance:0},e.CSS_NUMBER_MODE={className:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},e.REGEXP_MODE={className:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[e.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[e.BACKSLASH_ESCAPE]}]},e.TITLE_MODE={className:"title",begin:e.IDENT_RE,relevance:0},e.UNDERSCORE_TITLE_MODE={className:"title",begin:e.UNDERSCORE_IDENT_RE,relevance:0},e.METHOD_GUARD={begin:"\\.\\s*"+e.UNDERSCORE_IDENT_RE,relevance:0},e}),document["hljs.csshl"]=function(e){var t="[a-zA-Z-][a-zA-Z0-9_-]*",a={begin:/[A-Z\_\.\-]+\s*:/,returnBegin:!0,end:";",endsWithParent:!0,contains:[{className:"attribute",begin:/\S/,end:":",excludeEnd:!0,starts:{endsWithParent:!0,excludeEnd:!0,contains:[{begin:/[\w-]+\(/,returnBegin:!0,contains:[{className:"built_in",begin:/[\w-]+/},{begin:/\(/,end:/\)/,contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]}]},e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,e.C_BLOCK_COMMENT_MODE,{className:"number",begin:"#[0-9A-Fa-f]+"},{className:"meta",begin:"!important"}]}}]};return{case_insensitive:!0,illegal:/[=\/|'\$]/,contains:[e.C_BLOCK_COMMENT_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/},{className:"selector-class",begin:/\.[A-Za-z0-9_-]+/},{className:"selector-attr",begin:/\[/,end:/\]/,illegal:"$"},{className:"selector-pseudo",begin:/:(:)?[a-zA-Z0-9\_\-\+\(\)"'.]+/},{begin:"@(font-face|page)",lexemes:"[a-z-]+",keywords:"font-face page"},{begin:"@",end:"[{;]",illegal:/:/,contains:[{className:"keyword",begin:/\w+/},{begin:/\s/,endsWithParent:!0,excludeEnd:!0,relevance:0,contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,e.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:t,relevance:0},{begin:"{",end:"}",illegal:/\S/,contains:[e.C_BLOCK_COMMENT_MODE,a]}]}},function(){"use strict";function e(e,t,a,n){e.fcs=n.items,e.ok=function(){for(var n={},i=0;i<e.fcs.length;i++){var s=e.fcs[i];n[s.key]=s.value}t.update(n,function(e){a.close(e)})},e.cancel=function(){a.dismiss("cancel")}}function t(t,a,n,i,s){var r=this;r.hasAuthority=!0,r.fcCollection=[],n.getAll(function(e,t){(t&i.ALL)!=i.ALL&&(t&i.EDIT)!=i.EDIT&&(r.hasAuthority=!1);for(var a in e){var n=e[a][0],s=e[a][1];r.fcCollection.push({key:a,value:n,old:n,remark:s})}}),r.displayCollection=[],r.fcNames=["all","appsettings","centralfc"],r.selectedFC="all",r.fcFilter=function(e){return"all"==r.selectedFC?!0:e.belongFC==r.selectedFC},r.openModal=function(){var t=r.fcCollection.filter(function(e){return e.old!=e.value}),n=a.open({animation:!0,templateUrl:"fcModal.html",controller:e,size:"lg",resolve:{modifiedItems:{items:t}}});n.result.then(function(e){if(e instanceof VIException)return s.error(e.Message,"submit failed!"),!1;s.success("submit success!");for(var t=0;t<r.fcCollection.length;t++){var a=r.fcCollection[t];a.old=a.value}},function(){})},t.$on("$stateChangeStart",function(e){var t=r.fcCollection.findIndex(function(e){return e.old!=e.value});t>=0&&(confirm("有未保存的改动，确认离开页面吗？")||e.preventDefault())})}t.$inject=["$scope","$uibModal","fcService","Permission","toastr"],e.$inject=["$scope","fcService","$uibModalInstance","modifiedItems"],angular.module("viModule").controller("FCController",t)}(),function(){"use strict";angular.module("viModule").controller("DashboardController",["$document","$element","$scope","metricsService","$timeout","toastr","$location",function(e,t,a,n,i,s,r){function o(e,t){return(1>e?VIUtil.noop:Math.round)(t)/e}function l(){n.getCurrent(c,function(e){if(e instanceof VIException)return void s.error(e.Message,"error");for(var t,t=0,a=d.selectedNames.length,n=0;a>t;t++,n++){var r,c,v=d.selectedNames[t],h=d.chartData[t],y=u[t],w=0,C=0,k=[];if(e&&e[v]){var x=e[v];w=x.count,r=o(y,x.total/x.count),c=o(y,x.max),C=o(y,x.min),k=x.percentileValues}if(!h.values)return;if(h.values.push({x:f,y:w}),v.length>5&&"##"==v.substr(-2,2))n--;else{var I=d.chartCostData[3*n];angular.forEach(p,function(e,t){d.chartCostData[3*n+t+1].values.push({x:f,y:o(y,k[t])})});var M=d.chartCostData[3*n+1+p.length],T=d.chartCostData[3*n+2+p.length];if(I.values.push({x:f,y:r}),M.values.push({x:f,y:c}),T.values.push({x:f,y:C}),h.values.length>b){var S=b/2;h.values.splice(0,S),I.values.splice(0,S),M.values.splice(0,S),T.values.splice(0,S),angular.forEach(p,function(e,t){d.chartCostData[3*n+t+1].values.splice(0,S)})}}}f++,d.nowDate=d3.time.format("%Y-%m-%d %H:%M:%S")(new Date),1==f?l():m=i(l,g)})}var c,d=this,u=[];d.metrics=[],d.openSettings=function(){r.url("/settings/metrics")},d.metricName=function(e){return/.*##\d*$/.test(e)?e.substr(0,e.lastIndexOf("#")-1):e},d.onKeyDown=function(e){if(d.isOpen||38!=e.keyCode&&40!=e.keyCode||(d.isOpen=!0),d.isOpen){var t=d.list.length;switch(e.keyCode){case 13:d.isOpen=!1,d.selectName(d.list[d.selectedIndex]);break;case 38:d.selectedIndex?(d.selectedIndex--,d.selectedIndex<=0&&(d.selectedIndex=0)):d.selectedIndex=t-1;break;case 40:d.selectedIndex>=0?(d.selectedIndex++,d.selectedIndex>=t&&(d.selectedIndex=0)):d.selectedIndex=0}}},d.toggled=function(){d.isOpen&&n.getNames(function(e){d.metrics=e}),d.isOpen=!0};d.chartData=[],d.chartCostData=[];var p=[];d.monitor=function(){if(d.enablePercentile&&0==p.length?(p=[99.9,95],c=null):!d.enablePercentile&&p.length>0&&(p=[],c=null),0==d.selectedNames.length)return void s.warning("you must select metrics first!","warning");var e={names:d.selectedNames,percentiles:p};c&&(e.id=c),n.register(e,function(e){if(e instanceof VIException)return s.error(e.Message,"register failed"),!1;c=e,v=new Date,m&&i.cancel(m),d.chartData=[],d.chartCostData=[],f=0;for(var t=0,t=0;t<d.selectedNames.length;t++){var a=d.metricName(d.selectedNames[t]);d.chartData.push({values:[],key:a+".count",color:h[t]}),a.length>5&&"##"==a.substr(-2,2)||(d.chartCostData.push({values:[],key:a+".average",color:h[t]}),angular.forEach(p,function(e){d.chartCostData.push({values:[],key:a+"."+e+"Line",color:h[t]})}),d.chartCostData.push({values:[],key:a+".max",disabled:!0,color:h[t]}),d.chartCostData.push({values:[],key:a+".min",disabled:!0,color:h[t]}))}l()})},d.selectedNames=[],u=[],d.selectName=function(e){if(d.selectedNames.length>4)return void s.warning("max metrics count is 5!");if(d.selectedNames.indexOf(e)<0){d.selectedNames.push(e);var t=e.split("##"),a=1;switch(t.length>1?t[1]:"-1"){case"0":a=.001;break;case"2":a=1e3}u.push(a)}else s.warning("already exist!")},d.removeName=function(e){VIUtil.removeArrayItem(d.selectedNames,e)};var m,v,g=1e3;d.startDate=d3.time.format("%Y-%m-%d %H:%M:%S")(new Date),d.chartOptions={chart:{type:"lineWithFocusChart",height:250,forceX:[100],forceY:[0,5],noData:"",xAxis:{tickFormat:function(e){return d3.time.format("%H:%M:%S")(new Date(v-0+e*g))}},x2Axis:{tickFormat:function(e){return d3.time.format("%H:%M:%S")(new Date(v-0+e*g))}},yAxis:{axisLabel:"Count",tickFormat:function(e){return VIUtil.formatNumber(e)}},tickFormat:function(e){return e},useInteractiveGuideline:!0}},d.chartCostOptions=angular.copy(d.chartOptions),d.chartCostOptions.chart.yAxis.axisLabel="MilliSecond",d.chartCostOptions.chart.forceY=[1];var h=d3.scale.category20().range(),f=0,b=1800;a.$on("$destroy",function(e){i.cancel(m)})}])}(),function(){"use strict";function e(e,t,a,n,i){e.configs=n.items,e.ok=function(){for(var n={},s=0;s<e.configs.length;s++){var r=e.configs[s];n[r.key]=r.value}t.update(n,function(e){i.success("submit success!"),a.close(!0)})},e.cancel=function(){a.dismiss("cancel")}}function t(t,a,n){var i=this;i.configCollection=[],i.configGroups=[{name:"all",value:"all"}],a.getAll(function(e){for(var t in e){var a="#"==t;i.configGroups.push({name:a?"[readonly]":t,value:t});for(var n in e[t])i.configCollection.push({key:a?n.substr(2):n,old:e[t][n],value:e[t][n],readOnly:a,belongConfig:t})}}),a.getRemarks(function(e){for(var t in e){var a=i.configCollection.filter(function(e){return e.key==t});a.length>0&&(a[0].description=e[t])}}),i.selectedConfig="all",i.configFilter=function(e){return"all"==i.selectedConfig?!0:e.belongConfig==i.selectedConfig},i.openModal=function(t){var a=i.configCollection.filter(function(e){return e.old!=e.value}),s=n.open({animation:!0,templateUrl:"configModal.html",controller:e,size:"lg",resolve:{modifiedItems:{items:a}}});s.result.then(function(e){if(e)for(var t=0;t<i.configCollection.length;t++){var a=i.configCollection[t];a.old=a.value}},function(){})},t.$on("$stateChangeStart",function(e){var t=i.configCollection.findIndex(function(e){return e.old!=e.value});t>=0&&(confirm("有未保存的改动，确认离开页面吗？")||e.preventDefault())})}t.$inject=["$scope","configService","$uibModal"],e.$inject=["$scope","configService","$uibModalInstance","modifiedItems","toastr"],angular.module("viModule").controller("ConfigController",t)}(),function(){"use strict";angular.module("viModule").directive("viView",["$compile",function(e){return{restrict:"E",scope:{controller:"@",url:"@",params:"@"},link:function(t,a,n){var i=e('<div params="'+n.params+'" ng-controller="'+n.controller+'"><div ng-include="\''+n.url+"'\" /></div>")(t);a.html("").append(i),t.$emit("$viewContentLoaded")}}}])}(),function(){"use strict";angular.module("viModule").directive("stStickyHeader",["$window",function(e){return{require:"^?stTable",link:function(t,a,n,i){var s=lrStickyHeader(a[0],{headerHeight:n.stStickyHeaderTop});t.$on("$destroy",function(){s.clean()}),t.$watch(function(){return i.tableState()},function(){e.scrollTo(0,lrStickyHeader.treshold)},!0)}}}]).directive("searchWatchModel",function(){return{require:"^stTable",scope:{searchWatchModel:"="},link:function(e,t,a,n){e.$watch("searchWatchModel",function(e){e?n.search(e):(n.tableState().search.predicateObject=null,n.tableState().pagination.start=0,n.pipe())})}}})}(),function(){"use strict";angular.module("viModule").directive("onComplete",["$timeout",function(e){return{restrict:"A",link:function(t,a,n){t.$last===!0&&e(function(){var e=t.$eval(n.onComplete);e(a,t)})}}}])}(),nv.models.stepsChart=function(){"use strict";function e(r){return d.reset(),r.each(function(r){function o(){return l==g-1?v-60:h*l}function d(e,a){var n="lightgreen";return"Success"==t?"green":("Failure"==t&&(n="red"),a>l?"#eee":a==l?n:"green")}function u(e,t,a){var n=m.selectAll("g").data(e).enter().append("g").attr("class","step").attr("transform",function(e,n){var i=n*a;return n==t-1&&(i=v-60),"translate("+i+",0)"}).on("mouseover",function(e){s.data({id:e.id,name:e.className,before:e.before,after:e.after,series:{}}).hidden(!1)}).on("mouseout",function(e){s.hidden(!0)}).on("click",function(e){c(e)});n.append("circle").attr("r",8).style("stroke","#ddd").style("stroke-width","2px").style("fill",d),n.append("text").style("text-anchor","middle").attr("y",function(e,a){return a%2==0||10>t?25:35}).text(function(e){return e.id})}var p=d3.select(this),m=p.append("g").attr("class","nv-stepsChart").attr("transform","translate(30,30)");nv.utils.initSVG(p);var v=nv.utils.availableWidth(n,p,a);nv.utils.availableHeight(i,p,a);e.update=function(){p.selectAll("*").remove(),p.transition().call(e)},e.updateStatus=function(e,a){l=e,t=a,p.selectAll("circle").style("fill",d),p.select("line.steps-progress").attr("x2",o)},e.container=this,m.append("line").style("stroke","#ccc").attr("x1",0).attr("y1",0).attr("x2",v-60).attr("y2",0);var g=r.length,h=v/(g-1);m.append("line").attr("class","steps-progress").style("stroke","#555").attr("x1",0).attr("y1",0).attr("x2",o).attr("y2",0),u(r,g,h)}),d.renderEnd("steps chart immediate"),e}var t,a={top:0,right:0,bottom:0,left:0},n=null,i=null,s=(nv.utils.defaultColor(),nv.models.tooltip()),r=null,o=d3.dispatch("renderEnd"),l=0,c=function(){},d=nv.utils.renderWatch(o);return s.contentGenerator(function(e){return'<div class="steps-tooltip" style="padding:10px"><div class="row"><div class="col-md-3" style="text-align: right;font-weight:bolder">ID:</div><div style="padding:0px" class="col-md-9">'+e.id+'</div></div><div class="row"><div class="col-md-3" style="text-align: right;font-weight:bolder">ClassName:</div><div class="content col-md-9" style="padding:0px">'+e.name+'</div></div><div class="row"><div class="col-md-3" style="text-align: right;font-weight:bolder">Before:</div><div class="content col-md-9" style="padding:0px">'+e.before+'&nbsp; </div></div><div class="row"><div class="col-md-3" style="text-align: right;font-weight:bolder">After:</div><div class="content col-md-9" style="padding:0px">'+e.after+"</div></div></div>"}),e.dispatch=o,e.options=nv.utils.optionsFunc.bind(e),e._options=Object.create({},{width:{get:function(){return n},set:function(e){n=e}},stepClick:{get:function(){return c},set:function(e){c=e}},currentIndex:{get:function(){return l},set:function(e){l=e}},currentStatus:{get:function(){return t},set:function(e){t=e}},height:{get:function(){return i},set:function(e){i=e}},noData:{get:function(){return r},set:function(e){r=e}},margin:{get:function(){return a},set:function(e){a.top=void 0!==e.top?e.top:a.top,a.right=void 0!==e.right?e.right:a.right,a.bottom=void 0!==e.bottom?e.bottom:a.bottom,a.left=void 0!==e.left?e.left:a.left}}}),nv.utils.initOptions(e),e},function(){"use strict";angular.module("viModule").directive("elemReady",["$parse",function(e){return{restrict:"A",link:function(t,a,n){a.ready(function(){t.$apply(function(){var a=e(n.elemReady);a(t)})})}}}])}(),function(){"use strict";angular.module("viModule").directive("elastic",["$timeout",function(e){return{require:"ngModel",restrict:"A",link:function(e,t,a){e.initialHeight=e.initialHeight||t[0].style.height;var n=function(){t[0].style.height=e.initialHeight,t[0].style.height=""+t[0].scrollHeight+"px"};e.$watch(a.ngModel,function(){n()})}}}])}(),function(){d3.hexbin=function(){function n(e){var t={};return e.forEach(function(e,a){var i=u.call(n,e,a)/o,s=Math.round(i),l=d.call(n,e,a)/r-(1&s?.5:0),c=Math.round(l),p=i-s;if(3*Math.abs(p)>1){var m=l-c,v=c+(c>l?-1:1)/2,g=s+(s>i?-1:1),h=l-v,f=i-g;m*m+p*p>h*h+f*f&&(c=v+(1&s?1:-1)/2,s=g)}var b=c+"-"+s,y=t[b];y?y.push(e):(y=t[b]=[e],y.i=c,y.j=s,y.x=(c+(1&s?.5:0))*r,y.y=s*o)}),d3.values(t)}function i(t){var a=0,n=0;return e.map(function(e){var i=Math.sin(e)*t,s=-Math.cos(e)*t,r=i-a,o=s-n;return a=i,n=s,[r,o]})}var s,r,o,l=1,c=1,d=t,u=a;return n.x=function(e){return arguments.length?(d=e,n):d},n.y=function(e){return arguments.length?(u=e,n):u},n.hexagon=function(e){return arguments.length<1&&(e=s),"m"+i(e).join("l")+"z"},n.centers=function(){for(var e=[],t=0,a=!1,n=0;c+s>t;t+=o,a=!a,++n)for(var i=a?r/2:0,d=0;l+r/2>i;i+=r,++d){var u=[i,t];u.i=d,u.j=n,e.push(u)}return e},n.mesh=function(){var e=i(s).slice(0,4).join("l");return n.centers().map(function(t){return"M"+t+"m"+e}).join("")},n.size=function(e){return arguments.length?(l=+e[0],c=+e[1],n):[l,c]},n.radius=function(e){return arguments.length?(s=+e,r=2*s*Math.sin(Math.PI/3),o=1.5*s,n):s},n.radius(1)};var e=d3.range(0,2*Math.PI,Math.PI/3),t=function(e){return e[0]},a=function(e){return e[1]}}(),function(){"use strict";angular.module("viModule").directive("compile",["$compile",function(e){return function(t,a,n){t.$watch(function(e){return e.$eval(n.compile)},function(n){a.html(n),e(a.contents())(t)})}}])}(),function(){"use strict";angular.module("viModule").controller("ComponentDetailListController",["$stateParams","SiteCache","serviceInfo","toastr",function(e,t,a,n){var i=e.id,s=this;s.rowCollection=[],s.colCollection=[],s.componentName=e.name,s.hasMeta=!1,s.colCount=3,s.total={},s.getTotal=function(e,t){if(e in s.total)switch(t){case"Bytes":return VIUtil.formatBytes(s.total[e]);case"Number":return VIUtil.formatNumber(s.total[e])}return""},a.doComponentMethod(e.id,"list").then(function(e){if(!(e.length<=0)){var a=t.get("fieldMeta"),n=a.filter(function(e){return 0===e.id.indexOf(i)});s.colCount=n.length;for(var r=Math.floor(100/n.length),o=0;o<n.length;o++){var l=n[o],c="*";0!==o&&(c=r+"%");var d=function(e){return e},u=l.name,p=l.id.substr(l.id.lastIndexOf(".")+1).toLowerCase(),m=l.description;switch(l.type){case"Bytes":s.total[p]=0,s.hasTotal=!0,d=VIUtil.formatBytes;break;case"Number":s.hasTotal=!0,s.total[p]=0,d=VIUtil.formatNumber}s.colCollection.push({name:u,field:p,type:l.type,width:c,description:m,formatFn:d})}for(o=0;o<e.length;o++){var v=e[o];for(var g in v){var h=g.toLowerCase();/[A-Z]/.test(g)&&(v[h]=v[g],delete v[g]),h in s.total&&(s.total[h]+=v[h])}}s.rowCollection=e}})}])}(),function(){"use strict";angular.module("viModule").controller("ComponentDetailController",["$stateParams","SiteCache","serviceInfo","$scope","ApiService",function(e,t,a,n,i){var s=e.id,r=s,o=this;o.rowCollection=[],o.componentName=e.name,o.hasMeta=!1;var l=t.get("fieldMeta"),c=function(){a.getComponentInfo(s).then(function(e){for(var t=l.filter(function(e){return 0==e.id.search(r.replace(".","\\.")+"\\.[^\\.]+$")}),a=0;a<t.length;a++){var s=t[a],c=s.id.replace(r,"").substr(1);if(c in e){var d={name:s.name,fname:c,value:e[c],description:s.description},u=/@{[^{]*}/g,p=(d.description||"").match(u);if(null!=p&&p.length>0&&(d.description=d.description.replace(u,""),angular.merge(d,n.$eval(p[0].substr(1)))),d.isLink)d.value='<a target="_blank" href="'+i.getAbsoluteUrl("/download/config/"+d.value)+'">查看</a>';else if(s)switch(o.hasMeta=!0,s.type){case"Bytes":d.value=VIUtil.formatBytes(d.value);break;case"Number":d.value=VIUtil.formatNumber(d.value)}d.value instanceof Object&&(d.objValue=d.value,delete d.value),o.rowCollection.push(d)}}if(0===o.rowCollection.length)for(var m in e){var v=e[m],g={name:m};v instanceof Object?g.objValue=v:g.value=v,o.rowCollection.push(g)}})};l.filter?c():n.$on("fieldMeta",function(e,t){l=t,c()})}])}(),function(){"use strict";function e(e,t,a,n,i,s,r,o,l,c,d){function u(){a.getComponentInfo("vi.appinfo").then(function(e){if(e){f=e.upTime,e.upTime=VIUtil.calculateRunTime(e.upTime),p.buildInfo=g(e,"vi.appinfo");for(var n=0;n<p.buildInfo.length;n++)if("upTime"==p.buildInfo[n].fname){h=p.buildInfo[n];break}var s=l.get("vi-user");m=s&&s.length>2&&s==e.appOwner,i.$broadcast("appinfo.ready",e),("Uninitiated"==e.appStatus||"Initiating"==e.appStatus)&&a.loopWithPeriod(t,"vi.appinfo",2500,function(e){for(var t in e)angular.forEach(p.buildInfo,function(a){a.fname==t&&(a.value=e[t])});return"Uninitiated"==e.appStatus||"Initiating"==e.appStatus},"appStatus,latestNews")}}),a.getHostInfo().then(function(e){n.put("hostInfo",e),p.sysInfo=g(e,"vi.hostinfo");var i=2500;p.timer=a.loopWithPeriod(t,"vi.hostinfo",i,function(e){for(var t in e)angular.forEach(p.sysInfo,function(a){a.fname==t&&(a.value=e[t],p.sysInfoPretreatment(a))});return h&&(f+=i,h.value=VIUtil.calculateRunTime(f)),!0},"systemCpuLoad,availableMem,PhysicalMemoryAvaliable,DiskAvaliable,openFileDescriptorCount,cpuLoadAverages,processCpuTime,processCpuLoad")})}var p=this,m=!1;p.isPause=!1,p.circleClass="fa-circle",p.buildInfo=[];var v=n.get("fieldMeta");null==v||null==v.filter?a.getComponentFieldMeta().then(function(e){v=e,u()}):u(),p.sourceEnabledChange=function(e){var t=!1;if(e.old!=e.value){var a=e.value;e.value=!e.value;s({text:"Are you sure to "+(a?"enable [statusSources":"disable [statusSources")+"]?"}).then(function(){t=!0,a?r.enableStatusSource(function(t){return t instanceof VIException?(o.error(t.Message,"submit failed!"),e.value=!1,!1):(e.old=!0,void(e.value=!0))}):r.disableStatusSource(function(t){return t instanceof VIException?(o.error(t.Message,"submit failed!"),e.value=!0,!1):(e.old=!1,void(e.value=!1))})})}},p.changeCircle=function(){p.isPause=!p.isPause,p.timer&&(p.isPause?(p.timer.pause(),p.timerPauseTime=new Date):(f+=new Date-p.timerPauseTime,p.timer.resume())),p.circleClass=p.isPause?"fa-pause-circle":"fa-circle"};var g=function(e,a){var n=[];"vi.hostinfo"==a&&(n.push({name:"Host",value:e.HostName+"/"+e.IP}),delete e.HostName,delete e.IP);for(var i=v.filter(function(e){return 0==e.id.search(a.replace(".","\\.")+"\\.[^\\.]+$")}),s=0;s<i.length;s++){var r=i[s],o=r.id.replace(a,"").substr(1);if(o in e){if("vi.hostinfo"===a&&"serverXml"===o&&!e[o])continue;var l={name:r.name,fname:o,value:e[o],description:r.description},d=/@{[^{]*}/g,u=l.description.match(d);null!==u&&u.length>0&&(l.description=l.description.replace(d,""),angular.merge(l,t.$eval(u[0].substr(1)))),l.isLink&&(l.html='<a target="_blank" href="'+c.getAbsoluteUrl("/download/config/"+l.value)+'">查看</a>',l.value=""),"vi.hostinfo"==a&&p.sysInfoPretreatment(l),n.push(l)}}return n};p.changeStatus=function(e){var t="markUp";"Initiated"==e.value&&(t="markDown");var a=s({text:"Are you sure to ["+t+"] this Application?"});a.then(function(){r[t](function(a){return a instanceof VIException?(o.error(a.Message,"submit failed!"),!1):void("markDown"==t?e.value="MarkDown":e.value="Initiated")})})},p.sysInfoPretreatment=function(e){var t=n.get("hostInfo");switch(e.fname){case"PhysicalMemoryAvaliable":var a=e.value,i=t.PhysicalMemoryTotal;e.value=VIUtil.formatBytes(e.value,"M"),e.cssClass=.3>a/i?"data-warn":"data-normal";break;case"PhysicalMemoryTotal":e.value=VIUtil.formatBytes(e.value,"M");break;case"availableMem":if(e.value>0){var i=t.PhysicalMemoryTotal;e.value=VIUtil.formatBytes(e.value,"M"),e.cssClass=e.value/i<.3?"data-warn":"data-normal"}else e.value="N/A";break;case"DiskAvaliable":var i=t.DiskTotal;e.value=VIUtil.formatBytes(e.value),e.cssClass=e.value/i<.3?"data-warn":"data-normal";break;case"DiskTotal":e.value=VIUtil.formatBytes(e.value);break;case"systemCpuLoad":case"processCpuLoad":e.cssClass=e.value>.5?"data-warn":"data-normal",e.value=(100*e.value).toFixed(2)+"%";break;case"processCpuTime":e.value=VIUtil.calculateRunTime(e.value/1e6);break;case"openFileDescriptorCount":if(!(e.value>0))return e.value="N/A","";var a=e.value,i=t.maxFileDescriptorCount;e.cssClass=a/i>.3?"data-warn":"data-normal";case"maxFileDescriptorCount":e.value<0&&(e.value="N/A")}},p.getValHtml=function(e){var t="";switch(e.fname){case"appStatus":var a="";switch(e.value){case"Uninitiated":case"Initiating":a="status-running";break;case"Initiated":a="status-normal";break;case"InitiatedFailed":a="status-failed";break;case"MarkDown":a="status-warn"}var n="Initiated"==e.value?"Active":"InActive("+e.value+")";if(t='<a href="#/component/custom/vi.ignitestatus/ignite status" class="'+a+' mylink">'+n,"status-running"==a)t+='<i class="fa fa-spinner fa-pulse fa-fw"></i>';else if(m&&("Initiated"==e.value||"MarkDown"==e.value))return t=t+'</a><button style="margin-left:20px" class="btn btn-primary" type="button" ng-click="vm.changeStatus(info)">'+("Initiated"==e.value?"Mark down":"Mark up")+"</button>";
t+="</a>";break;case"webInfo":t='<a href="'+c.getAbsoluteUrl("/download/config/root_web.xml")+'" target="_blank">查看</a>';break;case"statusSourceEnabled":e.old=e.value,t='<switch disabled="'+!m+'" ng-model="info.value" class="green" ng-change="vm.sourceEnabledChange(info)"/>';break;case"statusSourceNames":e.value instanceof Array&&(e.value=e.value.join(" , ")),t='{{info.value.length>60 && !info.showAll?info.value.substr(0,59)+"...":info.value}}<span ng-click="info.showAll = !info.showAll" class="link" ng-show="info.value.length>60">{{info.showAll?"less":"more"}}</span>';break;default:t=e.value}return e.link&&e.linkTxt&&(t+='<a href="'+e.link+'" target="_blank">  '+e.linkTxt+"</a>"),t},p.rawComponents=null,i.$watch("components",function(){null===p.rawComponents&&i.components&&(p.rawComponents=i.components)});var h,f}e.$inject=["$element","$scope","serviceInfo","SiteCache","$rootScope","$confirm","appService","toastr","$cookies","ApiService","$filter"],angular.module("viModule").controller("ComponentController",e)}(),function(){"use strict";angular.module("viModule").controller("CodeController",["$element","$compile","$scope","$timeout","codeService","$stateParams","$q","analyzerService","$location","$window","toastr","ScrollbarService",function(e,t,a,n,i,s,r,o,l,c,d,u){var p=this,m=!1,v=s.path;p.menuMaxHeight=c.innerHeight-190+"px",e.css("minHeight",c.innerHeight-100+"px");var g=function(){a.$apply(function(){p.menuMaxHeight=c.innerHeight-190+"px",e.css("minHeight",c.innerHeight-100+"px")})};angular.element(c).on("resize",g),a.$on("$destroy",function(e){angular.element(c).off("resize",g)}),p.backToRoot=function(){p.isJar(p.currentSource)&&(p.pathParts=[],p.displayList=f.filter(function(e){return"/"==e.parent}))},p.onClassSearchKeyDown=function(e){if(p.isOpen||38!=e.keyCode&&40!=e.keyCode||(p.isOpen=!0),p.isOpen){var t=p.classList.length;switch(e.keyCode){case 13:p.isOpen=!1,p.viewClass(p.classList[p.selectedIndex]);break;case 38:p.selectedIndex?(p.selectedIndex--,p.selectedIndex<=0&&(p.selectedIndex=0)):p.selectedIndex=t-1;break;case 40:p.selectedIndex>=0?(p.selectedIndex++,p.selectedIndex>=t&&(p.selectedIndex=0)):p.selectedIndex=0}}},p.sources=[],o.getJars(function(e){if(p.sources.length>0){var t=p.sources[0];p.sources=e,p.sources.unshift(t)}else{p.sources=e;var a=i.getGitFullPath();a&&p.sources.unshift(a)}}),p.isJar=function(e){return/.*\.jar$/i.test(e)};var h;u.getInstance("jar-list-scrollbar").then(function(e){h=e}),p.refreshScroll=function(){h&&h.scrollTo&&(h.update(),h.scrollTo(0,0))},p.viewFolder=function(e){if(m){p.pathParts=p.pathParts.slice(0,e+1);var t=p.pathParts.join("/")+"/";l.search({fullName:t}),p.displayList=f.filter(function(e){return e.parent==t})}else l.path("/code/folder/"+p.getUrl(e))},p.viewDetail=function(e){m?e.folder?(l.search({fullName:e.fullName}),p.displayList=f.filter(function(t){return t.parent==e.fullName}),p.pathParts=e.fullName.substr(0,e.fullName.length-1).split("/")):l.path("/code/content/jar|"+p.currentSource+"|"+e.fullName.replace(/\//g,"|")):l.path(e.href)},p.nameForUrl=function(e){return p.isJar(e)?"jar|"+e:e?e.replace(/\//g,"$@"):""},p.viewClass=function(e){if(e){var t=e.lastIndexOf("/"),a=e.substr(0,t),n=e.substr(t+1)+".java";i.viewCode(a,n)}},a.$on("$gitTokenChange",function(){b()});var f,b=function(e){var t=v.split("|"),a="/";if(t.length>1&&"jar"==t[0]?(m=!0,e=t[1],p.pathParts=t.slice(2,t.length),a=p.pathParts.join("/")+"/",p.currentSource=e):m=p.isJar(e),o.listClasses(m?p.currentSource:"classes",function(e){p.rawClassList=e.filter(function(e){return-1===e.indexOf("$")})}),m)o.getJarSourceList(e,function(e){f=e.map(function(e){var t="/"==e[e.length-1],a=e.lastIndexOf("/",t?e.length-2:e.length),n=a>0?e.substr(0,a)+"/":"/",i=a>0?e.substr(a+1):e;return i=t?i.substr(0,i.length-1):i,{name:i,folder:t,fullName:e,href:"javascript:void(0)",parent:n}});var t=l.search().fullName;t&&(a=t,p.pathParts=t.substr(0,t.length-1).split("/")),p.displayList=f.filter(function(e){return e.parent==a})});else if(t.length<2)i.getGitlabPrjIdByName(function(e,t){p.currentSource=t,p.sources[0]!=t&&p.sources.unshift(t),p.prjId=e,i.listFiles(e+"/",function(a){a.data&&a.data instanceof Array&&(p.list=a.data.map(function(a){var n="tree"==a.type;return{name:a.name,folder:n,href:"/code/"+(n?"folder":"content")+"/"+p.nameForUrl(t)+"|"+e+"|"+a.name}}))})});else{p.rawPrjPath=t.shift(),p.currentSource=p.rawPrjPath.replace(/\$@/g,"/");var n=t.join("/");p.prjId=t.shift(),p.pathParts=t;var s=function(e,t,a){var r="tree"==e.type;return r?i.listFiles(t,function(e,t){if(e.data&&e.data instanceof Array)if(1==e.data.length&&"tree"==e.data[0].type){var i=e.data[0];s(i,t+"/"+i.name,a)}else a.resolve(t.substr(n.length+1))}):a.resolve(e.name),a.promise};i.listFiles(n,function(e,t){if(e.data&&e.data instanceof Array){var a=(e.data,[]);e.data.forEach(function(e){var n="tree"==e.type;e.folder=n;var i=r.defer();i=s(e,t+"/"+e.name,i).then(function(t){e.name=t,e.href="/code/"+(n?"folder":"content")+"/"+v+"|"+e.name.replace(/\//g,"|")}),a.push(i)}),r.all(a).then(function(){p.list=e.data})}})}};p.changeCodeSource=function(e){l.path("code/folder/"+p.nameForUrl(e))},b(),p.getUrl=function(e){var t=p.pathParts.slice(0,e+1);return p.rawPrjPath+"|"+p.prjId+"|"+t.join("|")}}])}(),function(){"use strict";function e(e,t,a,n,i,s){function r(){var t=(p.conditionFormula||"").match(/[^\s>=<\&\|]*$/i)[0],a=t.split("."),n=m.length-a.length;if(n>0){m.pop();var s=m[m.length-1];""===s?p.currentFields=i.meta:p.currentFields=e.getFieldByDesc(s)}}function o(e,t){var a=!1;switch(e.op){case h.string[0]:t.opcode=-1,t.cmpcode=b.IFNONULL;break;case h.string[1]:t.opcode=-1,t.cmpcode=b.IFNULL;break;case h.string[2]:t.opcode=b.STREQUAL,t.cmpcode=b.IFEQ;break;case h.string[3]:t.opcode=b.STREQUAL,t.cmpcode=b.IFNE;break;case h.string[4]:t.opcode=b.STRLEN,t.cmpcode=b.IF_ICMPLE,a=!0;break;case h.string[5]:t.opcode=b.STRLEN,t.cmpcode=b.IF_ICMPLT,a=!0;break;case h.string[6]:t.opcode=b.STRLEN,t.cmpcode=b.IF_ICMPGE,a=!0;break;case h.string[7]:t.opcode=b.STRLEN,t.cmpcode=b.IF_ICMPGT,a=!0;break;case h.string[8]:t.opcode=b.STRLEN,t.cmpcode=b.IF_ICMPNE,a=!0;break;case h.string[9]:t.opcode=b.STRLEN,t.cmpcode=b.IF_ICMPEQ,a=!0}a&&isNaN(e.value)&&(e.error="The field must be a number")}function l(e,t){var a=e.desc;e.fields.length>0&&(a=e.fields[e.fields.length-1].desc),t.opcode=y[e.op][a],t.cmpcode=w[e.op][a]}function c(e){return e.replace(/(^|[^a-z_$0-9\.])([_a-z$][a-z_$0-9]*)/gi,function(e,t,a){return a in k?t+"java.lang."+a:a in x?t+a:t+"localVariables["+a+"]"})}e.conditions=[{name:"",template:!0}];var d=[],u={};i.traceId=VIUtil.uuid(),e.metaInfo=i,e.winIsOpen=!0,e.vm={};var p=e.vm;p.formatDesc=VIUtil.formatDesc,p.isDefaultUI=i.isDefaultUI;var m=[""];e.seleField=function(e){p.conditionFormula=p.conditionFormula.substr(0,p.conditionFormula.length-p.currentWord.length)+e.name},e.onKeyDown=function(t){e.winIsOpen=!0,p.enter=!1,p.currentWord=(p.conditionFormula||"").match(/[a-z_$0-9]*$/i)[0];var a=(p.conditionFormula||"").slice(-1);if(""===p.currentWord&&190!=t.keyCode&&13!=t.keyCode&&40!=t.keyCode&&38!=t.keyCode)return p.currentWord="",p.currentFields=i.meta,void(m=[""]);if(p.isDot="."==a,">"!==a&&e.winIsOpen){var n=p.currentFields.length;switch(t.keyCode){case 8:r();break;case 32:p.currentWord="",p.currentFields=i.meta,m=[""];break;case 190:var s=p.conditionFormula.match(/[a-z_$0-9]*\.$/i)[0];s=s.substr(0,s.length-1);for(var o=0;o<p.currentFields.length;o++){var l=p.currentFields[o];if(l.name==s){p.currentWord="",e.selectedIndex=0,l.desc in T?(p.currentFields=T[l.desc],m.push(l.desc)):(p.currentFields=[],D(l.desc,function(e){p.currentFields=e,m.push(l.desc)}));break}}break;case 13:p.enter=!0;var c=p.list[e.selectedIndex];c&&p.conditionFormula&&e.seleField(c);break;case 38:p.isDot=!0,e.selectedIndex?(e.selectedIndex--,e.selectedIndex<=0&&(e.selectedIndex=0)):e.selectedIndex=n-1;break;case 40:p.isDot=!0,e.selectedIndex>=0?(e.selectedIndex++,e.selectedIndex>=n&&(e.selectedIndex=0)):e.selectedIndex=0}}};for(var v in i.meta){var g=i.meta[v];d.push(g.name),u[g.name]=g.desc}e.names=d,p.currentFields=i.meta;var h={primitive:[">",">=","<","<=","==","!="],"boolean":["IS TRUE","IS FALSE"],string:["IS NULL","IS NOT NULL","EQ","NOT EQ","LEN >","LEN >=","LEN <","LEN <=","LEN ==","LEN !="],object:["IS NULL","IS NOT NULL"]};e.ops=h,e.cancel=function(){a.dismiss("cancel")};var f,b={STRLEN:-2,STREQUAL:-3,LCMP:148,FCMPL:149,FCMPG:150,DCMPL:151,DCMPG:152,IFEQ:153,IFNE:154,IFLT:155,IFGE:156,IFGT:157,IFLE:158,IF_ICMPEQ:159,IF_ICMPNE:160,IF_ICMPLT:161,IF_ICMPGE:162,IF_ICMPGT:163,IF_ICMPLE:164,IF_ACMPEQ:165,IF_ACMPNE:166,GETFIELD:180,IFNULL:198,IFNONULL:199},y={">":{I:-1,S:-1,B:-1,C:-1,F:b.FCMPL,D:b.DCMPL,J:b.LCMP},">=":{I:-1,S:-1,B:-1,C:-1,F:b.FCMPL,D:b.DCMPL,J:b.LCMP},"<":{I:-1,S:-1,B:-1,C:-1,F:b.FCMPG,D:b.DCMPG,J:b.LCMP},"<=":{I:-1,S:-1,B:-1,C:-1,F:b.FCMPG,D:b.DCMPG,J:b.LCMP},"==":{I:-1,S:-1,B:-1,C:-1,F:b.FCMPL,D:b.DCMPL,J:b.LCMP},"!=":{I:-1,S:-1,B:-1,C:-1,F:b.FCMPL,D:b.DCMPL,J:b.LCMP}},w={">":{I:b.IF_ICMPLE,S:b.IF_ICMPLE,B:b.IF_ICMPLE,C:b.IF_ICMPLE,F:b.IFLE,D:b.IFLE,J:b.IFLE},">=":{I:b.IF_ICMPLT,S:b.IF_ICMPLT,B:b.IF_ICMPLT,C:b.IF_ICMPLT,F:b.IFLT,D:b.IFLT,J:b.IFLT},"<":{I:b.IF_ICMPGE,S:b.IF_ICMPGE,B:b.IF_ICMPGE,C:b.IF_ICMPGE,F:b.IFGE,D:b.IFGE,J:b.IFGE},"<=":{I:b.IF_ICMPGT,S:b.IF_ICMPGT,B:b.IF_ICMPGT,C:b.IF_ICMPGT,F:b.IFGT,D:b.IFGT,J:b.IFGT},"==":{I:b.IF_ICMPNE,S:b.IF_ICMPNE,B:b.IF_ICMPNE,C:b.IF_ICMPNE,F:b.IFNE,D:b.IFNE,J:b.IFNE},"!=":{I:b.IF_ICMPEQ,S:b.IF_ICMPEQ,B:b.IF_ICMPEQ,C:b.IF_ICMPEQ,F:b.IFEQ,D:b.IFEQ,J:b.IFEQ}},C=function(e){f="";var t,a=[],n=e.length;for(t=0;n>t;t++){var i=e[t];if(delete i.error,""===i.name)break;var s={fieldName:i.name};if(s.classFields=i.fields,!i.op){i.error="You must specify the type of operation";break}switch(i.type){case"string":o(i,s),s.value=i.value;break;case"primitive":l(i,s),isNaN(i.value)?i.error="The field must be a number":s.value=i.value;break;case"object":switch(s.opcode=-1,i.op){case h.object[0]:s.cmpcode=b.IFNONULL;break;case h.object[1]:s.cmpcode=b.IFNULL}break;case"boolean":switch(s.opcode=-1,s.cmpcode=b.IF_ICMPNE,i.op){case h["boolean"][0]:s.value=1;break;case h["boolean"][1]:s.value=0}}s.desc=u[i.name];var r=i.name;i.fields.length>0&&(r+="."+i.fields.map(function(e){return e.name}).join(".")),f+=r+" "+i.op+" "+(i.value?i.value+" ":"")+"&& ",a.push(s)}return f.length>4&&(f=f.substr(0,f.length-4)),a},k={String:0,Long:0,Double:0,Float:0,Byte:0,Integer:0,Character:0,Short:0,Boolean:0},x={"abstract":0,assert:0,"boolean":0,"break":0,"byte":0,"case":0,"catch":0,"char":0,"class":0,"const":0,"continue":0,"default":0,"do":0,"double":0,"else":0,"enum":0,"extends":0,"final":0,"finally":0,"float":0,"for":0,"goto":0,"if":0,"implements":0,"import":0,"instanceof":0,"int":0,"interface":0,"long":0,"native":0,"new":0,"package":0,"private":0,"protected":0,"public":0,"return":0,"short":0,"static":0,strictfp:0,"super":0,"switch":0,"synchronized":0,"throw":0,"throws":0,"transient":0,"try":0,"void":0,"volatile":0,"while":0,"true":0,"false":0,"null":0};e.ok=function(){var t=p.conditionFormula,r=t;if(p.isDefaultUI){for(var o=C(e.conditions),l=0;l<e.conditions.length;l++)if(e.conditions[l].error)return;if(0===o.length)return void n.warning("no condition found!");t={d:o},r=f}else{for(var d,u=[],m=[],v=!1,l=0;l<t.length;l++){var g=t[l],h=!1;if(d)d===g&&(d=null,h=!0,v=!1);else switch(g){case'"':d='"',v=!0,h=!0;break;case"'":d="'",v=!0,h=!0}u.push(g),v?h&&(m.push(c(u.join(""))),u=[]):h&&(m.push(u.join("")),u=[])}t=m.join("")+c(u.join(""))}s.registerBreakpoint({source:i.fullName,line:i.lineNum,conditions:t,breakpointId:i.traceId},function(e){a.close({formular:r,result:e})})};var I=["IS NULL","IS NOT NULL","IS TRUE","IS FALSE"];e.isNeedValue=function(e){return e.op?I.indexOf(e.op)>=0?!1:!0:!1};var M=function(e){return"Z"==e?"boolean":1==e.length?"primitive":"Ljava/lang/String;"==e?"string":"object"},T={},S={"Ljava/lang/String;":0,"Ljava/lang/Object;":0},D=function(e,t){e in T||e in S||s.getClassFields({className:e.substr(1,e.length-2)},function(a){a instanceof Array&&a.length>0&&(T[e]=a,t&&t(a))})};e.getCurrentField=function(t,a){return 0===t?e.getFieldByDesc(a.desc):e.getFieldByDesc(a.fields[t-1].desc)},e.updateField=function(e,t,a){var n;t?(n=t.desc,e.fields[a].name!=t.name&&(e.fields[a]=t,e.fields.splice(a+1))):0===a?(n=e.desc,e.fields=[]):(n=e.fields[a-1],e.fields.splice(a)),e.type=M(n),D(n)},e.getFieldByDesc=function(e){return T[e]},e.hasDescFields=function(e){return e in T},e.pushField=function(e,t){e.fields.push(t),D(t.desc),e.type=M(t.desc)},e.deleteCondition=function(t){VIUtil.removeArrayItem(e.conditions,t)},e.nameChange=function(t,a){if(t.name=a,D(u[a]),t.template&&t.name.length>0){var n=angular.copy(t);delete n.template,t.name="",e.conditions.pop(),n.desc=u[a],n.type=M(n.desc),n.fields=[],e.conditions.push(n),e.conditions.push(t)}else t.desc=u[a],t.fields=[],t.type=M(t.desc)}}e.$inject=["$scope","configService","$uibModalInstance","toastr","metaInfo","codeService"],angular.module("viModule").controller("CodeContentController",["$element","$compile","$scope","$timeout","codeService","$stateParams","$cookies","$window","toastr","$rootScope","$uibModal","ScrollbarService","$confirm",function(t,a,n,i,s,r,o,l,c,d,u,p,m){function v(){s.getCapturedFrame(g.traceId,function(e){return null!==g.seleLine?e instanceof VIException?void c.error("Message:"+e.Message+"\nType:"+e.Type,"get captured failed!",{timeOut:1e5}):void(e&&e.locals?(g.debugInfo=e,g.hasResult=!0):g.showDebugPanel&&i(v,2e3)):void 0})}var g=this;g.debugInfo={},g.rootPath="#code/folder/",g.enableCondition=!0,g.isTab=!1;var h,f=t.attr("params");f&&(r=VIUtil.queryToObj(f),g.isTab=!0,""!==r.line&&(g.jumpLine=r.line)),s.isDefaultDebugger(function(e){g.isDefaultUI=e});var b,y=r.path;g.panelWidth=t.prop("clientWidth")-40+"px",g.panelMaxHeight="100px",g.maxHeight=l.innerHeight-190+"px",g.jcontentWidth=.9*l.innerWidth*.7+"px";var w=function(){b&&(b.className=b.className.replace(" focus",""));var e=t[0].querySelector(".line:nth-child("+g.jumpLine+")");if(e){h.update(),e.className+=" focus",b=e;var a=e.offsetTop;a>180&&(a-=180),h.scrollTo(0,a)}else c.warning("out of range")};g.onGOTOKeyDown=function(e){switch(e.keyCode){case 13:if(!/\d+/.test(g.jumpLine))return void c.warning("must be an integer!");w()}};var C=function(){n.$apply(function(){g.maxHeight=l.innerHeight-190+"px",g.jcontentWidth=.9*l.innerWidth*.7+"px"})},k=function(){g.traceId&&g.traceId.length>0&&g.seleLine&&s.stopDebug(g.traceId,function(e){g.showDebugPanel=!1,g.hasResult=!1,d3.select(g.seleLine).attr("selected",null),g.seleLine=null})};angular.element(l).on("resize",C),n.$on("$destroy",function(){angular.element(l).off("resize",C),g.showDebugPanel=!1,k()}),g.gotoSettings=function(){d.$broadcast("$newViView","Settings",{},"Settings")},g.panelMin=function(){var e="100px";g.panelMaxHeight=e},g.panelMax=function(){var e=l.innerHeight-100+"px";g.panelMaxHeight=e};var x=y.split("|"),I=x.shift(),M=x.join("/"),T=x.shift();"jar"==I?(g.prjFullPath=T,g.rootPath="#code/folder/jar|"+T):g.prjFullPath=I.replace(/\$@/g,"/"),x.pop(),g.pathParts=x,g.getUrl=function(e){var t=g.pathParts.slice(0,e+1);return I+"|"+T+"|"+t.join("|")},g.formatTrace=function(e){var t="Native method";if(e.lineNumber>0){var a=e.declaringClass.substr(0,e.declaringClass.lastIndexOf("."));t='<span jns="'+a+'" ng-click="vm.viewSource($event)" class="link">'+e.fileName+":"+e.lineNumber+"</span>"}return e.declaringClass+"."+e.methodName+"("+t+")"},g.viewSource=function(e){var t=angular.element(e.currentTarget),a=t.attr("jns"),n=t.text();s.viewCode(a,n)};var S=function(){d3.select(t[0]).selectAll("div.line>.line-number").on("click",function(){if(g.canDebug){var t=d3.select(this.parentElement),a=this.innerText,i=this.parentElement.innerText,r=i.substr(a.length),o=this;if(!g.formular&&g.enableCondition||!g.showDebugPanel)if(g.hasResult=!1,/^\s*[a-zA-Z]{1,}/g.test(r)){if(g.seleLine&&o.parentElement!=g.seleLine&&(d3.select(g.seleLine).attr("selected",null),g.seleLine=null),t.attr("selected"))g.seleLine&&k();else{if(!(g.traceId&&g.traceId.length>2)||g.enableCondition)return g.enableCondition?void s.getLineVars({className:g.fullName,lineNum:a},function(n){if(t.attr("selected",null),g.seleLine=null,n instanceof VIException)return void c.error("Message:"+n.Message+"\nType:"+n.Type);t.attr("selected",null),t.attr("selected",!0),g.seleLine=o.parentElement;var i={meta:n,fullName:g.fullName,lineNum:a,traceId:g.traceId,isDefaultUI:g.isDefaultUI},s=u.open({animation:!0,templateUrl:"codeContent.html",controller:e,size:"lg",resolve:{metaInfo:i}});s.closed.then(function(){g.showDebugPanel||(t.attr("selected",null),g.seleLine=null)}),s.result.then(function(e){return g.hasResult=!1,g.showDebugPanel=!1,t.attr("selected",null),g.seleLine=null,g.formular=e.formular,e.result instanceof VIException?void c.error("Message:"+e.result.Message+"\nType:"+e.result.Type):void(e.result?(g.traceId=i.traceId,g.debugInfo={},g.showDebugPanel=!0,v(),t.attr("selected",!0),g.seleLine=o.parentElement):c.warning("register breakpoint failed! cannot set breakpoint in here!"))})}):void c.warning("you must set trace id first!","warning");g.hasResult=!1,g.formular="",s.registerBreakpoint({source:g.fullName,line:a,breakpointId:g.traceId},function(e){return g.showDebugPanel=!1,t.attr("selected",null),g.seleLine=null,e instanceof VIException?void c.error("Message:"+e.Message+"\nType:"+e.Type):void(e?(g.debugInfo={},g.hasResult=!1,g.showDebugPanel=!0,v(),t.attr("selected",!0),g.seleLine=o.parentElement):c.warning("register breakpoint failed! cannot set breakpoint in here!"))})}g.seleLine?g.showDebugPanel||n.$apply(function(){g.showDebugPanel=!0}):n.$apply(function(){g.showDebugPanel=!1})}else c.warning("you can not set a monitoring point here!","warning");else{m({text:"Current debug condition is ["+(g.enableCondition?g.formular:"traceId="+g.traceId)+"]"+(g.hasResult?".":", do you want stop debug?")}).then(function(){k()})}}})};s.getContent(M,function(e){if(e.data||e.file_name){g.raw=e.data?decodeURIComponent(escape(atob(unescape(encodeURIComponent(e.data.content))))):e.content,g.name=e.data?e.data.file_name:e.file_name,g.raw=VIUtil.escapeHTML(g.raw);var a=e.data?e.data.size:e.size;if(g.isJava=/.*\.java$/i.test(g.name),g.isJava){var s=g.raw.match(/\s*package\s+([^;]+)\s*;/);s&&2==s.length&&(g.fullName=s[1].replace(/\./g,"/")+"/"+g.name)}g.size=VIUtil.formatBytes(a),g.canDebug=g.isJava&&"true"==o.get("allowDebug"),n.$on("$allowDebugChange",function(){g.canDebug=g.isJava&&"true"==o.get("allowDebug"),g.canDebug&&S()});var r=function(e){var a=t[0].querySelector("div.scrollbar");a?h=Scrollbar.init(a):i(r,500);var n=t[0].querySelector(".scrollbar pre code");angular.element(n).html(g.raw),n&&(hljs.highlightBlock(n),g.isJava&&"undefined"!=typeof g.jumpLine&&w(),g.canDebug&&S())};n.$watch("$viewContentLoaded",r)}})}])}(),function(){"use strict";function e(e,t,a,n,i){e.searchType="index",e.close=function(){a.dismiss("cancel")},e.onKeyDown=function(t){13==t.keyCode&&e.searchByKey()},e.$watch("searchType",function(t){"index"==t?(e.currentPage=1,e.selectPage(1)):(e.searchKey="",e.jsonContent=null)}),e.title=t.id,e.type=t.$type,e.numPages=t.size,e.selectPage=function(a){return isNaN(a)?(i.error("Invalid page number, page index must be in range 1 to "+t.size),!1):1>a||a>t.size?(i.error("Out of range, page index must be in range 1 to "+t.size),e.currentPage=e.currentPage,!1):(e.currentPage=a,n.getByIndex({id:t.id,typeName:t.$type,index:a-1},function(t){return t instanceof VIException?(t.Type.indexOf("CacheNotFoundException")>0?(e.hasIndex=!1,e.searchType="key"):i.error(t.Message,"get cache content failed!"),!1):(e.hasIndex=!0,void(e.jsonContent=t))}),!0)},e.currentPage=1,e.selectPage(1),e.searchByKey=function(){n.getByKey({id:t.id,typeName:t.$type,key:e.searchKey},function(t){return t instanceof VIException?(i.error(t.Message,"get cache content failed!"),!1):void(e.jsonContent=t)})}}function t(t,a,n,i,s,r){var o=this,l=function(){o.selectedType&&o.selectedType.value&&n.getStatus(o.selectedType.value,function(e){o.cellCollection=[],o.cols=[],o.colCount=4;for(var t in e){var a={id:t};angular.extend(a,e[t]),o.cellCollection.push(a)}if(o.cellCollection.length>0){var n=o.cellCollection[0],i=0;for(var s in n)o.cols.push({name:s}),i++;for(var r=90/i,l=0;l<o.cols.length;l++)o.cols[l].width=r+"%"}o.colCount=o.cols.length+1})};o.typeChange=function(){l()},o.view=function(t){t.$type=o.selectedType.value;r.open({animation:!0,templateUrl:"cache-view.html",controller:e,size:"lg",resolve:{data:t}})},o.refresh=function(e){a({text:'Are you sure you want to refresh "'+e.id+'" ?'}).then(function(){n.refresh({id:e.id,typeName:o.selectedType.value},function(e){return e instanceof VIException?(s.error(e.Message,"refresh failed!"),!1):(s.success("refresh success!"),void l())})})},n.getTypes(function(e,t){o.types=e.map(function(e){var t=e.lastIndexOf(".");return{name:e.substr(t+1),value:e}}),o.selectedType=o.types[0],l()})}t.$inject=["$scope","$confirm","cacheService","SiteCache","toastr","$uibModal"],e.$inject=["$scope","data","$uibModalInstance","cacheService","toastr"],angular.module("viModule").controller("CacheController",t)}(),function(){"use strict";function e(e,t,a){var n="threading/",i={apiUrl:n,getAll:function(e){return a.doGet(n+"all").then(e)},getStats:function(e){return a.doGet(n+"stats").then(e)},dump:function(e,t){return a.doGet(n+"dump",e).then(t)},getDetail:function(e,t,i){return a.doGet(n+"detail/"+e,t).then(i)},update:function(e,t){return a.doPost(e,n+"update").then(t)}};return i}e.$inject=["$log","$http","ApiService"],angular.module("viModule").factory("threadService",e)}(),function(){"use strict";function e(e,t,a,n){var i="component/",s={apiUrl:i,getServiceStatus:function(){return a.doGet(i+"serverStatus")},getComponentMeta:function(){return a.doGet(i+"meta")},getComponentFieldMeta:function(){return a.doGet(i+"fieldmeta")},getComponentInfo:function(e){return a.doGet(i+e)},getHostInfo:function(){return a.doGet(i+"vi.hostinfo")},doComponentMethod:function(e,t,n){return a.doPost(n,i+e+"/"+t)},loopWithPeriod:function(e,t,s,r,o){var l,c=function(){a.doGet(i+t,{$fields:o}).then(function(e){r(e)&&(l=n(c,s))})};return c(),e.$on("$destroy",function(){n.cancel(l)}),{pause:function(){n.cancel(l)},resume:function(){l=n(c,s)}}}};return s}e.$inject=["$log","$http","ApiService","$timeout"],angular.module("viModule").factory("serviceInfo",e)}(),function(){"use strict";angular.module("viModule").factory("metricsService",["$http","ApiService",function(e,t){var a="metrics/";return{getNames:function(e){return t.doGet(a+"names").then(e)},register:function(e,n){return t.doPost(e,a+"register").then(n)},getCurrent:function(e,n){return t.doPost({id:e},a+"current").then(n)}}}])}(),function(){"use strict";function e(e,t,a){var n="log/",i={apiUrl:n,getAll:function(e){return a.doGet(n+"all").then(e)},getDetail:function(e,t,i){return a.doGet(n+e,t).then(i)},update:function(e,t){return a.doPost(e,n+"update").then(t)},download:function(e){window.open(a.getEndpoint()+"/download/log/"+e,"_self")}};return i}e.$inject=["$log","$http","ApiService"],angular.module("viModule").factory("logInfo",e)}(),function(){"use strict";function e(e,t,a){var n="fc/",i={apiUrl:n,getAll:function(e){return a.doGetFunc(n+"all",e)},update:function(e,t){return a.doPost(e,n+"update").then(t)}};return i}e.$inject=["$log","$http","ApiService"],angular.module("viModule").factory("fcService",e)}(),function(){"use strict";function e(e,t,a){var n="enterprise/",i={apiUrl:n,getServers:function(e){return a.doGetFunc(n+"servers",e)},getHelp:function(e){return a.doGetFunc(n+"help",e)}};return i}e.$inject=["$log","$http","ApiService"],angular.module("viModule").factory("enterpriseService",e)}(),function(){"use strict";angular.module("viModule").factory("customPageService",["ApiService",function(e){var t="enterprise/page/";return{get:function(a){return e.doGet(t+a)},doMethod:function(a,n,i){return e.doPost(i,t+a+"/"+n)}}}])}(),function(){"use strict";angular.module("viModule").factory("customComponentStatus",["$http","ApiService",function(e,t){var a=t.getEndpoint()+"/component/";return{getCustom:function(t){return e.get(a+t+"/custom")}}}])}(),function(){"use strict";function e(e,t,a){var n="config/",i={apiUrl:n,getAll:function(e){return a.doGet(n+"all").then(e)},get:function(e,t){var i=a.doGet(n+"get",{key:e});return t&&(i=i.then(t)),i},getRemarks:function(e){return a.doGet(n+"remarks").then(e)},update:function(e,t){return a.doPost(e,n+"update").then(t)}};return i}e.$inject=["$log","$http","ApiService"],angular.module("viModule").factory("configService",e)}(),function(){"use strict";function e(e,t,a,n,i,s,r,o,l){var c,d,u,p,m="code/",v=a.doGetFunc(m+"gitinfo",function(e){c=e.url,d=e.commitId,u=r.encodeURIComponent(e.prjPath)}),g=function(){var e=n.get("gitPrivateToken");return!e||e.length<5?(s({text:"You must set git private token first,",title:"No git Token Warning",ok:"Go Settings"}).then(function(){l.$broadcast("$newViView","Settings",{},"Settings")}),""):e||""},h={apiUrl:m,getGitFullPath:function(){return p},getGitlabPrjIdByName:function(e){var a=g();if(a&&!(a.length<5))return t.get(c+u,{headers:{"PRIVATE-TOKEN":a}}).then(function(t){p=t.data.path_with_namespace,e(t.data.id,t.data.path_with_namespace)})["catch"](function(e){401===e.status?s({text:"Wrong Gitlab private token! You must set the right Gitlab private token!",title:"Wrong Gitlab Token Warning",ok:"Go Settings"}).then(function(){l.$broadcast("$newViView","Settings",{},"Settings")}):o.error(e.data.message)})},listFiles:function(e,a){var n=g();if(!(n.length<5)){var i=e.indexOf("/"),s=e.substr(0,i),r=e.substr(i+1);return t.get(c+s+"/repository/tree",{params:{ref_name:d,path:r},headers:{"PRIVATE-TOKEN":n}}).then(function(t){a(t,e)})}},getContent:function(e,n){var i=e.indexOf("/"),s=e.substr(0,i),r=e.substr(i+1);if(/.*\.jar$/i.test(s))return a.doGet(m+"getSourceCode",{jarName:s,path:r}).then(n);var o=g();return o.length<5?void 0:t.get(c+s+"/repository/files",{params:{ref:d,file_path:r},headers:{"PRIVATE-TOKEN":o}}).then(n)},registerBreakpoint:function(e,t){return a.doGet(m+"registerbreakpoint",e).then(t)},getCapturedFrame:function(e,t){return a.doGet(m+"getcapturedframe",{traceId:e}).then(function(e){t(e)})},enableDebug:function(e){return a.doGetFunc(m+"enabledebug",function(t){e(t)})},getCodePath:function(e,t,n){return a.doGet(m+"getCodePath",{ns:e,name:t}).then(function(e){n(e)})},getTraceKey:function(e){return a.doGetFunc(m+"getTraceKey",e)},setTraceKey:function(e,t){return a.doPost(e,m+"setTraceKey").then(t)},getLineVars:function(e,t){return e.className=e.className.replace(/\.java$/,""),a.doGet(m+"getLineVars",e).then(t)},getClassFields:function(e,t){return e.className=e.className.replace(/\.java$/,""),a.doGet(m+"getClassFields",e).then(t)},stopDebug:function(e,t){return a.doPost({id:e},m+"stopDebug").then(t)},isDefaultDebugger:function(e){return a.doGetFunc(m+"isDefaultDebugger",e)},promise:v};return h.viewCode=function(e,t){h.getCodePath(e,t.split(".")[0],function(a){var n=t.split(":");if(/^git\|/.test(a))h.getGitlabPrjIdByName(function(i,s){var r=s.replace(/\//g,"$@")+"|"+i+"|"+a.substr(4).replace(/\//g,"|")+"|"+e.replace(/\./g,"|")+"|"+n[0];l.$broadcast("$newViView","Code-Content",{path:r,line:n[1]||""},t)});else{var i=a+"|"+n[0];l.$broadcast("$newViView","Code-Content",{path:i,line:n[1]||""},t)}})},h}e.$inject=["$log","$http","ApiService","$cookies","$location","$confirm","$window","toastr","$rootScope"],angular.module("viModule").factory("codeService",e)}(),function(){"use strict";function e(e,t,a){var n="cache/",i={apiUrl:n,getStatus:function(e,t){return a.doGet(n+"status/"+e).then(t)},getTypes:function(e){return a.doGet(n+"types").then(e)},refresh:function(e,t){return a.doPost(e,n+"refresh").then(t)},getByKey:function(e,t){return a.doPost(e,n+"getByKey").then(t)},getByIndex:function(e,t){return a.doPost(e,n+"getByIndex").then(t)}};return i}e.$inject=["$log","$http","ApiService"],angular.module("viModule").factory("cacheService",e)}(),function(){"use strict";function e(e,t,a){var n="app/",i={apiUrl:n,markDown:function(e){return a.doPost({},n+"markdown").then(e)},markUp:function(e){return a.doPost({},n+"markup").then(e)},enableStatusSource:function(e){return a.doPost({},n+"enablestatussource").then(e)},disableStatusSource:function(e){return a.doPost({},n+"disablestatussource").then(e)},uvTrace:function(e,t){return a.doPost({name:e},n+"uvTrace").then(t)}};return i}e.$inject=["$log","$http","ApiService"],angular.module("viModule").factory("appService",e)}(),function(){"use strict";function e(e,t,a){var n="analyzer/",i={apiUrl:n,getDeps:function(e){return a.doGet(n+"deps").then(e)},getJars:function(e){return a.doGet(n+"jars").then(e)},getAllModuleInfo:function(e){return a.doGet(n+"getAllModuleInfo").then(e)},listClasses:function(e,t){return a.doGet(n+"listClasses",{location:e}).then(t)},addClassForMetrics:function(e,t){return a.doGet(n+"addClassForMetrics",{name:e}).then(t)},getJarSourceList:function(e,t){return a.doGet(n+"listsource",{jarname:e}).then(t)},getNeedMetricsClasses:function(e){return a.doGet(n+"getNeedMetricsClasses").then(e)},removeMetricsClass:function(e,t){return a.doGet(n+"removeMetricsClass",{name:e}).then(t)},getHeapHisto:function(e){return a.doGet(n+"heaphisto").then(e)},getVMSnapshot:function(e){return a.doGet(n+"vmsnapshot").then(e)},getGCLogList:function(e){return a.doGet(n+"getgcloglist").then(e)},parseGCLog:function(e,t){return a.doGet(n+"parsegclog",{name:e}).then(t)},getJVMOptions:function(e){return a.doGet(n+"getjvmoptions").then(e)},getAllIgnitePlugins:function(e){return a.doGet(n+"allIgnitePlugins").then(e)},selfCheck:function(e,t){return a.doGet(n+"selfcheck",{id:e}).then(t)},getSelfCheckMsgs:function(e,t,i){return a.doGet(n+"getSelfCheckMsgs",{uid:e,index:t}).then(i)}};return i}e.$inject=["$log","$http","ApiService"],angular.module("viModule").factory("analyzerService",e)}(),function(){"use strict";angular.module("viModule").controller("VisualGCController",["$element","$compile","$scope","$timeout","analyzerService",function(e,t,a,n,i){var s,r=this,o=!1,l=1024,c=0,d=!1,u=function(){i.getVMSnapshot(function(t){r.permTitle="Perm Gen",t.permSize||(r.permTitle="Metaspace",d=!0,t.permSize=t.metaSize,t.permCapacity=t.metaCapacity,t.permUsed=t.metaUsed),r.lastUpdateTime=new Date,o||(o=!0,r.permOptions=angular.copy(r.options),r.permOptions.chart.x=function(e,t){return t},r.permOptions.chart.yTickFormat=function(e){return VIUtil.formatBytes(e*l,"m")},r.edenOptions=angular.copy(r.permOptions),r.s0Options=angular.copy(r.permOptions),r.s1Options=angular.copy(r.permOptions),r.oldOptions=angular.copy(r.permOptions),r.cloaderOptions=angular.copy(r.permOptions),r.cloaderOptions.chart.yTickFormat=function(e){return e},r.startDate=r.lastUpdateTime,r.permOptions.chart.yDomain=[0,Math.ceil(t.permCapacity/l)],r.edenOptions.chart.yDomain=[0,Math.ceil(t.edenCapacity/l)],r.oldOptions.chart.yDomain=[0,Math.ceil(t.tenuredCapacity/l)],r.s0Options.chart.yDomain=[0,Math.ceil(t.survivor0Capacity/l)],r.s1Options.chart.yDomain=[0,Math.ceil(t.survivor1Capacity/l)]),r.tenuringThreshold=t.tenuringThreshold,r.maxTenuringThreshold=t.maxTenuringThreshold,r.desiredSurvivorSize=t.desiredSurvivorSize,r.currentSurvivorSize=t.survivor1Size,t.ageTableSizes&&(r.histogramWidth=Math.floor((e[0].clientWidth-200)/t.ageTableSizes.length)+"px",r.histogram=t.ageTableSizes.map(function(e){return Math.ceil(100*(t.desiredSurvivorSize-e)/t.desiredSurvivorSize)})),r.permLeftPercent=Math.ceil(100*(t.permSize-t.permUsed)/t.permSize),r.oldLeftPercent=Math.ceil(100*(t.tenuredSize-t.tenuredUsed)/t.tenuredSize),r.edenLeftPercent=Math.ceil(100*(t.edenSize-t.edenUsed)/t.edenSize),r.s0LeftPercent=Math.ceil(100*(t.survivor0Capacity-t.survivor0Used)/t.survivor0Capacity),r.s1LeftPercent=Math.ceil(111*(t.survivor1Capacity-t.survivor1Used)/t.survivor1Capacity),r.oldTotalCompile=r.totalCompile,r.totalCompile=t.totalCompile,r.compileTime=(t.totalCompileTime/t.osFrequency).toFixed(3),r.classesLoaded=t.classesLoaded,
r.classesUnloaded=t.classesUnloaded,r.classLoadTime=(t.classLoadTime/t.osFrequency).toFixed(3),r.oldGcEvents=r.gcEvents,r.gcEvents=t.edenGCEvents+t.tenuredGCEvents,r.gcTimes=VIUtil.calculateRunTime(1e3*(t.edenGCTime+t.tenuredGCTime)/t.osFrequency),r.lastGCCause=t.lastGCCause,r.edenSize=VIUtil.formatBytes(t.edenSize,"m"),r.edenCapacity=VIUtil.formatBytes(t.edenCapacity,"m"),r.edenGCEvents=t.edenGCEvents,r.edenGCTime=VIUtil.calculateRunTime(1e3*t.edenGCTime/t.osFrequency),r.edenUsed=VIUtil.formatBytes(t.edenUsed,"m"),r.survivor0Size=VIUtil.formatBytes(t.survivor0Size,"m"),r.survivor0Capacity=VIUtil.formatBytes(t.survivor0Capacity,"m"),r.survivor0Used=VIUtil.formatBytes(t.survivor0Used,"m"),r.survivor1Size=VIUtil.formatBytes(t.survivor1Size,"m"),r.survivor1Capacity=VIUtil.formatBytes(t.survivor1Capacity,"m"),r.survivor1Used=VIUtil.formatBytes(t.survivor1Used,"m"),r.tenuredSize=VIUtil.formatBytes(t.tenuredSize,"m"),r.tenuredCapacity=VIUtil.formatBytes(t.tenuredCapacity,"m"),r.tenuredGCEvents=t.tenuredGCEvents,r.tenuredGCTime=VIUtil.calculateRunTime(1e3*t.tenuredGCTime/t.osFrequency),r.tenuredUsed=VIUtil.formatBytes(t.tenuredUsed,"m"),r.permSize=VIUtil.formatBytes(t.permSize,"m"),r.permCapacity=VIUtil.formatBytes(t.permCapacity,"m"),r.permUsed=VIUtil.formatBytes(t.permUsed,"m");var a=0,i=0;r.oldTotalCompile&&(a=r.totalCompile-r.oldTotalCompile),r.oldGcEvents&&(i=r.gcEvents-r.oldGcEvents),r.compileData[0].values.push([r.compileData[0].values.length,a]),r.gcData[0].values.push([r.gcData[0].values.length,i]),r.cloaderData[0].values.push({x:c,y:t.classesLoaded}),r.edenData[0].values.push({x:c,y:Math.ceil(t.edenUsed/l)}),r.permData[0].values.push({x:r.permData[0].values.length,y:Math.ceil(t.permUsed/l)}),r.oldData[0].values.push({x:r.oldData[0].values.length,y:Math.ceil(t.tenuredUsed/l)}),r.s0Data[0].values.push({x:r.s0Data[0].values.length,y:Math.ceil(t.survivor0Used/l)}),r.s1Data[0].values.push({x:r.s1Data[0].values.length,y:Math.ceil(t.survivor1Used/l)}),c++,s=n(u,1e3)})};u(),a.$on("$destroy",function(){n.cancel(s)}),r.options={chart:{type:"lineChart",height:80,showLegend:!1,margin:{top:0,right:0,left:0,bottom:0}}},r.compileData=[{key:"count",bar:!0,values:[]}],r.cloaderOptions=r.options,r.compileOptions={chart:{type:"historicalBarChart",height:80,forceY:[3],duration:250,showLegend:!1,x:function(e){return e[0]},y:function(e){return e[1]},margin:{top:0,right:0,left:0,bottom:0},tooltip:{keyFormatter:function(e){return d3.time.format("%H:%M:%S")(new Date(r.startDate-0+1e3*e))}}}},r.gcOptions=angular.copy(r.compileOptions),r.gcData=angular.copy(r.compileData),r.permData=[{area:!0,values:[]}],r.oldData=[{area:!0,values:[]}],r.s0Data=[{area:!0,values:[]}],r.s1Data=[{area:!0,values:[]}],r.edenData=[{area:!0,values:[]}],r.cloaderData=[{area:!0,values:[]}]}])}(),function(){"use strict";angular.module("viModule").controller("SelfCheckController",["analyzerService","$compile","$scope","$timeout","$window","toastr","codeService",function(e,t,a,n,i,s,r){var o=this,l=1500;o.maxHeight=i.innerHeight-250+"px";var c=function(){a.$apply(function(){o.maxHeight=i.innerHeight-250+"px"})};angular.element(i).on("resize",c),a.$on("$destroy",function(e){angular.element(i).off("resize",c)}),e.getAllIgnitePlugins(function(e){o.rawlist=e.map(function(e){return{name:e}})}),o.viewSource=function(e){var t=angular.element(e.currentTarget),a=t.attr("jns"),n=t.text();r.viewCode(a,n)},o.switchArea=function(e){var t=e.currentTarget,a=d3.select(t.nextElementSibling),n=d3.select(t).select("i"),i="none"==a.style("display");a.style("display",i?"":"none"),n.attr("class",i?"fa fa-caret-down":"fa fa-caret-right")};var d,u=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)/g,p={},m=function(e){return e.indexOf("[ERROR]")>=0?e='<span class="status-failed">'+e+"</span>":e.indexOf("[WARN]")>=0&&(e='<span class="status-warn">'+e+"</span>"),e.replace(/\n/g,"<br>").replace(u,function(e){return'<a target="_blank" href="'+e+'">'+e+"</a>"}).replace(/(\s+at\s+)(.+)\(([a-z0-9_\$]+\.java\:\d+)\)/gi,function(e,t,a,n){var i,s=a.split(".");return s.length>3&&(i=s.slice(0,s.length-2).join(".")),t+a+'(<span jns="'+i+'" ng-click="vm.viewSource($event)" class="link stack-m">'+n+"</span>)"}).replace(/^#@#(.+)/,function(e,t,a){var n=t.lastIndexOf("#"),i=new Date(t.substr(n+1)),s=t.substr(0,n),r=s.lastIndexOf("@?"),o={},l="";r>0&&(o=VIUtil.queryToObj(s.substr(r+1)),s=s.substr(0,r));for(var c in o)" "!=c&&(l+='<span class="meta-inf">'+c+":"+o[c]+"</span>");if(/^Begin/.test(s))return p[s.substr(7)]=i,'<div class="block" '+("id"in o?'id="'+o.id+'"':"")+'><span ng-click="vm.switchArea($event)"><i class="fa fa-caret-down"></i>'+s+l+'</span><div class="inner">';var d=VIUtil.calculateRunTime(i-p[s.substr(5)]);return delete p[s.substr(5)],s+'</div> <span class="cost-time">cost: '+d+"</span>"+l+"</div>"})},v=0;o.msgHtml="";var g=function(e){var t="#@@#@#";if(e.length<=t.length)return[!1];var a=e.substr(0,t.length)==t;return[a,a?e.substr(t.length):""]},h=function(t){o.cost=VIUtil.calculateRunTime(new Date-o.startTime),e.getSelfCheckMsgs(t,v,function(e){if(e instanceof Array){var a=!1;if(e.length>0){var i=e[e.length-1],s="",r=g(i),c=e.length;r[0]&&(c-=1,a=!0,o.status="true"==r[1]?"success":"failed");for(var u=0;c>u;u++)s+=m(e[u]);o.msgHtml+=s,v+=e.length}a||(d=n(function(){h(t)},l))}else d&&n.cancel(d)})};o.selectName=function(t){v=0,o.msgHtml="",d&&n.cancel(d),o.startTime=new Date,o.pluginID=t.name,o.status="running",e.selfCheck(t.name,function(e){e instanceof VIException&&(o.status="failed",o.msgHtml=e.Message),h(e)})},o.onKeyDown=function(e){if(o.isOpen||38!=e.keyCode&&40!=e.keyCode||(o.isOpen=!0),o.isOpen){var t=o.list.length;switch(e.keyCode){case 13:o.isOpen=!1,o.selectName(o.list[o.selectedIndex]);break;case 38:o.selectedIndex?(o.selectedIndex--,o.selectedIndex<=0&&(o.selectedIndex=0)):o.selectedIndex=t-1;break;case 40:o.selectedIndex>=0?(o.selectedIndex++,o.selectedIndex>=t&&(o.selectedIndex=0)):o.selectedIndex=0}}}}])}(),function(){"use strict";angular.module("viModule").controller("JvmSamplerController",["analyzerService","$compile","$scope","$timeout",function(e,t,a,n){function i(){e.getHeapHisto(function(e){if(--l>0&&(null===e||e.length<10))s=n(i,o);else{var t=0,a=0;r.rawList=e.map(function(e){return t+=e[2],a+=e[1],{"class":VIUtil.formatDesc(e[0],"#"),count:e[1],bytes:e[2]}}),r.totalSize=VIUtil.formatBytes(t),r.totalCount=a}})}var s,r=this,o=1e3,l=3;i(),a.$on("$destroy",function(e){n.cancel(s)})}])}(),function(){"use strict";angular.module("viModule").controller("JardepsController",["$element","$compile","$scope","analyzerService","$timeout",function(e,t,a,n,i){var s=this;s.type="net",s.seleNormal=s.seleStart=s.seleLow=s.seleMany=!0,s.showRow=function(e){switch(e.type){case"normal":return s.seleNormal;case"start":return s.seleStart;case"low":return s.seleLow;case"many":return s.seleMany;default:return!0}},s.normalCount=0,s.lowCount=0,s.manyCount=0,a.$watch("vm.type",function(e){"tree"==s.type?d.style("display","none").style("cursor",""):d.style("display","").style("cursor","move")});var r=e[0].scrollWidth-20;e[0].style.overflow="hidden";var o,l=document.documentElement,c=(l.scrollHeight>l.clientHeight?l.scrollHeight:l.clientHeight)-140,d=(d3.scale.category20(),d3.select(e[0]).append("svg")),u=d.attr("class","overlay").attr("width",r).attr("height",c).attr("pointer-events","all").style("cursor","move").call(d3.behavior.zoom().on("zoom",function(){u.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")})).append("g"),p=u.append("defs"),m=p.append("marker").attr("id","arrow").attr("class","arrow").attr("markerUnits","strokeWidth").attr("markerWidth","39").attr("markerHeight","39").attr("viewBox","0 0 30 30").attr("refX","20").attr("refY","6").attr("orient","auto"),v="M2,2 L10,6 L2,10 L6,6 L2,2";m.append("path").attr("d",v).attr("fill","#60b3e0"),n.getDeps(function(e){function t(e){var t;if(e&&null!==(t=e.match(/\d+\.\d+\.\d+|\d+\.\d+/g))){var a=t.shift().split("."),n=0;2==a.length&&a.push(0);for(var i=0;i<a.length;i++)n+=(a[i]-0)*Math.pow(1e4,2-i);return n}}function n(e,t,a){for(var n=0;n<e.length;n++){var i=e[n].data;if(i.artifactId==t.artifactId&&i.groupId==t.groupId)return i.targets.push({groupId:a.data.groupId,artifactId:a.data.artifactId,scope:a.data.scope,version:a.data.version,needVersion:t.version}),n}return-1}s.data=e;for(var i={nodes:[],links:[]},l=0;l<e.length;l++){var d=e[l];d.fullName=d.groupId+":"+d.artifactId+":"+d.version,d.targets=[],i.nodes.push({name:d.artifactId+"("+d.version+")",group:l+1,data:d})}angular.forEach(i.nodes,function(e,t){angular.forEach(e.data.dependencies,function(a){var s=n(i.nodes,a,e);s>=0&&i.links.push({source:t,target:s,value:1})})});var p=d3.layout.force().nodes(i.nodes).links(i.links).size([r,c]).linkDistance(120).charge(-340).gravity(.03).start(),m=p.drag().on("dragstart",function(e){d3.event.sourceEvent.stopPropagation()}),v=u.selectAll(".link").data(i.links).enter().append("line").attr("class","link").style("stroke-width",function(e){return 1}).attr("marker-end","url(#arrow)"),g=u.selectAll(".node").data(i.nodes).enter().append("g").attr("class","node").call(m);o=g,g.on("mouseover",function(e){u.style("cursor","pointer"),a.$apply(function(){s.seleNode=e.data});var t=[];t.push(e.index),v.attr("class",function(a){return a.target.index==e.index&&t.push(a.source.index),a.source.index==e.index&&t.push(a.target.index),a.target.index==e.index||a.source.index==e.index?"link":(d3.select(this).attr("marker-end",null),"nonsele-link")}),g.attr("class",function(e){return t.indexOf(e.index)>=0?"node":"nonsele-node"})}).on("mouseout",function(){g.attr("class","node"),u.style("cursor","move"),v.attr("class","link").attr("marker-end","url(#arrow)")}),g.append("circle").attr("r",15).style("fill",function(e){var a="#ccff33";if(0==e.index)a="orange",e.data.type="start";else{var n=t(e.data.version),i=e.data.targets.map(function(e){return t(e.needVersion)});i.push(n),i=i.filter(function(e,t,a){return a.indexOf(e)===t&&e}).sort(),i.length>0&&(n!=i[i.length-1]?a="#d15b47":i.length>1&&(a="#ffff00"))}switch(a){case"#ccff33":s.normalCount++,e.data.type="normal";break;case"#d15b47":e.data.type="low",s.lowCount++;break;case"#ffff00":e.data.type="many",s.manyCount++}return a}),g.append("text").text(function(e){return e.name}),p.on("tick",function(){v.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),g.attr("transform",function(e){return"translate("+e.x+","+e.y+")"})})}),s.keywordChange=function(){o.attr("keyword",function(e){return s.keyword.length>0&&e.name.indexOf(s.keyword)>=0?!0:null})}}])}(),function(){"use strict";angular.module("viModule").controller("GCLogAnalyzerController",["$element","$compile","$scope","$timeout","analyzerService","$location","gclogDurationRange","toastr",function(e,t,a,n,i,s,r,o){function l(e,t,a){return e&&t?e>t?a?e:t:a?t:e:e?e:t?t:void 0}function c(e){u.interactiveGraphOptions.chart.type="lineChart",u.interactiveGraphOptions.chart.showLegend=!1,u.interactiveGraphOptions.chart.forceY=[0,5],u.interactiveGraphOptions.title.text="Heap after GC",u.interactiveGraphOptions.chart.yAxis.axisLabel="Heap Size(mb)",u.interactiveGraphOptions.chart.callback=function(e){d3.select(e.container).selectAll("path.nv-point").attr("class",function(e){var t=d3.select(this).attr("class")||"";return e[0][1]?t+" fullgc-mark":t})},u.interactiveGraphOptions.chart.x=function(e){return e?e[0]||0:0},u.interactiveGraphOptions.chart.y=function(e){return e?e[7]:0},u.interactiveGraphData=[{key:"after GC",area:!0,values:e}]}function d(e){u.interactiveGraphOptions={chart:{type:"lineChart",color:v,height:450,margin:{top:20,right:20,bottom:40,left:60},x:function(e){return e instanceof Array?e[0]:e},y:function(e){return e instanceof Array?e[1]:e},shape:function(e){return"square"},clipEdge:!0,duration:100,useInteractiveGuideline:!0,xAxis:{showMaxMin:!1,axisLabel:"Time UTC+0800",tickFormat:function(e){return d3.time.format("%X %b %d")(new Date(e))}},yAxis:{axisLabel:"Heap Size(mb)",tickFormat:function(e){return d3.format(",.0f")(e/1024)}},zoom:{enabled:!0,scaleExtent:[1,50],useFixedDomain:!1,useNiceScale:!1,horizontalOff:!1,verticalOff:!1,unzoomEventType:"dblclick.zoom"}},title:{enable:!0,text:"Heap Usage"}},u.operations=[{name:"Heap after GC",selected:!0},{name:"Heap before GC"},{name:"GC Duration"},{name:"Reclaimed Bytes"},{name:"Young Gen"},{name:"Old Gen"},{name:"A & P"}],u.seleOpr=u.operations[0];var t,a,n,i,s=0,d=0,g=0,h=0,f=0,b=0;u.stats.totalPromotedBytes=0,u.stats.intervalAvgTime="",u.stats.minorIntervalAvg="",u.stats.fullIntervalAvg="";var y,w,C,k,x,I=e,M=0,T=0,S=0,D=0,$=0,N=0,E=0,O=0,G=0,P=0,F=0,A=0,L=0,U=0,_=0,R=0,j=0,z=0,B=0,H=0,V=0,q=1e8,X=[.1,q];if(r&&r.length){var K=[],W=!1;angular.forEach(r.split(","),function(e){return isNaN(e)?(W=!0,!1):void K.push(e-0)}),W?o.error("Wrong gclog.duration.range config!"):(X=K,X.push(q))}var J={};I.forEach(function(e,r){e[0]=new Date(e[0]);var o=e[2];r>0&&(G+=e[0]-I[r-1][0]),E+=o,o>O&&(O=o),C=o-A,A+=C/++l,L+=C*(o-A);for(var l=0;l<X.length;l++){var c=0===l?0:X[l-1],p=X[l];o>=c&&p>o&&(J[p]=J[p]||{count:0,name:c+"-"+(p==q?"":p),percentage:0},J[p].count++)}e[1]?(b++,h+=o,x=o-z,z+=x/++H,B+=x*(o-z),b>1&&(F+=e[0]-w),e[11]?($=e[11],e[9]>N&&(N=e[9]),e[9]=e[3],e[10]=e[4],e[11]=e[5],e[3]=e[6]-e[9],e[4]=e[7]-e[10],e[5]=e[8]-e[11]):(e[6]=I[r-1][6],e[3]=I[r-1][3]),d+=e[6]-e[7],n?n>o&&(n=o):n=o,i?o>i&&(i=o):i=o,w=e[0]):(k=o-_,_+=k/++j,R+=k*(o-_),f++,f>1&&(P+=e[0]-y),g+=o,s+=e[6]-e[7],t?t>o&&(t=o):t=o,a?o>a&&(a=o):a=o,y=e[0]),e[11]||(e[9]=e[6]-e[3],e[10]=e[7]-e[4],e[11]=e[8]-e[5]),0===M&&(M=1024*e[5]),e[11]>S&&(S=e[11]);var m=e[3]>e[4]?e[3]:e[4];m>T&&(T=m),m=e[9]>e[10]?e[9]:e[10],m>D&&(D=m);var v=e[10]-e[9];u.stats.totalPromotedBytes+=v>0?v:0,V+=e[7]}),S*=1024,$*=1024,N*=1024,u.suggestHeapMin=V/I.length*1024*3,u.suggestHeapMax=4*u.suggestHeapMin/3,u.totalHeap=1024*I[0][8],u.youngHeap=1024*I[0][5],u.tenuredHeap=1024*I[0][11];var Y=I[I.length-1][0]-I[0][0];u.spendTime=VIUtil.calculateRunTime(Y),u.stats.totalReclaimedBytes=1024*(s+d),u.stats.totalPromotedBytes*=1024,u.stats.reclaimedBytesRate=1e3*u.stats.totalReclaimedBytes/Y,u.stats.promotedBytesRate=1e3*u.stats.totalPromotedBytes/Y,u.stats.totalCount=f+b,u.stats.minorCount=f,u.stats.fullCount=b,u.stats.minorReclaimedBytes=1024*s,u.stats.fullReclaimedBytes=1024*d,u.stats.totalTime=VIUtil.calculateRunTime(Math.ceil(1e3*(g+h))),u.stats.minorTime=VIUtil.calculateRunTime(Math.ceil(1e3*g)),u.stats.fullTime=VIUtil.calculateRunTime(Math.ceil(1e3*h)),u.cumuTimeData[0][1]=g,u.cumuTimeData[1][1]=h,u.avgTimeData[0].values[0][1]=(g/f).toFixed(2),u.avgTimeData[0].values[1][1]=(h/b||0).toFixed(2),u.reclaBytesData[0].values[0][1]=1024*s,u.reclaBytesData[0].values[1][1]=1024*d,T=1024*T,D=1024*D,u.kpi.avgTime=Math.round(1e3*E/I.length);u.kpi.avgTime/1e3;u.stats.avgTime=u.kpi.avgTime+" ms",u.stats.avgTimeStdDev=Math.round(1e3*Math.sqrt(L/(U-1)))+" ms",u.stats.minorAvgStdDev=Math.round(1e3*Math.sqrt(R/(j-1)))+" ms",u.stats.fullAvgStdDev=Math.round(1e3*Math.sqrt(B/(H-1)))+" ms",u.stats.minTime=Math.round(1e3*l(t,n,!1))+" ms",u.stats.maxTime=VIUtil.calculateRunTime(Math.round(1e3*l(a,i,!0))),u.stats.minorMin=Math.round(1e3*t)+" ms",u.stats.minorMax=VIUtil.calculateRunTime(Math.round(1e3*a)),u.stats.minorAvg=Math.round(1e3*g/f)+" ms",u.stats.fullMin=Math.round(1e3*n)+" ms",u.stats.fullMax=VIUtil.calculateRunTime(Math.round(1e3*i)),u.stats.fullAvg=Math.round(1e3*h/b)+" ms",I.length>1&&(u.stats.intervalAvgTime=VIUtil.calculateRunTime(G/(I.length-1))),f>1&&(u.stats.minorIntervalAvg=VIUtil.calculateRunTime(P/(f-1))),b>1&&(u.stats.fullIntervalAvg=VIUtil.calculateRunTime(F/(b-1))),u.kpi.maxTime=Math.ceil(1e3*O),u.kpi.maxTimeStr=VIUtil.calculateRunTime(u.kpi.maxTime);for(var Q=[],U=0;U<X.length;U++){var Z=X[U],ee=J[Z];ee&&ee.count>0&&Q.push({duration:ee.name+(Z==q?(u.kpi.maxTime/1e3).toFixed(1):""),gcCount:ee.count,percentage:Math.ceil(1e4*ee.count/I.length)/100})}u.kpi.durations=Q,u.kpiData=[],u.kpiData.push({color:v[0],values:u.kpi.durations.map(function(e){return{label:e.duration+" secs",value:e.percentage}})}),u.heapSize=[{name:"Young Generation",allocated:M,peak:T},{name:"Old Generation",allocated:S,peak:D}],u.jvmHeapData=[{key:"Young Generation",color:v[0],values:[{label:"allocated",value:M},{label:"peak usage",value:T}]},{key:"Old Generation",color:v[1],values:[{label:"allocated",value:S},{label:"peak usage",value:D}]}],$>0&&(u.heapSize.push({name:"Perm Generation",allocated:$,peak:N}),u.jvmHeapData.push({key:"Perm Generation",color:v[2],values:[{label:"allocated",value:$},{label:"peak usage",value:N}]})),p=I,delete u.interactiveGraphData,c(I),m?(u.switchGraph(u.operations[1]),m=!1):(u.switchGraph(u.operations[0]),m=!0)}var u=this;d3.format(",.0f");i.getJVMOptions(function(e){u.jvmOptions=e}),u.stats={totalCount:0,totalReclaimedBytes:0,totalTime:0,avgTime:0,avgTimeStdDev:0,minTime:0,maxTime:0,intervalAvgTime:0,totalPromotedBytes:0,reclaimedBytesRate:"",promotedBytesRate:""},u.GCLogs=[];var p=[];u.heapSize=[],u.jvmHeapData=[],u.interactiveGraphData=[],u.reclaBytesData=[{values:[["Minor GC",0],["Full GC",0]]}],u.cumuTimeData=[["Minor GC",0],["Full GC",0]],u.avgTimeData=[{values:[["Minor GC",0],["Full GC",0]]}],i.getGCLogList(function(e){u.GCLogs=e;var t=s.search().name;t?u.seleGCLog=t:u.seleGCLog=u.GCLogs[0],i.parseGCLog(u.seleGCLog,function(e){d(JSON.parse(e))})}),u.logFileChange=function(){i.parseGCLog(u.seleGCLog,function(e){s.search({name:u.seleGCLog}),d(JSON.parse(e))})},u.kpi={throughput:99.99,avgTime:0,maxTime:0,durations:[]},u.kpiData=[];var m=!1;u.alloTip="表明每代的分配大小.因数据来源于GC log，可能和JVM配置的参数(i.e. –Xmx, -Xms,…)一致或不一致.例如，应用设置 total heap size为2gb,然而运行时，如果JVM只分配1gb,那么在报告里将只会显示为1gb",u.peakTip="每代内存的峰值,一般峰值不会超过分配的大小,不过在少数情况峰值会超过分配值.特别在G1 GC里",u.statisticTip="基于'实时'数据的统计汇总",u.jvmHeapOptions={chart:{type:"multiBarHorizontalChart",margin:{top:20,right:80,left:80,bottom:30},height:300,showLegend:!0,x:function(e){return e.label},y:function(e){return e.value},showControls:!0,showValues:!0,duration:500,stacked:!0,xAxis:{showMaxMin:!1},yAxis:{tickFormat:function(e){return VIUtil.formatBytes(e)}}}};var v=["#d62728","#1f77b4","purple"];u.throughputTip="处理真实请求占总处理时间的百分比. 高百分比是一个好迹象,表明GC开销低. 应致力达到高吞吐量",u.avgGCTimeTip="GC平均耗费时间",u.maxGCTimeTip="GC最长耗费时间",u.kpiOptions={chart:{type:"multiBarHorizontalChart",margin:{top:0,right:80,left:80,bottom:50},showLegend:!1,height:300,x:function(e){return e.label},y:function(e){return e.value},showControls:!1,showValues:!0,duration:500,stacked:!0,xAxis:{showMaxMin:!1},yAxis:{tickFormat:function(e){return e+"%"}}}},u.switchGraph=function(e){switch(u.seleOpr.selected=!1,e.selected=!0,u.seleOpr=e,u.interactiveGraphOptions.chart.showLegend=!0,delete u.interactiveGraphOptions.chart.callback,u.interactiveGraphOptions.chart.yAxis.tickFormat=function(e){return d3.format(",.0f")(e/1024)},e.name){case"Heap after GC":c(p);break;case"Heap before GC":u.interactiveGraphOptions.chart.type="lineChart",u.interactiveGraphOptions.chart.showLegend=!1,u.interactiveGraphOptions.title.text="Heap before GC",u.interactiveGraphOptions.chart.yAxis.axisLabel="Heap Size(mb)",u.interactiveGraphOptions.chart.callback=function(e){d3.select(e.container).selectAll("path.nv-point").attr("class",function(e){var t=d3.select(this).attr("class")||"";return e[0][1]?t+" fullgc-mark":t})},u.interactiveGraphOptions.chart.x=function(e){return e[0]},u.interactiveGraphOptions.chart.y=function(e){return e[6]},u.interactiveGraphData=[{key:"before GC",area:!0,values:p}];break;case"GC Duration":u.interactiveGraphOptions.chart.type="scatterChart",u.interactiveGraphOptions.chart.color=v,u.interactiveGraphOptions.chart.scatter={onlyCircles:!1},u.interactiveGraphOptions.title.text="GC Duration",u.interactiveGraphOptions.chart.yAxis.axisLabel="Time(secs)",delete u.interactiveGraphOptions.chart.x,delete u.interactiveGraphOptions.chart.y,u.interactiveGraphOptions.chart.yAxis.tickFormat=function(e){return d3.format(",.3f")(e)},u.interactiveGraphData=[{key:"Young GC",values:p.filter(function(e){return!e[1]}).map(function(e){var t=e[2];return{x:e[0],y:t,shape:"square",size:t}})},{key:"full GC",values:p.filter(function(e){return e[1]}).map(function(e){var t=e[2];return{x:e[0],y:t,shape:"triangle-up",size:t}})}];break;case"Reclaimed Bytes":u.interactiveGraphOptions.title.text="Reclaimed Bytes",u.interactiveGraphOptions.chart.yAxis.axisLabel="(mb)",u.interactiveGraphOptions.chart.type="scatterChart",u.interactiveGraphOptions.chart.color=v,u.interactiveGraphOptions.chart.forceY=[0],u.interactiveGraphOptions.chart.scatter={onlyCircles:!1},delete u.interactiveGraphOptions.chart.x,delete u.interactiveGraphOptions.chart.y,u.interactiveGraphData=[{key:"Young GC",values:p.filter(function(e){return!e[1]}).map(function(e){var t=e[3]-e[4];return{x:e[0],y:t,shape:"square",size:t}})},{key:"full GC",values:p.filter(function(e){return e[1]}).map(function(e){var t=e[3]-e[4];return{x:e[0],y:t,shape:"triangle-up",size:t}})}];break;case"Young Gen":u.interactiveGraphOptions.chart.type="lineChart",u.interactiveGraphOptions.title.text="Young Gen",u.interactiveGraphOptions.chart.yAxis.axisLabel="(mb)",u.interactiveGraphOptions.chart.x=function(e){return e[0]},u.interactiveGraphOptions.chart.y=function(e){return e[1]},u.interactiveGraphData=[{key:"allocated space",values:p.map(function(e){return[e[0],e[5]]})},{key:"before GC",values:p.map(function(e){return[e[0],e[3]]})},{key:"after GC",values:p.map(function(e){return[e[0],e[4]]})}];break;case"Old Gen":u.interactiveGraphOptions.title.text="Old Gen",u.interactiveGraphOptions.chart.yAxis.axisLabel="(mb)",u.interactiveGraphOptions.chart.x=function(e){return e[0]},u.interactiveGraphOptions.chart.y=function(e){return e[1]},u.interactiveGraphData=[{key:"allocated space",values:p.map(function(e){return[e[0],e[11]]})},{key:"before GC",values:p.map(function(e){return[e[0],e[9]]})},{key:"after GC",values:p.map(function(e){return[e[0],e[10]]})}];break;case"A & P":u.interactiveGraphOptions.chart.type="lineChart",u.interactiveGraphOptions.title.text="Allocation & Promotion",u.interactiveGraphOptions.chart.yAxis.axisLabel="(mb)",u.interactiveGraphOptions.chart.x=function(e){return e[0]},u.interactiveGraphOptions.chart.y=function(e){return e[1]},u.interactiveGraphOptions.chart.yAxis.tickFormat=function(e){return d3.format(",.3f")(e/1024)},u.interactiveGraphData=[{key:"allocated objects size",values:p.map(function(e){return[e[0],e[6]]})},{key:"Promoted (Young -> Old) objects size",values:p.map(function(e){var t=e[10]-e[9];return[e[0],t>0?t:0]})}]}},u.oldGen={allocatedSpace:p.map(function(e){return[e[0],e[8]-e[5]]}),beforeGC:p.map(function(e){return[e[0],e[6]-e[3]]}),afterGC:p.map(function(e){return[e[0],e[7]-e[4]]})},u.reclaBytesOptions={chart:{type:"discreteBarChart",height:300,margin:{top:20,right:20,bottom:60,left:55},x:function(e){return e[0]},y:function(e){return e[1]},yAxis:{tickFormat:function(e){return VIUtil.formatBytes(e)}},showValues:!0,valueFormat:function(e){return VIUtil.formatBytes(e)},duration:500},title:{enable:!0,text:"Reclaimed Bytes(GB)"}},u.avgTimeOptions=angular.copy(u.reclaBytesOptions),u.avgTimeOptions.title.text="GC Average Time(secs)",u.avgTimeOptions.chart.valueFormat=function(e){return e},u.avgTimeOptions.chart.yAxis.tickFormat=function(e){return e+" secs"},u.cumuTimeOptions=angular.copy(u.avgTimeOptions),u.cumuTimeOptions.title.text="GC cumulative Time(secs)",u.cumuTimeOptions.chart.type="pieChart",u.cumuTimeOptions.chart.tooltip={contentGenerator:function(e){var t=e.series[0],a="<thead><tr><td class='legend-color-guide'><div style='background-color: "+t.color+";'></div></td><td class='key'><strong>"+t.key+"</strong></td><td class='key'><strong>"+t.value.toFixed(2)+" secs</strong></td></tr></thead>";return"<table>"+a+"</table>"}}}])}();var VIUtil=function(){var e=1048576,t=1e6,a=1e3*t,n=1024*e,i=1024*n,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},r={B:"byte",C:"char",D:"double",F:"float",I:"int",J:"long",S:"short",Z:"boolean"};return{removeArrayItem:function(e,t){var a=e.indexOf(t);return a>=0?(e.splice(a,1),!0):!1},objToQuery:function(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")},queryToObj:function(e){for(var t={},a=("?"===e[0]?e.substr(1):e).split("&"),n=0;n<a.length;n++){var i=a[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]||"")}return t},calculateRunTime:function(e){var t=new Date(e),a=t.getUTCMilliseconds(),n=t.getUTCSeconds(),i=t.getUTCMinutes(),s=t.getUTCHours(),r=t.getUTCDate()-1,o=t.getUTCMonth(),l=t.getFullYear()-1970,c="";return l>0&&(c+=" "+l+" year"),o>0&&(c+=" "+o+" month"),r>0&&(c+=" "+r+" day"),s>0&&(c+=" "+s+" hrs"),i>0&&(c+=" "+i+" min"),n>0&&(c+=" "+n+" sec"),a>0&&(c+=" "+a+" ms"),c||Math.ceil(e)+"ms"},formatBytes:function(t,a){a||(t>i?a="T":t>n?a="G":t>e?a="M":t>1024&&(a="K"));var s=t;switch(a){case"T":s=d3.format("#,.1f")(t/i)+"TB";break;case"G":s=d3.format("#,.1f")(t/n)+"GB";break;case"M":s=d3.format("#,.1f")(t/e)+"MB";break;case"m":s=d3.format("#,.3f")(t/e)+"MB";break;case"K":s=d3.format("#,.1f")(t/1024)+"KB";break;default:s=Math.round(t)+"b"}return s},formatNumber:function(e){return e>a?d3.format("#,.1f")(e/a)+"G":e>t?d3.format("#,.1f")(e/t)+"M":e>1024?d3.format("#,.1f")(e/1e3)+"K":e},getNumberFromStr:function(e){return e.replace(/[^\d^\.]/g,"")-0},arrayMax:function(e,t){var a,n=0;return e.forEach(function(e){var i=t(e);i>n&&(n=i,a=e)}),a},noop:function(e){return e},escapeHTML:function(e){return e.replace(/&|<|>|"|'/g,function(e){return s[e]})},uuid:function(){var e=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?a:3&a|8).toString(16)})},formatDesc:function(e,t){for(var a=t||"[",n=0,i=0;i<e.length&&e[i]==a;i++)n++;return e.length==n+1?r[e[n]]+"[]".repeat(n):"L"==e[n]?e.substr(n+1,e.length-n-2)+"[ ]".repeat(n):e}}}();!function(){"use strict";function e(e,t,a){RegExp.escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(!e)return-1;for(var t=0;t<this.length;t++)if(e(this[t]))return t}),hljs.registerLanguage("java",document["hljs.javahl"]),hljs.registerLanguage("xml",document["hljs.xmlhl"]),hljs.registerLanguage("css",document["hljs.csshl"]),hljs.registerLanguage("scss",document["hljs.scsshl"]),t.debug("runBlock end")}e.$inject=["$http","$log","$location"],angular.module("viModule").run(e)}(),function(){"use strict";function routerConfig($stateProvider,$urlRouterProvider,$controllerProvider){var customComponentCache={},customPageCache={},states=$stateProvider.state("empty",{}).state("Configuration",{url:"/config",templateUrl:"app/config/config.html",controller:"ConfigController",controllerAs:"vm"}).state("Settings",{url:"/settings/:tab",templateUrl:"app/settings/settings.html",controller:"SettingsController",controllerAs:"vm"}).state("Code",{url:"/code/folder/:path",templateUrl:"app/code/code.html",controller:"CodeController",controllerAs:"vm",resolve:{codeServiceData:["codeService",function(e){return e.promise}]}}).state("Code-Content",{url:"/code/content/:path",templateUrl:"app/code/code.content.html",controller:"CodeContentController",controllerAs:"vm",resolve:{codeServiceData:["codeService",function(e){return e.promise}]}}).state("Dashboard",{url:"/dashboard",templateUrl:"app/dashboard/dashboard.html",controller:"DashboardController",controllerAs:"vm"}).state("JVM-Sampler",{url:"/dashboard/trace",templateUrl:"app/dashboard/trace/trace.html",controller:"TraceController",controllerAs:"vm"}).state("Component",{url:"/",templateUrl:"app/component/component.html",controller:"ComponentController",controllerAs:"vm"}).state("Component-Detail",{url:"/component/detail/:id/:name",templateUrl:"app/component/component.detail.html",controller:"ComponentDetailController",controllerAs:"vm"}).state("Component-DetailList",{url:"/component/detail.list/:id/:name",templateUrl:"app/component/component.detail.list.html",controller:"ComponentDetailListController",controllerAs:"vm"}).state("Component-Custom",{url:"/component/custom/:id/:name",template:function(e){return'<div ng-controller="'+e.id+'">'+customComponentCache[e.id+".html"]+"</div>"},resolve:{load:["$q","$stateParams","customComponentStatus",function($q,$stateParams,customComponentStatus){return customComponentStatus.getCustom($stateParams.id).then(function(data){customComponentCache[$stateParams.id+".html"]=unescape(data.data.html);var tmpFun=eval("({fun:"+data.data.js+"})");$controllerProvider.register($stateParams.id,tmpFun.fun)})}]},controllerAs:"vm"}).state("FC",{url:"/fc",templateUrl:"app/fc/fc.html",controller:"FCController",controllerAs:"vm"}).state("Log",{url:"/log",templateUrl:"app/log/log.html",controller:"LogController",controllerAs:"vm"}).state("Log-Detail",{url:"/log/detail/:name/:size",templateUrl:"app/log/log.detail.html",controller:"LogDetailController",controllerAs:"vm"}).state("ThreadDump",{url:"/threaddump",templateUrl:"app/threaddump/threaddump.html",controller:"ThreadDumpController",controllerAs:"vm"}).state("Cache",{url:"/cache",templateUrl:"app/cache/cache.html",controller:"CacheController",controllerAs:"vm"}).state("Analyzer-Jardependency",{url:"/analyzer/jardeps",templateUrl:"app/analyzer/jardeps.html",controller:"JardepsController",controllerAs:"vm"}).state("Analyzer-VisualGC",{url:"/analyzer/visualgc",templateUrl:"app/analyzer/visualgc.html",controller:"VisualGCController",controllerAs:"vm"}).state("Analyzer-GCLogAnalyzer",{url:"/analyzer/gcloganalyzer",templateUrl:"app/analyzer/gcloganalyzer.html",controller:"GCLogAnalyzerController",controllerAs:"vm",resolve:{gclogDurationRange:["configService",function(e){return e.get("vi.gclog.duration.range")}]}}).state("Analyzer-SelfCheck",{url:"/analyzer/selfcheck",templateUrl:"app/analyzer/selfcheck.html",controller:"SelfCheckController",controllerAs:"vm"}).state("Analyzer-JVMSampler",{url:"/analyzer/jvmsampler",templateUrl:"app/analyzer/jvmsampler.html",controller:"JvmSamplerController",controllerAs:"vm"});if("undefined"!=typeof $SMENU){var templateFun=function(e){return'<div ng-controller="'+e.pageId+'">'+customPageCache[e.pageId+".html"]+"</div>"},resolveFun={load:function($q,$stateParams,customPageService){return $stateParams.pageId="custom-"+this.self.name,$stateParams.stateId=this.self.name,customPageService.get(this.self.name).then(function(data){customPageCache[$stateParams.pageId+".html"]=unescape(data.html);var tmpFun=eval("({fun:"+data.js+"})");$controllerProvider.register($stateParams.pageId,tmpFun.fun)})}},addStateFun=function(e){e.isBuildIn||states.state(e.state,{url:"/page/"+e.state,template:templateFun,resolve:resolveFun})};angular.forEach($SMENU,function(e){addStateFun(e),e.submenu&&angular.forEach(e.submenu,addStateFun)})}$urlRouterProvider.otherwise("/")}routerConfig.$inject=["$stateProvider","$urlRouterProvider","$controllerProvider"],angular.module("viModule").config(routerConfig)}(),function(){"use strict";angular.module("viModule").filter("sumOfValue",function(){return function(e,t){if(angular.isUndefined(e)||angular.isUndefined(t))return 0;var a=0;return angular.forEach(e,function(e){a+=parseInt(e[t])}),a}}).filter("size",function(){return VIUtil.formatBytes})}(),function(){"use strict";angular.module("viModule").factory("ApiService",["$window","$log","$http","API_ENDPOINT","$confirm",function(e,t,a,n,i){var s=n,r=s.host?s.port?s.host+":"+s.port+s.path:s.host+s.path:s.path;return{getEndpoint:function(){return r},setEndpoint:function(e){s=e,r=s.host?s.port?s.host+":"+s.port+s.path:s.host+s.path:s.path},doGet:function(e,n){var e=r+"/"+e;return a.get(e,{params:n}).then(function(e){var t=e.data;if("string"==typeof t&&"$@###@"==t.substr(0,6)){var a=t.lastIndexOf("@"),n=new VIException(t.substr(6,a-6),t.substr(a+1));
return n}return t})["catch"](function(a){var n=a.data||"";if("string"==typeof n&&"$@###@"==n.substr(0,6)){var s=n.lastIndexOf("@"),r=new VIException(n.substr(6,s-6),n.substr(s+1));return"com.ctrip.framework.cs.NoPermissionException"==r.Type&&i({text:"You do not have permission for this operation or login has expired!do you wanna logout and login again?"}).then(function(){location.href="logout"}),r}t.error("XHR Failed for get"+e+".\n"+angular.toJson(a.data,!0))})},doGetFunc:function(e,n){return e=r+"/"+e,a.get(e).then(function(e){return n(e.data,e.headers("vi-permission"))})["catch"](function(a){t.error("XHR Failed for get"+e+".\n"+angular.toJson(a.data,!0))})},doPost:function(e,n){var n=r+"/"+n;return a({url:n,method:"POST",data:e}).then(function(e){var t=e.data;if("string"==typeof t&&"$@###@"==t.substr(0,6)){var a=t.lastIndexOf("@");return new VIException(t.substr(6,a-6),t.substr(a+1))}return t},function(e){t.error("XHR Failed for get"+n+".\n"+angular.toJson(e.data,!0))})},getAbsoluteUrl:function(e){return this.getEndpoint()+e}}}]).factory("SiteCache",["$cacheFactory",function(e){return e("siteCache")}])}(),function(){"use strict";function e(e,t,a,n,i,s){var r=this;r.winWidth=e.innerWidth-110+"px",r.winHeight=e.innerHeight-93+"px",r.collapse=function(t){r.sidebarCollapse=t,t?r.winWidth=e.innerWidth-55+"px":r.winWidth=e.innerWidth-110+"px"};var o=function(){i.$apply(function(){r.winWidth=e.innerWidth-110+"px",r.winHeight=e.innerHeight-93+"px"})};angular.element(e).on("resize",o),i.$on("$destroy",function(t){angular.element(e).off("resize",o)}),r.views={};var l=null;i.$on("$switchTab",function(e,t){isNaN(t)?(r.showMain=!1,r.views[l]&&(r.views[l].show=!1),r.views[t].show=!0,l=t):(r.showMain=!0,-1===t&&(r.views={}))}),i.$on("$removeTab",function(e,t){l==t&&(r.showMain=!0,l=0),delete r.views[t]}),i.$on("$newViView",function(e,t,a,i){var o=s.get(t);r.views[t+i]||(r.views[t+i]={controller:o.controller+(o.controllerAs?" as "+o.controllerAs:""),url:o.templateUrl,params:VIUtil.objToQuery(a),show:!0},null!==l&&r.views[l]&&(r.views[l].show=!1),l=t+i),n.$broadcast("$viViewAdded",t,i),r.showMain=!1}),r.showMain=!0,t.put("fieldMeta",{}),a.getComponentFieldMeta().then(function(e){t.put("fieldMeta",e),n.$broadcast("fieldMeta",e)}),a.getHostInfo().then(function(e){t.put("hostInfo",e),n.$broadcast("hostInfo.ready",e)})}e.$inject=["$window","SiteCache","serviceInfo","$rootScope","$scope","$state"],angular.module("viModule").controller("IndexController",e)}(),function(){"use strict";angular.module("viModule").constant("Permission",{ALL:1,READ:2,EDIT:4})}(),function(){"use strict";function e(e,t,a,n){e.debugEnabled(!1),t.allowHtml=!0,t.timeOut=3e3,t.positionClass="toast-top-right",t.preventOpenDuplicates=!0,t.progressBar=!1,a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",n.pagination.template="template/pagination.custom.html"}e.$inject=["$logProvider","toastrConfig","$httpProvider","stConfig"],angular.module("viModule").config(e)}(),function(){return angular.module("viModule").constant("API_ENDPOINT",{path:"api",needsAuth:!1})}(),angular.module("viModule").run(["$templateCache",function(e){e.put("app/analyzer/gcloganalyzer.html",'<section class="report-section bg-grey arrow-bottom"><div class="container"><div class="row"><div class="col-md-4 col-sm-12"><h2>GC Analysis Report</h2></div><div class="col-md-4 col-sm-12"></div><div class="col-md-4 col-sm-12 text-right"></div><div class="col-lg-12"><p>GC log file: <strong><select class="gclog-sele form-control" ng-model="vm.seleGCLog" ng-options="x for x in vm.GCLogs" ng-change="vm.logFileChange()"></select></strong></p><p>Measurement time: <strong>{{vm.spendTime}}</strong></p><hr></div></div><div><uib-tabset active="active"><uib-tab index="0" heading="当前JVM 参数:"><br>{{vm.jvmOptions}}</uib-tab><uib-tab index="1" heading="JVM 参数说明:"><div class="show-content"><br><a href="http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/gc01/index.html" target="_blank">点击查看官方文档</a><h4>堆参数</h4><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-Xms</td><td>设置JVM启动时堆的初始化大小。</td></tr><tr><td>-Xmx</td><td>设置堆最大值。</td></tr><tr><td>-Xmn</td><td>设置年轻代的空间大小，剩下的为老年代的空间大小。</td></tr><tr><td>-XX:PermGen</td><td>设置永久代内存的初始化大小。</td></tr><tr><td>-XX:MaxPermGen</td><td>设置永久代的最大值。</td></tr><tr><td>-XX:SurvivorRatio</td><td>提供Eden区和survivor区的空间比例。比如，如果年轻代的大小为10m并且VM开关是-XX:SurvivorRatio=2，那么将会保留5m内存给Eden区和每个Survivor区分配2.5m内存。默认比例是8。</td></tr><tr><td>-XX:NewRatio</td><td>提供年老代和年轻代的比例大小。默认值是2。</td></tr></tbody></table><h4>回收器参数</h4><table><thead><tr><th>类型</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td>-XX:+UseSerialGC（串行）</td><td>Young区和old区都使用serial 垃圾回收算法，。算法：标记，清除（正常清除，整理清除：重新整理冗余空间，提高重新分配空间效率）</td></tr><tr><td>-XX:+UseParallelGC（并行）</td><td>Young区：使用Parallel scavenge 回收算法，会产生多个线程并行回收。通过-XX:ParallelGCThreads=n参数指定有线程数，默认是CPU核数。old区单线程。</td></tr><tr><td>-XX:+UseParallelOldGC（并行）</td><td>和UseParallelGC一样,年轻代垃圾收集和年老代垃圾回收时都使用<strong>多线程</strong>收集</td></tr><tr><td>-XX:+UseConcMarkSweepGC（并发）</td><td><strong>短暂停顿</strong>的并发的收集。Young区：可以使用普通的或者parallel 垃圾回收算法，由参数 -XX:+UseParNewGC来控制。Old 区：只能使用Concurrent Mark Sweep</td></tr><tr><td>-XX:+UseG1GC</td><td>并行的、并发的和增量式压缩短暂停顿的垃圾收集器。不区分年轻代和年老代空间。它把堆空间划分为多个大小相等的区域。当进行垃圾收集时，它会优先收集存活对象较少的区域，因此叫“Garbage First”。</td></tr></tbody></table><p>目前主要有串行、并行和并发三种，对于大内存的应用而言，串行的性能太低，因此使用到的主要是并行和并发两种。<br>并行和并发GC的策略通过UseParallelGC和UseConcMarkSweepGC来指定，<br>还有一些细节的配置参数用来配置策略的执行方式，<br>例如XX:ParallelGCThreads, XX:CMSInitiatingOccupancyFraction等。<br>通常：young区对象回收只可选择并行（<strong>耗时间</strong>），old区选择并发（<strong>耗CPU</strong>）。</p><blockquote><p>项目中常用配置：<br>-Xms3g -Xmx3g<br>-XX:+UseConcMarkSweepGC<br>-XX:CMSMaxAbortablePrecleanTime=5000<br>-XX:+CMSClassUnloadingEnabled<br>-XX:CMSInitiatingOccupancyFraction=80 (old区百分之80触发cms gc,跟UseCMSInitiatingOccupancyOnly一起配合使用)<br>-XX:+UseCMSInitiatingOccupancyOnly</p></blockquote><h4>常用组合</h4><table><thead><tr><th>Young</th><th style="text-align:center">Old</th><th style="text-align:center">JVM options</th></tr></thead><tbody><tr><td>Serial</td><td>Serial</td><td>-XX:+UserSerialGC</td></tr><tr><td>Parallel scavenge</td><td>Parallel Old/Serial</td><td>-XX:+UserParallelGC -XX:-UserParallelOldGC</td></tr><tr><td>Serial/Parallel scavenge</td><td>CMS</td><td>-XX:-UserParNewGC -XX:+UseConcMarkSweepGC</td></tr><tr><td>G1</td><td></td><td>-XX:UserG1GC</td></tr></tbody></table></div></uib-tab></uib-tabset></div><hr><p style="display:none"><i class="fa fa-smile-o fa-3x" data-toggle="tooltip" data-placement="bottom"></i> 恭喜! 你的应用GC很健康.</p><hr><div class="row"><div><h2><i class="fa fa-gears"></i> Heap size Tuning Tips</h2><p>(<b>CAUTION:</b>通用优化指南,仅供参考,请实施前充分测试)</p><p></p><ul class="green-arrow"><li>-Xms {{vm.suggestHeapMin|size}} ~ {{vm.suggestHeapMax|size}}</li><li>-Xmx {{vm.suggestHeapMin|size}} ~ {{vm.suggestHeapMax|size}}</li></ul><p></p><hr></div></div><div class="row"><div><h2><i class="fa fa-stack-exchange"></i> JVM Heap Size</h2></div><div class="col-md-4 col-sm-12"><table><tbody><tr><td><b>Generation</b></td><td width="110px"><b>Allocated <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="{{vm.alloTip}}"></i></b></td><td><b>Peak <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="{{vm.peakTip}}"></i></b></td></tr><tr ng-repeat="item in vm.heapSize"><td>{{item.name}}</td><td>{{item.allocated|size}}</td><td>{{item.peak|size}}</td></tr><tr><td>Total</td><td>{{vm.heapSize|sumOfValue:\'allocated\'|size}}</td><td>{{vm.heapSize|sumOfValue:\'peak\'|size}}</td></tr></tbody></table></div><div class="col-md-8 col-sm-12"><div class="graph-container"><nvd3 options="vm.jvmHeapOptions" data="vm.jvmHeapData"></nvd3></div></div></div><div class="row"><div class="col-sm-12"><hr></div></div><div class="row"><div><h2><i class="fa fa-key"></i> Key Performance Indicators</h2><p style="display:none"><span style="underline;">(此部分内容很重要. 了解更多KPIs信息, <a href="https://blog.gceasy.io/2016/10/01/garbage-collection-kpi/" target="_blank"><u>click here</u></a>)</span></p></div><div class="col-md-4 col-sm-12"><p><div style="display:none"><span class="badge" style="background-color:#000;">1</span><b>Throughput <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="{{vm.throughputTip}}"></i> : {{vm.kpi.throughput}}%</b></div><br><br><span class="badge" style="background-color:#000;">1</span><b>Latency:</b><br></p><table><tbody><tr><td>Avg GC Time <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="{{vm.avgGCTimeTip}}"></i></td><td><b>{{vm.kpi.avgTime}} ms</b></td></tr><tr><td>Max GC Time <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="{{vm.maxGCTimeTip}}"></i></td><td><b>{{vm.kpi.maxTimeStr}}</b></td></tr></tbody></table><br><strong>GC Duration Time Range</strong> <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="GC耗时区间"></i>:<p></p><table><tbody><tr><td><b>Duration (secs)</b></td><td><b>No. of GCs</b></td><td><b>Percentage</b></td></tr><tr ng-repeat="item in vm.kpi.durations"><td align="center">{{item.duration}}</td><td align="center">{{item.gcCount}}</td><td align="center">{{item.percentage}}%</td></tr></tbody></table></div><div class="col-md-8 col-sm-12"><div class="graph-container"><nvd3 options="vm.kpiOptions" data="vm.kpiData"></nvd3></div></div></div><div class="row"><div class="col-sm-12"><hr></div></div><div class="result_box"><div><h2><i class="fa fa-signal"></i> Interactive Graphs</h2><p><i>(所有图形均可缩放)</i></p></div><div class="col-md-12 col-sm-12"><table class="big-graph-container"><tbody><tr valign="top"><td><ul><li ng-click="vm.switchGraph(opr)" ng-repeat="opr in vm.operations"><button ng-class="{\'btn-sele\':opr.selected}" class="btn btn-info">{{opr.name}}</button></li></ul></td><td width="90%"><div class="big-graph-container"><nvd3 options="vm.interactiveGraphOptions" data="vm.interactiveGraphData"></nvd3></div></td></tr></tbody></table></div></div><div class="row"><div class="col-sm-12"><hr></div></div><div class="row"><div><h2><i class="fa fa-compass"></i> GC Statistics <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="{{vm.statisticTip}}"></i></h2></div><div class="col-md-4 col-sm-12"><div class="stat-graph-container"><nvd3 options="vm.reclaBytesOptions" data="vm.reclaBytesData"></nvd3></div></div><div class="col-md-4 col-sm-12"><div class="stat-graph-container"><nvd3 options="vm.cumuTimeOptions" data="vm.cumuTimeData"></nvd3></div></div><div class="col-md-4 col-sm-12"><div class="stat-graph-container"><nvd3 options="vm.avgTimeOptions" data="vm.avgTimeData"></nvd3></div></div><div class="col-md-4 col-sm-12"><br><br><h3>Total GC stats</h3><table style="width: 100%;"><tbody><tr><td style="width:50%">Total GC count</td><td>{{vm.stats.totalCount}}</td></tr><tr><td>Total reclaimed bytes <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="通过GC从内存中移除的总bytes"></i></td><td>{{vm.stats.totalReclaimedBytes|size}}</td></tr><tr><td>Total GC time</td><td>{{vm.stats.totalTime}}</td></tr><tr><td>Avg GC time</td><td>{{vm.stats.avgTime}}</td></tr><tr><td>GC avg time std dev</td><td>{{vm.stats.avgTimeStdDev}}</td></tr><tr><td>GC min/max time</td><td>{{vm.stats.minTime}}/ {{vm.stats.maxTime}}</td></tr><tr></tr><tr><td>GC Interval avg time <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="GC事件平均时间间隔"></i></td><td>{{vm.stats.intervalAvgTime}}</td></tr></tbody></table></div><div class="col-md-4 col-sm-12"><br><br><h3>Minor GC stats</h3><table style="width: 100%;"><tbody><tr><td style="width:50%">Minor GC count</td><td>{{vm.stats.minorCount}}</td></tr><tr><td>Minor reclaimed bytes <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="通过Minor GC从内存中移除的总bytes"></i></td><td>{{vm.stats.minorReclaimedBytes|size}}</td></tr><tr><td>Minor GC time</td><td>{{vm.stats.minorTime}}</td></tr><tr><td>Minor Avg GC time</td><td>{{vm.stats.minorAvg}}</td></tr><tr><td>Minor GC avg time std dev</td><td>{{vm.stats.minorAvgStdDev}}</td></tr><tr><td>Minor GC min/max time</td><td>{{vm.stats.minorMin}}/ {{vm.stats.minorMax}}</td></tr><tr></tr><tr><td>Minor GC Interval avg time <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="Minor GC事件平均时间间隔"></i></td><td>{{vm.stats.minorIntervalAvg}}</td></tr></tbody></table></div><div class="col-md-4 col-sm-12"><br><br><h3>Full GC stats</h3><table style="width: 100%;"><tbody><tr><td style="width:50%">Full GC count</td><td>{{vm.stats.fullCount}}</td></tr><tr><td>Full reclaimed bytes <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="通过Full GC从内存中移除的总bytes"></i></td><td>{{vm.stats.fullReclaimedBytes|size}}</td></tr><tr><td>Full GC time</td><td>{{vm.stats.fullTime}}</td></tr><tr><td>Full Avg GC time</td><td>{{vm.stats.fullAvg}}</td></tr><tr><td>Full GC avg time std dev</td><td>{{vm.stats.fullAvgStdDev}}</td></tr><tr><td>Full GC min/max time</td><td>{{vm.stats.fullMin}}/ {{vm.stats.fullMax}}</td></tr><tr></tr><tr><td>Full GC Interval avg time <i class="fa fa-question-circle question-mark" tooltip-placement="bottom" uib-tooltip="Full GC事件平均时间间隔"></i></td><td>{{vm.stats.fullIntervalAvg}}</td></tr></tbody></table></div></div><hr><div class="row"><div><h2><i class="fa fa-gear"></i> Object Stats</h2><p><span style="underline;">These are good metrics to compare with previous baseline</span></p><div class="col-md-12 col-sm-12"><table><tbody><tr><td>Total created bytes <i class="fa fa-question-circle question-mark" tooltip-placement="top" uib-tooltip="应用创建的总字节数. 为达到更好性能，请尽可能降低此值"></i></td><td>{{vm.stats.totalReclaimedBytes|size}}</td></tr><tr><td>Total promoted bytes <i class="fa fa-question-circle question-mark" tooltip-placement="top" uib-tooltip="从年轻代提升到老年代字节数的总和"></i></td><td>{{vm.stats.totalPromotedBytes|size}}</td></tr><tr><td>Avg creation rate <i class="fa fa-question-circle question-mark" tooltip-placement="top" uib-tooltip="应用对象创建率. 当更多的对象被创建时, 需要更多的GC执行以在内存中回收这些对象. 性能优化的单一秘诀，请尽可能降低对象创建率."></i></td><td>{{vm.stats.reclaimedBytesRate|size}}/sec</td></tr><tr></tr><tr><td>Avg promotion rate <i class="fa fa-question-circle question-mark" tooltip-placement="top" uib-tooltip="从年轻代提升到老年代的速率. 当更多对象提升到老年代, 会引发更加频繁的Full GC."></i></td><td>{{vm.stats.promotedBytesRate|size}}/sec</td></tr></tbody></table></div></div></div><hr></div></section>'),e.put("app/analyzer/jardeps.html",'<div class="op-area type-switch row"><div class="btn-group col-md-3"><label class="btn btn-primary" ng-model="vm.type" uib-btn-radio="\'net\'">Net</label> <label class="btn btn-primary" ng-model="vm.type" uib-btn-radio="\'tree\'">Tree</label></div><div class="input-group col-md-6"><div class="input-group-addon"><i class="fa fa-search"></i></div><input placeholder="key word" ng-model="vm.keyword" ng-change="vm.keywordChange()" class="input-sm form-control" type="search"></div></div><div class="op-area" ng-class="{\'net-mode\':vm.type===\'net\'}"><div class="normal cell"><input type="checkbox" ng-model="vm.seleNormal">normal ({{vm.normalCount}})</div><div class="start cell"><input type="checkbox" ng-model="vm.seleStart">start</div><div class="low cell"><input type="checkbox" ng-model="vm.seleLow">low version ({{vm.lowCount}})</div><div class="many cell"><input type="checkbox" ng-model="vm.seleMany">many version ({{vm.manyCount}})</div></div><div class="main-area op-area" ng-show="vm.type===\'tree\'"><table class="table deps-table"><colgroup><col style="width: 85%;"><col style="width: 15%;"></colgroup><thead><tr class="widget-header"><th>Name</th><th>Version</th></tr></thead><tbody ng-repeat="r in vm.data | filter:{\'fullName\':vm.keyword}" ng-show="vm.showRow(r)"><tr ng-dblclick="r.show=!r.show" class="art-row {{r.type}}"><td><span ng-click="r.show=!r.show" class="btn"><i ng-class="{\'fa-minus-circle\':r.show,\'fa-plus-circle\':!r.show}" class="fa"></i></span> {{r.fullName}}</td><td>{{r.version}}</td></tr><tr ng-show="r.show"><td colspan="2">Dependencies</td></tr><tr ng-show="r.show" class="dep-row {{d.type}}" ng-repeat="d in r.dependencies"><td>{{d.groupId}}:{{d.artifactId}}:{{d.version}}[{{d.scope||\'compile\'}}]</td><td>{{d.version}}</td></tr><tr ng-show="r.show"><td colspan="2">Usages</td></tr><tr ng-show="r.show" class="dep-row {{d.type}}" ng-repeat="d in r.targets" ng-class="{\'wrong-version\': r.version!=d.needVersion}"><td>{{d.groupId}}:{{d.artifactId}}:{{d.version}}[{{d.scope||\'compile\'}}]</td><td>{{d.needVersion}}</td></tr></tbody></table></div><div ng-show="vm.type==\'net\'" class="d3-tooltip deps-tooltip"><div class="title">{{vm.seleNode.groupId}}:{{vm.seleNode.artifactId}}:<span class="pom-version">{{vm.seleNode.version}}</span></div><div class="title">Location: {{vm.seleNode.location}}</div><div class="title">Size: {{vm.seleNode.size/1024|number:2}} KB</div><div>Dependencies:</div><ul><li ng-repeat="d in vm.seleNode.dependencies"><div>{{d.groupId}}:{{d.artifactId}}:{{d.version}}[{{d.scope||\'compile\'}}]</div></li></ul><div>Usages:</div><ul><li ng-repeat="d in vm.seleNode.targets"><div>{{d.groupId}}:{{d.artifactId}}:{{d.version}}[{{d.scope||\'compile\'}}] -> <span ng-class="{\'wrong-version\':vm.seleNode.version!=d.needVersion}" class="pom-version">{{d.needVersion}}</span></div></li></ul></div>'),e.put("app/analyzer/jvmsampler.html",'<table st-table="vm.list" st-safe-src="vm.rawList" class="table table-striped"><thead><tr><th colspan="3" class="search-container"><div class="widget-header"><span class="title">JVM heapHisto({{vm.rawList.length}})</span><div class="input-group"><div class="input-group-addon"><i class="fa fa-search"></i></div><input st-search="" placeholder="关键字" class="input-sm form-control" type="search"></div></div></th></tr><tr class="summary-bar"><th colspan="3"><div class="info-cell">total objects count: {{vm.totalCount}} / total bytes: {{vm.totalSize}}</div></th></tr><tr class="widget-header"><th class="sorting" st-sort="class" width="50%">class</th><th class="sorting" st-sort="count" width="25%">count</th><th class="sorting" st-sort="bytes" width="25%">bytes</th></tr><tr><th><input placeholder="search className" st-search="class"></th><th><st-number-range predicate="count" lower="query.lower" higher="query.higher"></st-number-range></th><th><st-number-range predicate="bytes" lower="query.lower" higher="query.higher"></st-number-range></th></tr></thead><tbody><tr ng-repeat="item in vm.list"><td>{{item.class}}</td><td>{{item.count | number}}</td><td>{{item.bytes | size}}</td></tr></tbody><tfoot><tr><td colspan="5" class="text-center"><div st-items-by-page="15" st-pagination=""></div></td></tr></tfoot></table>'),e.put("app/analyzer/selfcheck.html",'<script type="text/ng-template" id="pagination.custom.html"><nav ng-if="pages.length >= 2"> <ul class="pagination"> <li><a ng-click="selectPage(1)">First</a> </li> <li><a ng-click="selectPage(currentPage - 1)">&lt;</a> </li> <li> <a> <page-select></page-select>of {{numPages}}</a> </li> <li><a ng-click="selectPage(currentPage + 1)">&gt;</a> </li> <li><a ng-click="selectPage(numPages)">Last</a> </li> </ul> </nav></script><div class="main-search"><div class="input-group search-bar" uib-dropdown="" is-open="vm.isOpen" keyboard-nav=""><input class="input-sm form-control" ng-model="vm.keyword" type="search" uib-dropdown-toggle="" ng-keydown="$event.stopPropagation();vm.onKeyDown($event)"><div class="dropdown-menu" uib-dropdown-menu="" aria-labelledby="simple-dropdown"><table search-watch-model="vm.keyword" st-table="vm.list" st-safe-src="vm.rawlist" class="table"><tbody><tr ng-class="{\'select-row\':index==vm.selectedIndex}" ng-repeat="(index,m) in vm.list" ng-click="vm.selectName(m)"><td>{{m.name}}</td></tr></tbody><tfoot ng-click="$event.stopPropagation()"><tr><td class="text-center"><div st-items-by-page="10" st-pagination="" st-template="pagination.custom.html"></div></td></tr></tfoot></table></div><span class="input-group-addon btn btn-info" ng-show="vm.keyword.length>0" ng-click="vm.keyword=\'\'"><i class="fa fa-close"></i></span></div><div class="detail"><div class="row"><div class="col-md-6 title"><span>Plugin ID:</span></div><div class="col-md-6 content">{{vm.pluginID}}</div></div><div class="row"><div class="col-md-6 title"><span>开始时间:</span></div><div class="col-md-6 content">{{vm.startTime|date:\'yyyy-MM-dd HH:mm:ss\'}}</div></div><div class="row"><div class="col-md-6 title"><span>状态:</span></div><div class="col-md-6 content {{vm.status}}">{{vm.status}}<i ng-show="vm.status==\'running\'" class="fa fa-spinner fa-pulse fa-fw"></i></div></div><div class="row"><div class="col-md-6 title"><span>耗时:</span></div><div class="col-md-6 content">{{vm.cost}}</div></div><scrollbar class="log" ng-style="{maxHeight:vm.maxHeight}"><span compile="vm.msgHtml"></span></scrollbar></div></div>'),e.put("app/analyzer/visualgc.html",'<div class="widget-header"><span class="title">Visual GC {{vm.startDate | date:"mediumTime"}} ~ {{vm.lastUpdateTime | date:"mediumTime"}}</span></div><div class="gc-list"><div class="row"><div class="col-sm-3"><div class="row gc-gen"><div class="col-sm-4"><div class="bar-panel perm"><span class="title">{{vm.permTitle}}</span><div class="bar-container progress active"><div ng-style="{\'top\':vm.permLeftPercent + \'%\'}" class="bar-process progress-bar active progress-bar-warn"></div></div></div></div><div class="col-sm-4"><div class="bar-panel old"><span class="title">Old</span><div class="bar-container progress active"><div ng-style="{\'top\':vm.oldLeftPercent + \'%\'}" class="bar-process progress-bar active progress-bar-success"></div></div></div></div><div class="col-sm-4"><div class="bar-panel eden"><div class="title" style="width:30px">Eden</div><div class="bar-container progress active"><div ng-style="{\'top\':vm.edenLeftPercent + \'%\'}" class="bar-process progress-bar active progress-bar-success"></div></div></div><div class="bar-panel s0"><div class="title" style="width:30px">S0</div><div class="bar-container progress active"><div ng-style="{\'top\':vm.s0LeftPercent + \'%\'}" class="bar-process progress-bar active progress-bar-success"></div></div></div><div class="bar-panel s1"><div class="title" style="width:30px">S1</div><div class="bar-container progress active"><div ng-style="{\'top\': vm.s1LeftPercent + \'%\'}" class="bar-process progress-bar active progress-bar-success"></div></div></div></div></div></div><div class="col-sm-9 graph"><div class="row"><div class="col-sm-6"><div class="panel"><span class="title">Compile time: {{vm.totalCompile}} compiles - {{vm.compileTime}}s</span><div class="content"><nvd3 api="vm.compileApi" options="vm.compileOptions" data="vm.compileData"></nvd3></div></div></div><div class="col-sm-6"><div class="panel"><span class="title">Class loader time: {{vm.classesLoaded}} loaded, {{vm.classesUnloaded}} unloaded - {{vm.classLoadTime}}s</span><div class="content"><nvd3 options="vm.cloaderOptions" data="vm.cloaderData"></nvd3></div></div></div></div><div class="row"><div class="col-sm-6"><div class="panel"><span class="title">GC Time: {{vm.gcEvents}} collections, {{vm.gcTimes}} Last Causes: {{vm.lastGCCause}}</span><div class="content"><nvd3 options="vm.gcOptions" data="vm.gcData"></nvd3></div></div></div><div class="col-sm-6"><div class="panel"><span class="title">Eden Space ({{vm.edenSize}},{{vm.edenCapacity}}): {{vm.edenUsed}}, {{vm.edenGCEvents}} collections, {{vm.edenGCTime}}</span><div class="content"><nvd3 options="vm.edenOptions" data="vm.edenData"></nvd3></div></div></div></div><div class="row"><div class="col-sm-6"><div class="panel"><span class="title">Survivor 0 ({{vm.survivor0Size}},{{vm.survivor0Capacity}}): {{vm.survivor0Used}}</span><div class="content"><nvd3 options="vm.s0Options" data="vm.s0Data"></nvd3></div></div></div><div class="col-sm-6"><div class="panel"><span class="title">Survivor 1 ({{vm.survivor1Size}},{{vm.survivor1Capacity}}): {{vm.survivor1Used}}</span><div class="content"><nvd3 options="vm.s1Options" data="vm.s1Data"></nvd3></div></div></div></div><div class="row"><div class="col-sm-6"><div class="panel"><span class="title">Old Gen ({{vm.tenuredSize}},{{vm.tenuredCapacity}}): {{vm.tenuredUsed}}, {{vm.tenuredGCEvents}} collections, {{vm.tenuredGCTime}}</span><div class="content"><nvd3 options="vm.oldOptions" data="vm.oldData"></nvd3></div></div></div><div class="col-sm-6"><div class="panel"><span class="title">{{vm.permTitle}} ({{vm.permSize}},{{vm.permCapacity}}): {{vm.permUsed}}</span><div class="content"><nvd3 options="vm.permOptions" data="vm.permData"></nvd3></div></div></div></div></div></div><div ng-if="vm.histogram"><div class="row gc-parameters"><div class="col-sm-12"><div class="panel"><span class="title">Parameters</span><div class="row content"><div class="col-sm-3">Tenuring Threshold:<span class="gc-parameter-value">{{vm.tenuringThreshold}}</span></div><div class="col-sm-3">Max Tenuring Threshold:<span class="gc-parameter-value">{{vm.maxTenuringThreshold}}</span></div><div class="col-sm-3">Desired Survivor Size:<span class="gc-parameter-value">{{vm.desiredSurvivorSize}}</span></div><div class="col-sm-3">Current Survivor Size:<span class="gc-parameter-value">{{vm.currentSurvivorSize}}</span></div></div></div></div></div><div class="row"><div class="col-sm-12"><div class="panel"><span class="title">Histogram</span><div class="row content histogram"><div class="bar-panel" ng-style="{\'width\':vm.histogramWidth}" ng-repeat="v in vm.histogram track by $index"><span class="title">{{$index}}</span><div class="bar-container progress active"><div ng-style="{\'top\':v + \'%\'}" class="bar-process progress-bar active progress-bar-warn"></div></div></div></div></div></div></div></div></div>'),e.put("app/cache/cache.html",'<script type="text/ng-template" id="cache-view.html"><div class="modal-header"> <h3 class="modal-title">{{title}}</h3> </div> <div class="modal-body"> <div class=" row"> <div class="col-sm-3"> <label class="search-title control-label">View By:</label> <div class="btn-group"> <label ng-show="hasIndex" class="btn btn-primary" ng-model="searchType" uib-btn-radio="\'index\'">Index</label> <label class="btn btn-primary" ng-model="searchType" uib-btn-radio="\'key\'">Key</label> </div> </div> <div class="col-sm-9 form-inline" ng-show="searchType == \'key\'"> <div class="form-group"> <input ng-model="searchKey" placeholder="key name" ng-keydown="onKeyDown($event)" class="input-sm form-control" type="search" /> </div> <button type="button" class="btn btn-primary" ng-click="searchByKey()">Search</button> </div> </div> <div class="cache-content"> <json-formatter ng-show="jsonContent != null" class="json-content" open="2" json="jsonContent"></json-formatter> <nav ng-show="searchType == \'index\' && hasIndex"> <ul class="pagination"> <li><a ng-click="selectPage(1)">First</a> </li> <li><a ng-click="selectPage(currentPage - 1)">&lt;</a> </li> <li> <a> <page-select></page-select>of {{numPages}}</a> </li> <li><a ng-click="selectPage(currentPage + 1)">&gt;</a> </li> <li><a ng-click="selectPage(numPages)">Last</a> </li> </ul> </nav> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="close()">close</button> </div></script><table st-table="displayCollection" st-sticky-header="" st-safe-src="vm.cellCollection" class="table table-striped" st-sticky-header-top="65"><thead class="sticky-header"><tr><th colspan="{{vm.colCount}}" class="search-container"><div class="widget-header"><span class="title">Cache Management</span><select class="form-control" ng-change="vm.typeChange()" ng-model="vm.selectedType" ng-options="name.name for name in vm.types"></select><div class="input-group"><div class="input-group-addon"><i class="fa fa-search"></i></div><input st-search="" placeholder="key word" class="input-sm form-control" type="search"></div></div></th></tr><tr class="widget-header"><th width="10%"></th><th class="sorting" ng-repeat="col in vm.cols" st-sort="{{col.name}}" width="{{col.width}}">{{col.name}}</th></tr></thead><tbody><tr ng-repeat="item in displayCollection"><td><button ng-click="vm.refresh(item)" class="btn btn-primary">refresh</button> <button ng-click="vm.view(item)" class="btn btn-primary">view</button></td><td ng-repeat="col in vm.cols">{{item[col.name]}}</td></tr></tbody></table>'),e.put("app/code/code.content.html",'<script type="text/ng-template" id="codeContent.html"><div class="modal-header"> <h3 class="modal-title">Conditions</h3> <h4 class="modal-title">Line {{metaInfo.lineNum}} in {{metaInfo.fullName}}</h4> <form class="form-inline"> <div class="form-group"> <label>Trace ID:</label>{{metaInfo.traceId}} </div> </form> </div> <div class="modal-body condition-editor"> <div uib-dropdown is-open="winIsOpen"> <div class="warning">You can use [this] to access current class fields.</div> <input class="form-control" uib-dropdown-toggle ng-model="vm.conditionFormula" ng-show="!vm.isDefaultUI" ng-keyup="onKeyDown($event)"> <div class="dropdown-menu" uib-dropdown-menu aria-labelledby="simple-dropdown" ng-show="(vm.isDot || vm.currentWord.length>0) && vm.list.length>0 && !vm.enter"> <table search-watch-model="vm.currentWord" st-safe-src="vm.currentFields" st-table="vm.list" class="table"> <tbody> <tr ng-class="{\'select-row\':i==selectedIndex}" ng-repeat="(i,n) in vm.list" ng-click="seleField(n)"> <td>{{n.name}}</td> <td>{{vm.formatDesc(n.desc)}}</td> </tr> </tbody> <tfoot ng-click="$event.stopPropagation()"> <tr> <td class="text-center"> <div st-items-by-page="10" st-pagination=""></div> </td> </tr> </tfoot> </table> </div> </div> <div ng-show="vm.isDefaultUI"> <div ng-repeat="c in conditions" class="row condition"> <div class="align-right col-xs-3"> <span uib-dropdown> <span class="link" uib-dropdown-toggle> {{c.name||\'[select var]\'}} </span> <ul uib-dropdown-menu role="menu" aria-labelledby="split-button"> <li class="del-btn btn btn-danger" ng-click="deleteCondition(c)" ng-show="!c.template">[delete current]</li> <li role="menuitem" ng-repeat="n in names" ng-click="nameChange(c,n)"> <span>{{n}}</span> </li> </ul> </span> <span uib-dropdown ng-show="c.fields.length>0"> <i class="fa fa-arrow-right"></i> </span> <span uib-dropdown ng-show="c.fields.length==0"> <span class="link" uib-dropdown-toggle ng-show="hasDescFields(c.desc)"> <i class="fa fa-caret-right"></i> </span> <ul uib-dropdown-menu role="menu" aria-labelledby="split-button"> <li role="menuitem" ng-repeat="f in getFieldByDesc(c.desc)" ng-click="pushField(c,f)"> <span>{{f.name}}</span> </li> </ul> </span> <span ng-repeat="(i,f) in c.fields"> <span uib-dropdown> <span class="link" uib-dropdown-toggle> {{f.name}} </span> <ul uib-dropdown-menu role="menu" aria-labelledby="split-button"> <li class="del-btn btn btn-danger" ng-click="updateField(c,null,i)">[delete current]</li> <li role="menuitem" ng-repeat="ff in getCurrentField(i,c)" ng-click="updateField(c,ff,i)"> <span>{{ff.name}}</span> </li> </ul> </span> <span ng-show="i!=(c.fields.length-1)"> <i class="fa fa-arrow-right"></i> </span> <span uib-dropdown ng-show="i==(c.fields.length-1)"> <span class="link" uib-dropdown-toggle ng-show="hasDescFields(f.desc)"> <i class="fa fa-caret-right"></i> </span> <ul uib-dropdown-menu role="menu" aria-labelledby="split-button"> <li role="menuitem" ng-repeat="f in getFieldByDesc(f.desc)" ng-click="pushField(c,f)"> <span>{{f.name}}</span> </li> </ul> </span> </span> </div> <div class="col-xs-2"> <select class="form-control" ng-model="c.op" ng-options="o as o for o in ops[c.type]"></select> <div ng-show="c.error&&!c.op" class="error">{{c.error}}</div> </div> <div class="col-xs-7" ng-show="isNeedValue(c)"> <input class="form-control" ng-model="c.value" /> <div ng-show="c.error" class="error">{{c.error}}</div> </div> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">OK</button> <button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button> </div></script><div class="widget-header"><span class="title"><a ng-show="!vm.isTab" href="{{vm.rootPath}}">{{vm.prjFullPath}}</a><span ng-show="vm.isTab">{{vm.prjFullPath}}</span> <span ng-repeat="l in vm.pathParts track by $index"><a ng-show="!vm.isTab" href="#code/folder/{{vm.getUrl($index)}}">{{l}}/</a><span ng-show="vm.isTab">{{l}}/</span></span></span></div><div><div class="file-content-header" style="float:right" ng-class="{\'opr-warning\':vm.isJava&&!vm.canDebug}"><span class="warning">If you wana debug this java file. You must enable allowDebug in <span class="link" ng-click="vm.gotoSettings()">Settings page.</span></span> <span ng-show="vm.canDebug"><label><input ng-model="vm.enableCondition" type="checkbox">enable condition</label></span> <span class="traceid-form" ng-show="vm.canDebug&&!vm.enableCondition">Trace ID: <input id="traceId" class="form-control" ng-model="vm.traceId"></span> <span class="goto-form" ng-show="vm.isJava">Line: <input ng-keydown="$event.stopPropagation();vm.onGOTOKeyDown($event)" class="form-control" ng-model="vm.jumpLine"></span></div><uib-tabset active="active"><uib-tab index="0"><uib-tab-heading><i class="fa fa-bug" ng-show="vm.isJava"></i><i class="fa fa-file-text-o fa-fw"></i> <span class="file-name">{{vm.name}}</span> <span class="file-size">{{vm.size}}</span></uib-tab-heading><div class="scrollbar" ng-style="{maxHeight:vm.maxHeight}" ng-class="{\'has-result\':vm.hasResult}" name="code-content-scrollbar"><pre><code></code></pre></div></uib-tab><uib-tab index="1" ng-show="vm.showDebugPanel"><uib-tab-heading><i class="fa fa-sun-o" ng-show="vm.hasResult"></i> debugger</uib-tab-heading><scrollbar class="debugger-panel" ng-style="{maxHeight:vm.maxHeight}"><table class="table"><colgroup><col width="30%"><col width="70%"></colgroup><thead><tr><th colspan="2" class="widget-header"><span class="title">静态变量</span></th></tr></thead><tbody><tr ng-repeat="(k,v) in vm.debugInfo.staticFields"><td>{{k}}</td><td><json-formatter ng-style="{width:vm.jcontentWidth}" ng-show="v != null" class="json-content" open="1" json="v"></json-formatter></td></tr></tbody></table><table class="table"><colgroup><col width="30%"><col width="70%"></colgroup><thead><tr><th colspan="2" class="widget-header"><span class="title">成员变量</span></th></tr></thead><tbody><tr ng-repeat="(k,v) in vm.debugInfo.fields"><td>{{k}}</td><td><json-formatter ng-style="{width:vm.jcontentWidth}" ng-show="v != null" class="json-content" open="1" json="v"></json-formatter></td></tr></tbody></table><table class="table"><thead><tr><th colspan="2" class="widget-header"><span class="title">局部变量</span></th></tr></thead><tbody><tr ng-repeat="(k,v) in vm.debugInfo.locals"><td style="width:30%">{{k}}</td><td style="width:70%"><json-formatter ng-style="{width:vm.jcontentWidth}" ng-show="v != null" class="json-content" open="1" json="v"></json-formatter></td></tr></tbody></table><table class="table"><thead><tr><th class="widget-header"><span class="title">调用堆栈</span></th></tr></thead><tbody><tr ng-repeat="t in vm.debugInfo.stackTrace"><td><span compile="vm.formatTrace(t)"></span></td></tr></tbody></table></scrollbar></uib-tab></uib-tabset></div>'),
e.put("app/code/code.html",'<table class="code table" st-table="vm.displayList" st-safe-src="vm.list"><thead><tr><th><div class="widget-header"><span class="selector title" uib-dropdown="">{{vm.isJar(vm.currentSource)?\'jar\':\'git\'}}:<a ng-click="vm.backToRoot()" href="#code/folder/{{vm.nameForUrl(vm.currentSource)}}">{{vm.currentSource}}</a> <a href="#" uib-dropdown-toggle=""><span class="caret"></span></a><div uib-dropdown-menu=""><input placeholder="key word" class="input-sm form-control" type="search" ng-model="vm.jarSearch" ng-click="$event.stopPropagation()" ng-change="vm.refreshScroll()"><scrollbar ng-style="{maxHeight:vm.menuMaxHeight}" name="jar-list-scrollbar"><ul class="source-menu" role="menu" aria-labelledby="split-button"><li role="menuitem" ng-repeat="item in vm.sources|filter:vm.jarSearch"><a ng-click="vm.changeCodeSource(item)" href=""><i ng-if="!vm.isJar(item)" class="fa fa-git"></i> {{item}}</a></li></ul></scrollbar></div></span> <span class="title" ng-repeat="l in vm.pathParts track by $index"><a href="" ng-click="vm.viewFolder($index)">{{l}}/</a></span><div class="class-search input-group" uib-dropdown="" is-open="vm.isOpen"><div class="input-group-addon"><i class="fa fa-search"></i></div><input placeholder="class name" class="input-bg form-control" ng-model="vm.searchName" type="search" uib-dropdown-toggle="" ng-keydown="vm.onClassSearchKeyDown($event)"><div class="dropdown-menu" uib-dropdown-menu="" aria-labelledby="simple-dropdown"><table search-watch-model="vm.searchName" st-table="vm.classList" st-safe-src="vm.rawClassList" class="table"><tbody><tr ng-class="{\'select-row\':i==vm.selectedIndex}" ng-repeat="(i,n) in vm.classList" ng-click="vm.viewClass(n)"><td>{{n}}</td></tr></tbody><tfoot ng-click="$event.stopPropagation()"><tr><td class="text-center"><div st-items-by-page="10" st-pagination=""></div></td></tr></tfoot></table></div></div></div></th></tr><tr class="widget-header"><th class="sorting" st-sort="name">Name</th></tr></thead><tbody><tr ng-repeat="item in vm.displayList"><th><i ng-class="{\'fa-folder\':item.folder,\'fa-file-text-o fa-fw\':!item.folder}" class="code-icon fa"></i><a href="" ng-click="vm.viewDetail(item)">{{item.name}}</a></th></tr></tbody></table>'),e.put("app/component/component.detail.html",'<table st-table="vm.displayCollection" st-safe-src="vm.rowCollection" class="table table-striped" st-sticky-header="" st-sticky-header-top="65"><thead class="sticky-header"><tr><th colspan="3" class="search-container"><div class="widget-header"><span class="title">Component / {{vm.componentName}}({{vm.rowCollection.length}})</span><div class="input-group"><div class="input-group-addon"><i class="fa fa-search"></i></div><input st-search="" placeholder="key word" class="input-sm form-control" type="search"></div></div></th></tr><tr class="widget-header"><th class="sorting" st-sort="name" width="15%">Name</th><th class="sorting" st-sort="value" width="{{vm.hasMeta?45:85}}%">Value</th><th class="sorting" ng-show="vm.hasMeta" st-sort="description" width="40%">Description</th></tr></thead><tbody><tr ng-repeat="row in vm.displayCollection"><td>{{row.name}}</td><td><span ng-bind-html="row.value"></span><json-formatter class="json-content" open="2" ng-show="row.objValue!=null" json="row.objValue" style="min-height:0px;"></json-formatter></td><td ng-show="vm.hasMeta">{{row.description}} <a ng-show="row.link" href="{{row.link}}" target="_blank">&nbsp;{{row.linkTxt}}</a></td></tr></tbody></table>'),e.put("app/component/component.detail.list.html",'<table st-table="vm.displayCollection" st-safe-src="vm.rowCollection" class="table table-striped"><thead class="sticky-header"><tr><th colspan="{{vm.colCount}}" class="search-container"><div class="widget-header"><span class="title">Component / {{vm.componentName}}({{vm.rowCollection.length}})</span><div class="input-group"><div class="input-group-addon"><i class="fa fa-search"></i></div><input st-search="" placeholder="key word" class="input-sm form-control" type="search"></div></div></th></tr><tr class="widget-header"><th class="sorting" st-sort="{{c.field}}" width="{{c.width}}" ng-repeat="c in vm.colCollection"><span uib-tooltip="{{c.description}}" tooltip-placement="top-center">{{c.name}}</span></th></tr></thead><tbody><tr ng-repeat="row in vm.displayCollection"><td ng-repeat="c in vm.colCollection">{{c.formatFn(row[c.field])}}</td></tr></tbody><tfoot ng-if="vm.hasTotal"><tr class="list-summary"><td colspan="{{vm.colCollection.length}}">Summary:</td></tr><tr><th width="{{c.width}}" ng-repeat="c in vm.colCollection">{{vm.getTotal(c.field,c.type)}}</th></tr></tfoot><tfoot><tr><td colspan="{{vm.colCollection.length}}" class="text-center"><div st-items-by-page="15" st-pagination=""></div></td></tr></tfoot></table>'),e.put("app/component/component.html",'<div class="home-page"><button class="circle-btn btn sm-btn" ng-click="vm.changeCircle()"><i class="fa {{vm.circleClass}} green"></i></button><ul class="summary-box"><li><h2>HostInfo</h2><table class="modtable"><tbody><tr ng-repeat="info in vm.sysInfo"><th style="width:210px"><span uib-tooltip="{{info.description}}" tooltip-placement="bottom-right">{{info.name}}:</span></th><td class="{{info.cssClass}}"><span class="info-value" compile="info.html"></span> {{info.value}} <a ng-show="info.link" href="{{info.link}}" target="_blank">&nbsp;{{info.linkTxt}}</a></td></tr></tbody></table></li><li><h2>AppInfo</h2><table class="modtable"><tbody><tr ng-repeat="info in vm.buildInfo"><th style="width:150px"><span uib-tooltip="{{info.description}}" tooltip-placement="bottom-right">{{info.name}}:</span></th><td><span class="info-value" compile="vm.getValHtml(info)"></span></td></tr></tbody></table></li></ul><table class="table" st-table="vm.components" st-safe-src="vm.rawComponents"><colgroup><col style="width: 20%;"></colgroup><thead><tr><td colspan="2"><div class="widget-header"><span class="title">Component</span><div class="input-group"><div class="input-group-addon"><i class="fa fa-search"></i></div><input st-search="" placeholder="关键字" class="input-sm form-control" type="search"></div></div></td></tr></thead><tbody><tr ng-repeat="c in vm.components"><th><a href="#{{c.href}}">{{c.name}}</a></th><td>{{c.description}}</td></tr></tbody></table></div>'),e.put("app/config/config.html",'<script type="text/ng-template" id="configModal.html"><div class="modal-header"> <h3 class="modal-title">Submit changes</h3> </div> <div class="modal-body"> <div ng-show="configs.length==0">No changes</div> <div ng-show="configs.length>0"> <div ng-repeat="config in configs" class="row"> <div class="align-right col-xs-6">{{config.key}}:</div> <div class="col-xs-6">{{config.old}}->{{config.value}}</div> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">OK</button> <button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button> </div></script><table st-table="displayCollection" st-sticky-header="" st-safe-src="vm.configCollection" class="table table-striped" st-sticky-header-top="65"><thead class="sticky-header"><tr><th colspan="4" class="search-container"><div class="widget-header"><span class="title">Configuration</span><select class="form-control" ng-model="vm.selectedConfig" ng-options="cf.value as cf.name for cf in vm.configGroups"></select><div class="input-group"><div class="input-group-addon"><i class="fa fa-search"></i></div><input st-search="" placeholder="key word" class="input-sm form-control" type="search"></div><button ng-click="vm.openModal()" type="button" class="right-btn btn btn-primary">Submit</button></div></th></tr><tr class="widget-header"><th class="sorting" st-sort="key" width="25%">Key</th><th class="sorting" st-sort="value" width="45%">Value</th><th class="sorting" st-sort="description" width="30%">Description</th></tr></thead><tbody><tr ng-repeat="config in displayCollection | filter:vm.configFilter" ng-class="{\'value-changed\':config.value!=config.old}"><td>{{config.key}}</td><td><button ng-show="!config.inEdit && !config.readOnly" class="btn sm-btn" ng-click="config.new=config.value;config.inEdit=true"><i class="fa fa-pencil"></i></button> <span ng-show="!config.inEdit && config.value!=config.old">{{config.old}}-></span> <span ng-show="!config.inEdit">{{config.value}}</span> <input ng-show="config.inEdit" class="config-input" ng-model="config.new"><div ng-show="config.inEdit" class="btn-group"><button class="btn sm-btn undo" ng-click="config.new=config.old"><i class="fa fa-undo"></i></button> <button class="btn sm-btn red" ng-click="config.inEdit=false"><i class="fa fa-close"></i></button> <button class="btn sm-btn green" ng-click="config.value=config.new;config.inEdit=false"><i class="fa fa-check"></i></button></div></td><td>{{config.description}}</td></tr></tbody></table>'),e.put("app/dashboard/dashboard.html",'<div class="dashboard"><div class="row"><div class="col-md-6 form-group" uib-dropdown="" is-open="vm.isOpen" keyboard-nav=""><label>Metrics:</label> <input placeholder="metrics name" ng-click="vm.toggled(true)" uib-dropdown-toggle="" class="input-sm form-control" type="search" ng-model="query" ng-keydown="vm.onKeyDown($event)"><div class="dropdown-menu" uib-dropdown-menu="" aria-labelledby="simple-dropdown"><table search-watch-model="query" st-table="vm.list" st-safe-src="vm.metrics" class="table"><tbody><tr ng-class="{\'select-row\':index==vm.selectedIndex}" ng-repeat="(index,m) in vm.list" ng-click="vm.selectName(m)"><td>{{vm.metricName(m)}}</td></tr></tbody><tfoot ng-click="$event.stopPropagation()"><tr><td class="text-center"><div st-items-by-page="10" st-pagination=""></div></td></tr></tfoot></table></div></div><div class="selected col-md-6 form-group"><ul><li ng-repeat="m in vm.selectedNames" ng-click="vm.removeName(m)"><span>{{vm.metricName(m)}}</span> <button class="btn sm-btn red"><i class="fa fa-close"></i></button></li></ul></div></div><div class="row" ng-show="false"><div class="col-md-6 form-group"><label>Tags:</label></div></div><div class="row"><div class="col-md-6"><button class="monitor-btn btn btn-danger active" ng-click="vm.monitor()">Monitor</button> <label><input type="checkbox" ng-model="vm.enablePercentile"> Enable percentile</label> <button class="btn btn-info" ng-click="vm.openSettings()">Add any class to Metrics</button></div></div><div class="row"><nvd3 options="vm.chartOptions" data="vm.chartData"></nvd3></div><div class="row"><nvd3 options="vm.chartCostOptions" data="vm.chartCostData"></nvd3></div></div>'),e.put("app/fc/fc.html",'<script type="text/ng-template" id="fcModal.html"><div class="modal-header"> <h3 class="modal-title">Submit changes</h3> </div> <div class="modal-body"> <div ng-show="fcs.length==0"> No changes </div> <div ng-show="fcs.length>0"> <div ng-repeat="fc in fcs" class="row"> <div class="align-right col-xs-9">{{fc.key}}:</div> <div class="col-xs-3">{{fc.old}}->{{fc.value}}</div> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">OK</button> <button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button> </div></script><table st-table="displayCollection" st-safe-src="vm.fcCollection" class="table table-striped" st-sticky-header="" st-sticky-header-top="65"><thead class="sticky-header"><tr><th colspan="4" class="search-container"><div class="widget-header"><span class="title">FC</span><div class="input-group"><div class="input-group-addon"><i class="fa fa-search"></i></div><input st-search="" placeholder="feature name" class="input-sm form-control" type="search"></div><button ng-click="vm.openModal()" type="button" class="right-btn btn btn-primary" ng-show="vm.hasAuthority">Submit</button></div></th></tr><tr class="widget-header"><th class="sorting" st-sort="key" width="50%">Feature Name</th><th class="sorting" st-sort="value" width="15%"></th><th class="sorting" st-sort="remark" with="35%"></th></tr></thead><tbody><tr ng-repeat="fc in displayCollection | filter:vm.fcFilter" ng-class="{\'value-changed\':fc.value!=fc.old}"><td>{{fc.key}}</td><td><switch ng-model="fc.value" class="green" disabled="!vm.hasAuthority"></switch></td><td>{{fc.remark}}</td></tr></tbody></table>'),e.put("app/log/log.detail.html",'<script type="text/ng-template" id="log-detail-stat"><div class="modal-header"> <h3 class="modal-title">{{title}}</h3> </div> <div class="modal-body row"> <div class="col-md-6"> <nvd3 options="chartOptions" data="chartData"></nvd3> </div> <div class="col-md-6 stat-result"> <div class="row" ng-repeat="v in values"> <div class="col-sm-6 label-col">{{v.label}}</div> <div class="col-sm-6">{{v.value|number}}</div> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="close()">close</button> </div></script><div class="log-detail"><div class="toolbar"><div class="btn-group"><button uib-tooltip="使用标签过滤日志" tooltip-placement="bottom-left" class="btn btn-sm btn-info" ng-click="vm.showFilter=!vm.showFilter;"><i ng-show="!vm.showFilter" class="fa fa-filter"></i> <i ng-show="vm.showFilter" class="fa fa-angle-double-up"></i></button> <button uib-tooltip="清除过滤条件" tooltip-placement="bottom-left" class="btn btn-sm btn-info" ng-click="vm.clearFilter()"><i class="fa fa-eraser"></i></button> <button uib-tooltip="{{vm.onBottom?\'滚动到顶部\':\'滚动到底部\'}}" tooltip-placement="bottom-left" class="btn btn-sm btn-info" ng-click="vm.upDown()"><i class="fa" ng-class="{\'fa-chevron-down\':!vm.onBottom,\'fa-chevron-up\':vm.onBottom}"></i></button> <button uib-tooltip="点击切换搜索模式.文本搜索Txt,正则搜索Regex(正则模式使用回车执行查询)" tooltip-placement="bottom-left" class="btn btn-sm btn-info" ng-click="vm.inRegexMode=!vm.inRegexMode">{{vm.inRegexMode?\'Regex\':\'Txt\'}}</button><div class="input-group"><input ng-show="vm.showFilter" placeholder="tag name" class="input-sm form-control" ng-model="vm.tagname" type="search" ng-change="vm.searchTag()"> <input ng-show="!vm.showFilter" placeholder="key word,press enter search" class="input-sm form-control" ng-model="vm.keyword" type="search" ng-keypress="($event.which===13)?vm.search(!vm.inRegexMode):0"> <span ng-show="!vm.showFilter" class="input-group-addon btn btn-info" ng-click="vm.reset()"><i class="fa fa-close"></i></span> <span ng-show="!vm.showFilter && vm.currentMatches" class="input-group-addon btn btn-sm btn-info" ng-click="vm.showSearchStat()"><i class="fa fa-bar-chart"></i></span> <span ng-show="!vm.showFilter && vm.currentMatches" class="input-group-addon">found:{{vm.foundCount}}</span></div><div ng-show="vm.showFilter" class="btn-group"><label class="btn btn-primary" ng-repeat="t in vm.tags |orderBy:\'-count\'|filter:vm.tagname" ng-click="vm.filterTag(t.key)" ng-model="vm.seleTags[t.key]" uib-btn-checkbox="">{{t.key}}({{t.count}})</label></div><div ng-show="!vm.showFilter && vm.getFilterTags().length>0" class="sele-tags"><span class="log-tag btn btn-primary" ng-repeat="t in vm.getFilterTags()" ng-click="vm.seleTags[t.key]=false;vm.filterTag(t.key)">{{t.key}}({{t.count}}) <i class="fa fa-close"></i></span></div></div></div><div ng-show="!vm.loadingComplete" class="spinner-panel"><i class="fa fa-spinner fa-pulse fa-fw fa-3x"></i></div><scrollbar ng-style="{maxHeight:vm.maxHeight}" name="log-detail-scrollbar" ng-show="vm.loadingComplete"><div class="log-list" ng-style="{\'paddingTop\':vm.getFilterTags().length>0?\'70px\':\'30px\'}" ng-class="{\'filter\':vm.isInFilter}"></div></scrollbar><div class="partion-selector"></div></div>'),e.put("app/log/log.html",'<table class="table" st-table="vm.logs" st-safe-src="vm.rawLogs" st-sticky-header="" st-sticky-header-top="15"><thead class="sticky-header"><tr><th colspan="4"><div class="widget-header"><span class="title">Log({{vm.rawLogs.length}})</span><div class="input-group"><div class="input-group-addon"><i class="fa fa-search"></i></div><input st-search="" placeholder="key word" class="input-sm form-control" type="search"></div></div></th></tr><tr class="widget-header"><th class="sorting" st-sort="name" width="50%">File Name</th><th st-sort-default="reverse" st-sort="modifiedTime" class="sorting" width="15%">Last Modified Time</th><th class="sorting" st-sort="size" width="15%">Size</th><th width="20%">Download</th></tr></thead><tbody><tr ng-repeat="c in vm.logs"><th><a href="#{{c.href}}">{{vm.formatName(c.name)}}</a></th><td>{{c.modifiedTime | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td>{{c.size/1024|number:2}} KB</td><td><button class="btn btn-default" ng-click="vm.download(c.name)">download</button></td></tr></tbody></table>'),e.put("app/settings/settings.html",'<div class="modal-header"><h3 class="modal-title"><i class="fa fa-cogs"></i> Settings</h3></div><div class="modal-body"><uib-tabset active="vm.seleTab"><uib-tab index="0" heading="Debug"><br><p class="form-group"><label>Gitlab Private token <span class="warning">(You can get your Gitlab private token in gitlab <a target="_blank" href="{{vm.debug.gitlabAccountUrl}}">profile account page</a>.)</span></label> <input class="form-control" ng-model="vm.debug.gitPrivateToken" ng-change="vm.debug.save()"></p><p class="form-group"><label>Allow Debug</label><div><switch ng-model="vm.debug.allowDebug" class="green" ng-change="vm.debug.setAllowDebug()"></switch></div></p><p class="form-group"><label>Header TraceIdKey</label><div><input class="form-control" ng-model="vm.debug.headerTraceIdKey"></div></p></uib-tab><uib-tab index="1" heading="Metrics"><div class="metrics-setting"><div class="row"><div class="col-md-6"><div class="input-group"><div class="input-group-addon">package:</div><select class="form-control" ng-change="vm.metrics.jarChange()" ng-model="vm.metrics.seleJar"><option value="{{v}}" ng-repeat="(k,v) in vm.metrics.jars">{{k}}</option></select></div><br><div class="input-group" ng-style="{width:\'100%\'}"><div class="input-group-addon"><i class="fa fa-search"></i></div><input placeholder="class name" class="form-control" type="search" ng-model="vm.metrics.searchClass"></div><scrollbar class="class-container" ng-style="{height:\'320px\',width:\'100%\'}"><ul class="nav nav-list"><li ng-repeat="item in vm.metrics.jarClasses|filter:vm.metrics.searchClass" ng-class="{\'selected\':item.selected}" ng-click="vm.metrics.seleClass(item)" ng-dblclick="vm.metrics.addToSelect(item)">{{item.name}}</li></ul></scrollbar><strong>（注：双击将类添加到[已被Metrics监控的类]列表）</strong></div><div class="col-md-6"><h4>已被Metrics监控的类</h4><scrollbar ng-style="{height:\'375px\',width:\'100%\'}" class="class-container"><ul class="nav nav-list"><li ng-repeat="(k,item) in vm.metrics.seleClasses" ng-class="{\'selected\':item.selected}" ng-click="vm.metrics.seleClass(item)" ng-dblclick="vm.metrics.removeSeleClass(k)">{{k}}</li></ul></scrollbar><strong>（注：双击将类从[已被Metrics监控的类]列表中移除）</strong></div></div></div></uib-tab></uib-tabset></div>'),e.put("app/template/pagination.custom.html",""),e.put("app/threaddump/threaddump.html",'<script type="text/ng-template" id="threadModal.html"><div class="modal-header"> <h3 class="modal-title">{{title}}</h3> </div> <div class="modal-body"> <table st-table="displayCollection" st-safe-src="rawCollection" class="table table-striped"> <thead> <tr> <th colspan="4" class="search-container"> <div class="widget-header"> <div class="input-group"> <div class="input-group-addon"><i class="fa fa-search"></i> </div> <input st-search placeholder="key word" class="input-sm form-control" type="search" /> </div> </div> </th> </tr> <tr class="widget-header"> <th class="sorting" st-sort="threadId" width="10%">Id</th> <th class="sorting" st-sort="threadName" width="15%">Name</th> <th class="sorting" st-sort="threadState" width="10%">State</th> <th class="sorting" st-sort="waitedCount" width="10%">Waited Count</th> <th class="sorting" st-sort="blockedCount" width="10%">Blocked Count</th> <th width="45%">Stack Trace</th> </tr> </thead> <tbody> <tr ng-repeat="info in displayCollection"> <td>{{info.threadId}}</td> <td>{{info.threadName}}</td> <td>{{getStateTip(info)}}</td> <td>{{info.waitedCount}}</td> <td>{{info.blockedCount}}</td> <td> <ul> <li ng-repeat="trace in info.stackTrace"> {{formatTrace(trace)}} </li> </ul> </td> </tr> </tbody> </table> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="close()">close</button> </div></script><div class="perf-list"><div class="row"><div class="panel"><div class="title" style="width:50px">线程 <a href="" ng-click="vm.collapse()"><i ng-class="{false:\'fa-angle-double-down\',true:\'fa-angle-double-up\'}[vm.showDiagram]" class="fa"></i></a></div><div class="thread-summary"><span class="summary-info">活动线程：{{vm.currentThreadStats.currentThreadCount}}</span> <span class="summary-info">守护线程：{{vm.currentThreadStats.daemonThreadCount}}</span> <span class="summary-info">启动总数：{{vm.currentThreadStats.totalStartedThreadCount}}</span> <span class="summary-info">峰值：{{vm.currentThreadStats.peakThreadCount}}</span></div><div class="content" ng-show="vm.showDiagram"><nvd3 api="vm.threadApi" options="vm.threadOptions" data="vm.threadData"></nvd3></div></div></div><div class="row"><uib-tabset active="activeForm"><uib-tab index="0" heading="线程"><div class="dump-container panel"><div class="row"><div class="col-md-6"><div><div class="input-group"><div class="input-group-addon btn btn-primary active" ng-click="vm.refreshThreads()"><i class="fa fa-refresh"></i></div><input ng-model="vm.searchName" placeholder="thread name" class="input-sm form-control" type="search"></div></div><div class="p-left ng-style:vm.fixedContainer"><table st-table="displayCollection" class="table" st-safe-src="vm.threads"><thead><tr><th class="sorting" st-sort="cpuTime" width="25%">cpu time</th><th class="sorting" st-sort="state" width="15%">state</th><th class="sorting" st-sort="name" width="60%">thread name</th></tr></thead><tbody><tr ng-class="{\'selected\':t.selected}" ng-click="vm.select(t)" ng-repeat="t in displayCollection | filter:vm.searchName"><td><uib-progressbar type="success" value="barVal=(t.cpuTime*100/vm.totalCpu).toFixed(2)"><b class="progress-val">{{t.cpuTime/1000000|number}}ms-{{barVal}}%</b></uib-progressbar></td><td class="{{t.state}}">{{t.state}}</td><td>{{t.name}}</td></tr></tbody></table></div></div><div class="p-right col-md-6 ng-style:vm.fixedContainer" ng-show="vm.selectedItem"><div>名称：{{vm.threadInfo.threadName}}</div><div>CPU时间：{{vm.selectedItem.cpuTime|number}} ns</div><div>状态：{{(vm.threadInfo.lockName?vm.threadInfo.lockName+"上的":"") + vm.threadInfo.threadState}}</div><div>总阻止数：{{vm.threadInfo.blockedCount}} ,总等待数：{{vm.threadInfo.waitedCount}}</div><div>堆栈跟踪：</div><ul><li ng-class="{\'high-light\':vm.needHighlight(trace.declaringClass+trace.methodName+trace.methodDetail)}" ng-repeat="trace in vm.threadInfo.stackTrace"><span compile="vm.formatTrace(trace)"></span></li></ul></div></div></div></uib-tab><button class="btn btn-primary float-right" ng-click="vm.threadDump(true)">检测死锁</button> <button class="btn btn-primary float-right dump-btn" ng-click="vm.threadDump()">Thread Dump</button><div uib-tooltip="设置thread dump获取调用堆栈的最大深度" class="setter float-right input-group"><span class="input-group-addon">max depth</span> <input ng-model="vm.maxDepth" type="text" class="form-control"></div><div uib-tooltip="设置堆栈中需加亮行包含的词语(空格分隔)" class="setter float-right input-group"><span class="input-group-addon">Highlight words</span> <input ng-model="vm.highlightWords" type="text" class="highlight-words form-control"></div><div class="float-right cpu-time"><label>Total Cpu Time: {{vm.totalCpu/1000000|number}}ms</label></div></uib-tabset></div></div>'),e.put("app/components/navbar/navbar.html",'<script type="text/ng-template" id="viserversmodal.html"><div class="modal-header"> <h3 class="modal-title">Set api server ({{vm.hostIp}} <span ng-show="vm.selectedRow"> -> {{vm.selectedRow.ip}}</span>)</h3> </div> <div class="modal-body"> <div ng-show="!vm.hasContent"> Loading server list<i class="fa fa-spinner fa-pulse fa-fw"></i> </div> <div ng-show="vm.hasContent"> <div class="widget-header"> <span class="title">Servers({{vm.servers.length}})</span> <div class="input-group"> <select class="form-control" ng-model="vm.selectedIdc" ng-options="v for v in vm.idcs"></select> </div> <div class="input-group"> <div class="input-group-addon"><i class="fa fa-search"></i> </div> <input ng-model="query" placeholder="key word" class="input-sm form-control" type="search" /> </div> </div> <table st-table="displayCollection" st-safe-src="vm.servers" class="fixed-header table table-striped" search-watch-model="query"> <thead> <tr class="widget-header"> <th class="sorting" st-sort="idc">Idc</th> <th class="sorting" st-sort="name">Name</th> <th class="sorting" st-sort="ip">IP</th> </tr> </thead> <tbody> <tr ng-repeat="server in displayCollection | filter:vm.idcFilter" st-select-row="server" ng-dblclick="ok()" ng-click="vm.selectedRow = server"> <td>{{server.idc}}</td> <td>{{server.name}}</td> <td>{{server.ip}}</td> </tr> </tbody> </table> </table> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">OK</button> <button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button> </div></script><nav class="navbar navbar-static-top navbar-inverse"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand"><i class="fa fa-eye"></i> <span class="app-name" ng-show="vm.appName && vm.appName!=\'N/A\'">{{vm.appChineseName}} ({{vm.appName}})</span> <span class="app-name" ng-show="!vm.appName || vm.appName==\'N/A\'">{{vm.appid}} -- {{vm.hostName}}/{{vm.hostIp}}</span></a></div><div class="navbar-right"><div ng-show="vm.portalUrl" class="navbar-button to-portal-button" tooltip-placement="bottom" uib-tooltip="go to vi portal"><a href="{{vm.portalUrl}}" target="_blank"><i class="ace-icon fa fa-object-group"></i></a></div><div class="navbar-button mail-button" uib-dropdown=""><a href="#" uib-dropdown-toggle=""><i class="ace-icon fa fa-question"></i></a><ul uib-dropdown-menu="" role="menu" aria-labelledby="split-button"><li role="menuitem" ng-repeat="(n,l) in vm.links"><a target="blank" href="{{l}}">{{n}}</a></li></ul></div><div class="navbar-button user-button" uib-dropdown=""><span class="user-info">Welcome,{{vm.loginUser}}</span> <a href="#" uib-dropdown-toggle=""><span class="caret"></span></a><ul uib-dropdown-menu="" role="menu" aria-labelledby="split-button"><li role="menuitem"><a href="logout"><i class="fa fa-power-off"></i> log out</a></li></ul></div></div></div><div class="breadcrumbs"><div class="sysinfo">Host: <span class="link" ng-click="vm.changeServer()">{{vm.hostName}}/{{vm.hostIp}}</span>&nbsp;|&nbsp;</div><span class="nav-tab" ng-class="{\'selected\':t.selected}" ng-repeat="(k,t) in vm.tabs" ng-click="vm.switch(k)">{{t.name}} <i ng-click="vm.removeTab(k)" class="fa fa-times"></i></span><ul class="breadcrumb" ng-click="vm.switch(0)"><li ng-class="{\'link\':k==0 && v.state!=\'empty\'}" ui-sref="{{k==0 && v.state!=\'empty\'?v.state:\'.\'}}" ng-repeat="(k,v) in breadcrumbs">{{v.name}}</li></ul><div class="version">vi version: {{vm.version}}</div></div></nav>'),e.put("app/components/sidebar/sidebar.html",'<div class="sidebar" ng-class="{true:\'barcollapse\'}[isCollapse]" ng-mouseleave="vm.onview=true" ng-mouseenter="vm.onview=false"><div class="nav-wrap-up pos-rel"><div class="nav-wrap"><div style="position: relative; top: 0px; transition-property: top; transition-duration: 0.15s;"><div class="shortcuts"><div class="sidebar-shortcuts"><button class="btn btn-info"></button> <button class="btn btn-danger" ng-click="vm.openSettings()"></button></div><div class="sidebar-shortcuts-large"><button class="btn btn-info"><i class="fa fa-pencil"></i></button> <button class="btn btn-danger" ng-click="vm.openSettings()"><i class="fa fa-cogs"></i></button></div></div><scrollbar ng-style="{maxHeight:vm.menuMaxHeight}" name="sidebar-scrollbar"><ul class="nav nav-list"><li ng-mouseenter="vm.hoverMenu(m,$index,$event)" ng-repeat="m in menus"><div ui-sref="{{m.state}}" ng-class="{\'sele-menu\': m.selected,\'hover\':hover}"><a href=""><i class="menu-icon fa {{m.icon}}"></i> <span class="menu-text">{{m.name}}</span></a></div></li></ul></scrollbar></div></div></div><div class="sidebar-toggle sidebar-collapse"><a href="" ng-click="collapse()"><i ng-class="{false:\'fa-angle-double-left\',true:\'fa-angle-double-right\'}[isCollapse]" class="fa"></i></a></div><ul ng-show="!vm.onview" ng-style="{top:vm.subMenuTop,left:vm.subMenuLeft,maxHeight:vm.subMenuHeight}" scrollbar="" ng-if="vm.currentHover.submenu" class="submenu" ng-mouseleave="vm.currentHover=null"><div class="submenu_title" ui-sref="{{vm.currentHover.state}}"><a href=""><span>{{vm.currentHover.name}}</span></a></div><li ng-repeat="sm in vm.currentHover.submenu" ui-sref="{{sm.state}}" ng-click="selemenu(vm.currentHover)"><a href=""><i class="menu-icon fa fa-caret-right"></i> <span>{{sm.name}}</span> <span>{{sm.description}}</span></a></li></ul></div>'),e.put("app/dashboard/trace/trace.html",'<style>\n    .main {\n    width: 100%;\n    margin-left:-10px;\n    text-align: center;\n    font-size: 13px;\n    padding-top: 0px;\n    }\n    .section {\n    border-top: 2px groove #AAAAAA;\n    padding-bottom: 10px;\n    padding-top: 10px;\n    }\n    .row>.title {\n    text-align: right;\n    font-weight: bolder;\n    padding-left: 0px;\n    padding-right: 0px;\n    }\n    .row>.title>span {\n     width:100px;\n    }\n    .row>.content {\n    text-align: left;\n    padding-right: 0px;\n    word-break:break-all;\n    }\n</style><div class="main"><div class="row"><h3>点火详情</h3></div><svg style="width:100%;height:80px"><svg id="test-chart" style="width:100%;height:80px"><div class="row"><div class="col-md-2 title"><span uib-tooltip="开始时间" tooltip-placement="bottom-right">Start Time:</span></div><div class="col-md-10 content">{{vm.data["startTime"]}}</div></div><div class="row"><div class="col-md-2 title"><span uib-tooltip="状态" tooltip-placement="bottom-right">Status:</span></div><div class="col-md-10 content {{vm.statusClass}}">{{vm.data["status"]}}</div></div><div class="row"><div class="col-md-2 title"><span uib-tooltip="耗时(毫秒)" tooltip-placement="bottom-right">Cost Time(ms):</span></div><div class="col-md-10 content">{{vm.data["cost"]}}</div></div><div class="row"><div class="col-md-2 title"><span uib-tooltip="详情" tooltip-placement="bottom-right">Detail:</span></div><div class="col-md-10 content"><div ng-repeat="m in vm.data[\'message\'] track by $index" class="{{vm.colorMsg(m)}}"><span ng-bind-html="vm.formatMsg(m)"></span></div></div></div></svg></svg></div>')}]);
//# sourceMappingURL=../maps/scripts/app-9a0e9adb4e.js.map
